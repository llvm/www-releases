
<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>User Guide for RISC-V Target &#8212; LLVM 20.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=649a27d8" />
    <link rel="stylesheet" type="text/css" href="_static/llvm-theme.css?v=96924833" />
    <script src="_static/documentation_options.js?v=383a7952"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="RISC-V Vector Extension" href="RISCV/RISCVVectorExtension.html" />
    <link rel="prev" title="Debug info migration: From intrinsics to records" href="RemoveDIsDebugInfo.html" />
<style type="text/css">
  table.right { float: right; margin-left: 20px; }
  table.right td { border: 1px solid #ccc; }
</style>

  </head><body>
<div class="logo">
  <a href="index.html">
    <img src="_static/logo.png"
         alt="LLVM Logo" width="250" height="88"/></a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="RISCV/RISCVVectorExtension.html" title="RISC-V Vector Extension"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="RemoveDIsDebugInfo.html" title="Debug info migration: From intrinsics to records"
             accesskey="P">previous</a> |</li>
  <li><a href="https://llvm.org/">LLVM Home</a>&nbsp;|&nbsp;</li>
  <li><a href="index.html">Documentation</a>&raquo;</li>

          <li class="nav-item nav-item-1"><a href="UserGuides.html" accesskey="U">User Guides</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">User Guide for RISC-V Target</a></li> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">

<h3>Documentation</h3>

<ul class="want-points">
    <li><a href="https://llvm.org/docs/GettingStartedTutorials.html">Getting Started/Tutorials</a></li>
    <li><a href="https://llvm.org/docs/UserGuides.html">User Guides</a></li>
    <li><a href="https://llvm.org/docs/Reference.html">Reference</a></li>
</ul>

<h3>Getting Involved</h3>

<ul class="want-points">
    <li><a href="https://llvm.org/docs/Contributing.html">Contributing to LLVM</a></li>
    <li><a href="https://llvm.org/docs/HowToSubmitABug.html">Submitting Bug Reports</a></li>
    <li><a href="https://llvm.org/docs/GettingInvolved.html#mailing-lists">Mailing Lists</a></li>
    <li><a href="https://llvm.org/docs/GettingInvolved.html#discord">Discord</a></li>
    <li><a href="https://llvm.org/docs/GettingInvolved.html#meetups-and-social-events">Meetups and Social Events</a></li>
</ul>

<h3>Additional Links</h3>

<ul class="want-points">
    <li><a href="https://llvm.org/docs/FAQ.html">FAQ</a></li>
    <li><a href="https://llvm.org/docs/Lexicon.html">Glossary</a></li>
    <li><a href="https://llvm.org/pubs">Publications</a></li>
    <li><a href="https://github.com/llvm/llvm-project/">Github Repository</a></li>
</ul>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/RISCVUsage.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="user-guide-for-risc-v-target">
<h1>User Guide for RISC-V Target<a class="headerlink" href="#user-guide-for-risc-v-target" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id3">Introduction</a></p></li>
<li><p><a class="reference internal" href="#specification-documents" id="id4">Specification Documents</a></p></li>
<li><p><a class="reference internal" href="#base-isas" id="id5">Base ISAs</a></p></li>
<li><p><a class="reference internal" href="#profiles" id="id6">Profiles</a></p></li>
<li><p><a class="reference internal" href="#extensions" id="id7">Extensions</a></p></li>
<li><p><a class="reference internal" href="#atomics-abis" id="id8">Atomics ABIs</a></p></li>
<li><p><a class="reference internal" href="#experimental-extensions" id="id9">Experimental Extensions</a></p></li>
<li><p><a class="reference internal" href="#vendor-extensions" id="id10">Vendor Extensions</a></p></li>
<li><p><a class="reference internal" href="#experimental-c-intrinsics" id="id11">Experimental C Intrinsics</a></p></li>
<li><p><a class="reference internal" href="#long-32-bit-instruction-support" id="id12">Long (&gt;32-bit) Instruction Support</a></p></li>
<li><p><a class="reference internal" href="#global-pointer-gp-relaxation-and-the-small-data-limit" id="id13">Global Pointer (GP) Relaxation and the Small Data Limit</a></p></li>
</ul>
</nav>
<section id="introduction">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>The RISC-V target provides code generation for processors implementing
supported variations of the RISC-V specification.  It lives in the
<code class="docutils literal notranslate"><span class="pre">llvm/lib/Target/RISCV</span></code> directory.</p>
</section>
<section id="specification-documents">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Specification Documents</a><a class="headerlink" href="#specification-documents" title="Link to this heading">¶</a></h2>
<p>There have been a number of revisions to the RISC-V specifications. LLVM aims
to implement the most recent ratified version of the standard RISC-V base ISAs
and ISA extensions with pragmatic variances. The most recent specification can
be found at: <a class="reference external" href="https://github.com/riscv/riscv-isa-manual/releases/">https://github.com/riscv/riscv-isa-manual/releases/</a>.</p>
<p><a class="reference external" href="https://riscv.org/technical/specifications/">The official RISC-V International specification page</a>. is also worth checking, but
tends to significantly lag the specifications linked above. Make sure to check
the <a class="reference external" href="https://wiki.riscv.org/display/HOME/Recently+Ratified+Extensions">wiki for not yet integrated extensions</a> and note
that in addition, we sometimes carry support for extensions that have not yet
been ratified (these will be marked as experimental - see below) and support
various vendor-specific extensions (see below).</p>
<p>The current known variances from the specification are:</p>
<ul class="simple">
<li><p>Unconditionally allowing instructions from zifencei, zicsr, zicntr, and
zihpm without gating them on the extensions being enabled.  Previous
revisions of the specification included these instructions in the base
ISA, and we preserve this behavior to avoid breaking existing code.  If
a future revision of the specification reuses these opcodes for other
extensions, we may need to reevaluate this choice, and thus recommend
users migrate build systems so as not to rely on this.</p></li>
<li><p>Allowing CSRs to be named without gating on specific extensions.  This
applies to all CSR names, not just those in zicsr, zicntr, and zihpm.</p></li>
<li><p>The ordering of <code class="docutils literal notranslate"><span class="pre">z*</span></code>, <code class="docutils literal notranslate"><span class="pre">s*</span></code>, and <code class="docutils literal notranslate"><span class="pre">x*</span></code> prefixed extension names is not
enforced in user-specified ISA naming strings (e.g. <code class="docutils literal notranslate"><span class="pre">-march</span></code>).</p></li>
</ul>
<p>We are actively deciding not to support multiple specification revisions
at this time. We acknowledge a likely future need, but actively defer the
decisions making around handling this until we have a concrete example of
real hardware having shipped and an incompatible change to the
specification made afterwards.</p>
</section>
<section id="base-isas">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Base ISAs</a><a class="headerlink" href="#base-isas" title="Link to this heading">¶</a></h2>
<p>The specification defines five base instruction sets: RV32I, RV32E, RV64I,
RV64E, and RV128I. Currently, LLVM fully supports RV32I, and RV64I.  RV32E and
RV64E are supported by the assembly-based tools only.  RV128I is not supported.</p>
<p>To specify the target triple:</p>
<blockquote>
<div><table class="docutils align-default" id="id1">
<caption><span class="caption-number">Table 115 </span><span class="caption-text">RISC-V Architectures</span><a class="headerlink" href="#id1" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Architecture</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">riscv32</span></code></p></td>
<td><p>RISC-V with XLEN=32 (i.e. RV32I or RV32E)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">riscv64</span></code></p></td>
<td><p>RISC-V with XLEN=64 (i.e. RV64I or RV64E)</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>To select an E variant ISA (e.g. RV32E instead of RV32I), use the base
architecture string (e.g. <code class="docutils literal notranslate"><span class="pre">riscv32</span></code>) with the extension <code class="docutils literal notranslate"><span class="pre">e</span></code>.</p>
</section>
<section id="profiles">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Profiles</a><a class="headerlink" href="#profiles" title="Link to this heading">¶</a></h2>
<p>Supported profile names can be passed using <code class="docutils literal notranslate"><span class="pre">-march</span></code> instead of a standard
ISA naming string. Currently supported profiles:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">rvi20u32</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rvi20u64</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rva20u64</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rva20s64</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rva22u64</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rva22s64</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rva23u64</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rva23s64</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rvb23u64</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rvb23s64</span></code></p></li>
</ul>
<p>Note that you can also append additional extension names to be enabled, e.g.
<code class="docutils literal notranslate"><span class="pre">rva20u64_zicond</span></code> will enable the <code class="docutils literal notranslate"><span class="pre">zicond</span></code> extension in addition to those
in the <code class="docutils literal notranslate"><span class="pre">rva20u64</span></code> profile.</p>
<p>Profiles that are not yet ratified cannot be used unless
<code class="docutils literal notranslate"><span class="pre">-menable-experimental-extensions</span></code> (or equivalent for other tools) is
specified. This applies to the following profiles:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">rvm23u32</span></code></p></li>
</ul>
</section>
<section id="extensions">
<span id="riscv-extensions"></span><h2><a class="toc-backref" href="#id7" role="doc-backlink">Extensions</a><a class="headerlink" href="#extensions" title="Link to this heading">¶</a></h2>
<p>The following table provides a status summary for extensions which have been
ratified and thus have finalized specifications.  When relevant, detailed notes
on support follow.</p>
<blockquote>
<div><table class="docutils align-default" id="id2">
<caption><span class="caption-number">Table 116 </span><span class="caption-text">Ratified Extensions by Status</span><a class="headerlink" href="#id2" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Extension</p></th>
<th class="head"><p>Status</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">B</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">C</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">D</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">F</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">E</span></code></p></td>
<td><p>Supported (<a class="reference external" href="#riscv-rve-note">See note</a>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">H</span></code></p></td>
<td><p>Assembly Support</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">M</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Sha</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Shcounterenw</span></code></p></td>
<td><p>Assembly Support (<a class="reference external" href="#riscv-profiles-extensions-note">See note</a>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Shgatpa</span></code></p></td>
<td><p>Assembly Support (<a class="reference external" href="#riscv-profiles-extensions-note">See note</a>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Shtvala</span></code></p></td>
<td><p>Assembly Support (<a class="reference external" href="#riscv-profiles-extensions-note">See note</a>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Shvsatpa</span></code></p></td>
<td><p>Assembly Support (<a class="reference external" href="#riscv-profiles-extensions-note">See note</a>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Shvstvala</span></code></p></td>
<td><p>Assembly Support (<a class="reference external" href="#riscv-profiles-extensions-note">See note</a>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Shvstvecd</span></code></p></td>
<td><p>Assembly Support (<a class="reference external" href="#riscv-profiles-extensions-note">See note</a>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Smaia</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Smcdeleg</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Smcsrind</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Smdbltrp</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Smepmp</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Smmpm</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Smnpm</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Smrnmi</span></code></p></td>
<td><p>Assembly Support</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Smstateen</span></code></p></td>
<td><p>Assembly Support</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Ssaia</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Ssccfg</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Ssccptr</span></code></p></td>
<td><p>Assembly Support (<a class="reference external" href="#riscv-profiles-extensions-note">See note</a>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Sscofpmf</span></code></p></td>
<td><p>Assembly Support</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Sscounterenw</span></code></p></td>
<td><p>Assembly Support (<a class="reference external" href="#riscv-profiles-extensions-note">See note</a>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Sscsrind</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Ssdbltrp</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Ssnpm</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Sspm</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Ssqosid</span></code></p></td>
<td><p>Assembly Support</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Ssstateen</span></code></p></td>
<td><p>Assembly Support (<a class="reference external" href="#riscv-profiles-extensions-note">See note</a>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Ssstrict</span></code></p></td>
<td><p>Assembly Support (<a class="reference external" href="#riscv-profiles-extensions-note">See note</a>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Sstc</span></code></p></td>
<td><p>Assembly Support</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Sstvala</span></code></p></td>
<td><p>Assembly Support (<a class="reference external" href="#riscv-profiles-extensions-note">See note</a>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Sstvecd</span></code></p></td>
<td><p>Assembly Support (<a class="reference external" href="#riscv-profiles-extensions-note">See note</a>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Ssu64xl</span></code></p></td>
<td><p>Assembly Support (<a class="reference external" href="#riscv-profiles-extensions-note">See note</a>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Supm</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Svade</span></code></p></td>
<td><p>Assembly Support (<a class="reference external" href="#riscv-profiles-extensions-note">See note</a>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Svadu</span></code></p></td>
<td><p>Assembly Support</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Svbare</span></code></p></td>
<td><p>Assembly Support (<a class="reference external" href="#riscv-profiles-extensions-note">See note</a>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Svinval</span></code></p></td>
<td><p>Assembly Support</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Svnapot</span></code></p></td>
<td><p>Assembly Support</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Svpbmt</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Svvptc</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">V</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Za128rs</span></code></p></td>
<td><p>Supported (<a class="reference external" href="#riscv-profiles-extensions-note">See note</a>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Za64rs</span></code></p></td>
<td><p>Supported (<a class="reference external" href="#riscv-profiles-extensions-note">See note</a>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zaamo</span></code></p></td>
<td><p>Assembly Support</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zabha</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zacas</span></code></p></td>
<td><p>Supported (<a class="reference external" href="#riscv-zacas-note">See note</a>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zalrsc</span></code></p></td>
<td><p>Assembly Support</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zama16b</span></code></p></td>
<td><p>Supported (<a class="reference external" href="#riscv-profiles-extensions-note">See note</a>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zawrs</span></code></p></td>
<td><p>Assembly Support</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zba</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zbb</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zbc</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zbkb</span></code></p></td>
<td><p>Supported (<a class="reference external" href="#riscv-scalar-crypto-note1">See note</a>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zbkc</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zbkx</span></code></p></td>
<td><p>Supported (<a class="reference external" href="#riscv-scalar-crypto-note1">See note</a>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zbs</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zca</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zcb</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zcd</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zcf</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zcmop</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zcmp</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zcmt</span></code></p></td>
<td><p>Assembly Support</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zdinx</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zfa</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zfbfmin</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zfh</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zfhmin</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zfinx</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zhinx</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zhinxmin</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zic64b</span></code></p></td>
<td><p>Supported (<a class="reference external" href="#riscv-profiles-extensions-note">See note</a>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zicbom</span></code></p></td>
<td><p>Assembly Support</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zicbop</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zicboz</span></code></p></td>
<td><p>Assembly Support</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Ziccamoa</span></code></p></td>
<td><p>Supported (<a class="reference external" href="#riscv-profiles-extensions-note">See note</a>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Ziccif</span></code></p></td>
<td><p>Supported (<a class="reference external" href="#riscv-profiles-extensions-note">See note</a>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zicclsm</span></code></p></td>
<td><p>Supported (<a class="reference external" href="#riscv-profiles-extensions-note">See note</a>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Ziccrse</span></code></p></td>
<td><p>Supported (<a class="reference external" href="#riscv-profiles-extensions-note">See note</a>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zicntr</span></code></p></td>
<td><p>(<a class="reference external" href="#riscv-i2p1-note">See Note</a>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zicond</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zicsr</span></code></p></td>
<td><p>(<a class="reference external" href="#riscv-i2p1-note">See Note</a>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zifencei</span></code></p></td>
<td><p>(<a class="reference external" href="#riscv-i2p1-note">See Note</a>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zihintntl</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zihintpause</span></code></p></td>
<td><p>Assembly Support</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zihpm</span></code></p></td>
<td><p>(<a class="reference external" href="#riscv-i2p1-note">See Note</a>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zimop</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zkn</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zknd</span></code></p></td>
<td><p>Supported (<a class="reference external" href="#riscv-scalar-crypto-note2">See note</a>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zkne</span></code></p></td>
<td><p>Supported (<a class="reference external" href="#riscv-scalar-crypto-note2">See note</a>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zknh</span></code></p></td>
<td><p>Supported (<a class="reference external" href="#riscv-scalar-crypto-note2">See note</a>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zksed</span></code></p></td>
<td><p>Supported (<a class="reference external" href="#riscv-scalar-crypto-note2">See note</a>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zksh</span></code></p></td>
<td><p>Supported (<a class="reference external" href="#riscv-scalar-crypto-note2">See note</a>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zk</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zkr</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zks</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zkt</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zmmul</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Ztso</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zvbb</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zvbc</span></code></p></td>
<td><p>Supported (<a class="reference external" href="#riscv-vector-crypto-note">See note</a>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zve32x</span></code></p></td>
<td><p>(<a class="reference external" href="#riscv-vlen-32-note">Partially</a>) Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zve32f</span></code></p></td>
<td><p>(<a class="reference external" href="#riscv-vlen-32-note">Partially</a>) Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zve64x</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zve64f</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zve64d</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zvfbfmin</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zvfbfwma</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zvfh</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zvfhmin</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zvkb</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zvkg</span></code></p></td>
<td><p>Supported (<a class="reference external" href="#riscv-vector-crypto-note">See note</a>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zvkn</span></code></p></td>
<td><p>Supported (<a class="reference external" href="#riscv-vector-crypto-note">See note</a>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zvknc</span></code></p></td>
<td><p>Supported (<a class="reference external" href="#riscv-vector-crypto-note">See note</a>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zvkned</span></code></p></td>
<td><p>Supported (<a class="reference external" href="#riscv-vector-crypto-note">See note</a>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zvkng</span></code></p></td>
<td><p>Supported (<a class="reference external" href="#riscv-vector-crypto-note">See note</a>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zvknha</span></code></p></td>
<td><p>Supported (<a class="reference external" href="#riscv-vector-crypto-note">See note</a>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zvknhb</span></code></p></td>
<td><p>Supported (<a class="reference external" href="#riscv-vector-crypto-note">See note</a>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zvks</span></code></p></td>
<td><p>Supported (<a class="reference external" href="#riscv-vector-crypto-note">See note</a>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zvksc</span></code></p></td>
<td><p>Supported (<a class="reference external" href="#riscv-vector-crypto-note">See note</a>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zvksed</span></code></p></td>
<td><p>Supported (<a class="reference external" href="#riscv-vector-crypto-note">See note</a>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zvksg</span></code></p></td>
<td><p>Supported (<a class="reference external" href="#riscv-vector-crypto-note">See note</a>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zvksh</span></code></p></td>
<td><p>Supported (<a class="reference external" href="#riscv-vector-crypto-note">See note</a>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zvkt</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zvl32b</span></code></p></td>
<td><p>(<a class="reference external" href="#riscv-vlen-32-note">Partially</a>) Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zvl64b</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zvl128b</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zvl256b</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zvl512b</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zvl1024b</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zvl2048b</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zvl4096b</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zvl8192b</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zvl16384b</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Zvl32768b</span></code></p></td>
<td><p>Supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Zvl65536b</span></code></p></td>
<td><p>Supported</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<dl class="simple">
<dt>Assembly Support</dt><dd><p>LLVM supports the associated instructions in assembly.  All assembly related tools (e.g. assembler, disassembler, llvm-objdump, etc..) are supported.  Compiler and linker will accept extension names, and linked binaries will contain appropriate ELF flags and attributes to reflect use of named extension.</p>
</dd>
<dt>Supported</dt><dd><p>Fully supported by the compiler.  This includes everything in Assembly Support, along with - if relevant - C language intrinsics for the instructions and pattern matching by the compiler to recognize idiomatic patterns which can be lowered to the associated instructions.</p>
</dd>
</dl>
<dl class="simple" id="riscv-rve-note">
<dt><code class="docutils literal notranslate"><span class="pre">E</span></code></dt><dd><p>Support of RV32E/RV64E and ilp32e/lp64e ABIs are experimental. To be compatible with the implementation of ilp32e in GCC, we don’t use aligned registers to pass variadic arguments. Furthermore, we set the stack alignment to 4 bytes for types with length of 2*XLEN.</p>
</dd>
</dl>
<dl class="simple" id="riscv-scalar-crypto-note1">
<dt><code class="docutils literal notranslate"><span class="pre">Zbkb</span></code>, <code class="docutils literal notranslate"><span class="pre">Zbkx</span></code></dt><dd><p>Pattern matching support for these instructions is incomplete.</p>
</dd>
</dl>
<dl class="simple" id="riscv-scalar-crypto-note2">
<dt><code class="docutils literal notranslate"><span class="pre">Zknd</span></code>, <code class="docutils literal notranslate"><span class="pre">Zkne</span></code>, <code class="docutils literal notranslate"><span class="pre">Zknh</span></code>, <code class="docutils literal notranslate"><span class="pre">Zksed</span></code>, <code class="docutils literal notranslate"><span class="pre">Zksh</span></code></dt><dd><p>No pattern matching exists.  As a result, these instructions can only be used from assembler or via intrinsic calls.</p>
</dd>
</dl>
<dl class="simple" id="riscv-vector-crypto-note">
<dt><code class="docutils literal notranslate"><span class="pre">Zvbc</span></code>, <code class="docutils literal notranslate"><span class="pre">Zvkg</span></code>, <code class="docutils literal notranslate"><span class="pre">Zvkn</span></code>, <code class="docutils literal notranslate"><span class="pre">Zvknc</span></code>, <code class="docutils literal notranslate"><span class="pre">Zvkned</span></code>, <code class="docutils literal notranslate"><span class="pre">Zvkng</span></code>, <code class="docutils literal notranslate"><span class="pre">Zvknha</span></code>, <code class="docutils literal notranslate"><span class="pre">Zvknhb</span></code>, <code class="docutils literal notranslate"><span class="pre">Zvks</span></code>, <code class="docutils literal notranslate"><span class="pre">Zvks</span></code>, <code class="docutils literal notranslate"><span class="pre">Zvks</span></code>, <code class="docutils literal notranslate"><span class="pre">Zvksc</span></code>, <code class="docutils literal notranslate"><span class="pre">Zvksed</span></code>, <code class="docutils literal notranslate"><span class="pre">Zvksg</span></code>, <code class="docutils literal notranslate"><span class="pre">Zvksh</span></code>.</dt><dd><p>No pattern matching exists. As a result, these instructions can only be used from assembler or via intrinsic calls.</p>
</dd>
</dl>
<dl class="simple" id="riscv-vlen-32-note">
<dt><code class="docutils literal notranslate"><span class="pre">Zve32x</span></code>, <code class="docutils literal notranslate"><span class="pre">Zve32f</span></code>, <code class="docutils literal notranslate"><span class="pre">Zvl32b</span></code></dt><dd><p>LLVM currently assumes a minimum VLEN (vector register width) of 64 bits during compilation, and as a result <code class="docutils literal notranslate"><span class="pre">Zve32x</span></code> and <code class="docutils literal notranslate"><span class="pre">Zve32f</span></code> are supported only for VLEN&gt;=64.  Assembly support doesn’t have this restriction.</p>
</dd>
</dl>
<dl class="simple" id="riscv-i2p1-note">
<dt><code class="docutils literal notranslate"><span class="pre">Zicntr</span></code>, <code class="docutils literal notranslate"><span class="pre">Zicsr</span></code>, <code class="docutils literal notranslate"><span class="pre">Zifencei</span></code>, <code class="docutils literal notranslate"><span class="pre">Zihpm</span></code></dt><dd><p>Between versions 2.0 and 2.1 of the base I specification, a backwards incompatible change was made to remove selected instructions and CSRs from the base ISA.  These instructions were grouped into a set of new extensions, but were no longer required by the base ISA.  This change is partially described in “Preface to Document Version 20190608-Base-Ratified” from the specification document (the <code class="docutils literal notranslate"><span class="pre">zicntr</span></code> and <code class="docutils literal notranslate"><span class="pre">zihpm</span></code> bits are not mentioned).  LLVM currently implements version 2.1 of the base specification. To maintain compatibility, instructions from these extensions are accepted without being in the <code class="docutils literal notranslate"><span class="pre">-march</span></code> string.  LLVM also allows the explicit specification of the extensions in an <code class="docutils literal notranslate"><span class="pre">-march</span></code> string.</p>
</dd>
</dl>
<dl class="simple" id="riscv-profiles-extensions-note">
<dt><code class="docutils literal notranslate"><span class="pre">Za128rs</span></code>, <code class="docutils literal notranslate"><span class="pre">Za64rs</span></code>, <code class="docutils literal notranslate"><span class="pre">Zama16b</span></code>, <code class="docutils literal notranslate"><span class="pre">Zic64b</span></code>, <code class="docutils literal notranslate"><span class="pre">Ziccamoa</span></code>, <code class="docutils literal notranslate"><span class="pre">Ziccif</span></code>, <code class="docutils literal notranslate"><span class="pre">Zicclsm</span></code>, <code class="docutils literal notranslate"><span class="pre">Ziccrse</span></code>, <code class="docutils literal notranslate"><span class="pre">Shcounterenvw</span></code>, <code class="docutils literal notranslate"><span class="pre">Shgatpa</span></code>, <code class="docutils literal notranslate"><span class="pre">Shtvala</span></code>, <code class="docutils literal notranslate"><span class="pre">Shvsatpa</span></code>, <code class="docutils literal notranslate"><span class="pre">Shvstvala</span></code>, <code class="docutils literal notranslate"><span class="pre">Shvstvecd</span></code>, <code class="docutils literal notranslate"><span class="pre">Ssccptr</span></code>, <code class="docutils literal notranslate"><span class="pre">Sscounterenw</span></code>, <code class="docutils literal notranslate"><span class="pre">Ssstateen</span></code>, <code class="docutils literal notranslate"><span class="pre">Ssstrict</span></code>, <code class="docutils literal notranslate"><span class="pre">Sstvala</span></code>, <code class="docutils literal notranslate"><span class="pre">Sstvecd</span></code>, <code class="docutils literal notranslate"><span class="pre">Ssu64xl</span></code>, <code class="docutils literal notranslate"><span class="pre">Svade</span></code>, <code class="docutils literal notranslate"><span class="pre">Svbare</span></code></dt><dd><p>These extensions are defined as part of the <a class="reference external" href="https://github.com/riscv/riscv-profiles/releases/tag/v1.0">RISC-V Profiles specification</a>.  They do not introduce any new features themselves, but instead describe existing hardware features.</p>
</dd>
</dl>
<dl class="simple" id="riscv-zacas-note">
<dt><code class="docutils literal notranslate"><span class="pre">Zacas</span></code></dt><dd><p>The compiler will not generate amocas.d on RV32 or amocas.q on RV64 due to ABI compatibilty. These can only be used in the assembler.</p>
</dd>
</dl>
</section>
<section id="atomics-abis">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Atomics ABIs</a><a class="headerlink" href="#atomics-abis" title="Link to this heading">¶</a></h2>
<p>At the time of writing there are three atomics mappings (ABIs) <a class="reference external" href="https://github.com/riscv-non-isa/riscv-elf-psabi-doc/blob/master/riscv-elf.adoc#tag_riscv_atomic_abi-14-uleb128version">defined for RISC-V</a>.  As of LLVM 19, LLVM defaults to “A6S”, which is compatible with both the original “A6” and the future “A7” ABI. See <a class="reference external" href="https://github.com/riscv-non-isa/riscv-elf-psabi-doc/blob/master/riscv-atomic.adoc">the psABI atomics document</a> for more information on these mappings.</p>
<p>Note that although the “A6S” mapping is used, the ELF attribute recording the mapping isn’t currently emitted by default due to a bug causing a crash in older versions of binutils when processing files containing this attribute.</p>
</section>
<section id="experimental-extensions">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Experimental Extensions</a><a class="headerlink" href="#experimental-extensions" title="Link to this heading">¶</a></h2>
<p>LLVM supports (to various degrees) a number of experimental extensions.  All experimental extensions have <code class="docutils literal notranslate"><span class="pre">experimental-</span></code> as a prefix.  There is explicitly no compatibility promised between versions of the toolchain, and regular users are strongly advised <em>not</em> to make use of experimental extensions before they reach ratification.</p>
<p>The primary goal of experimental support is to assist in the process of ratification by providing an existence proof of an implementation, and simplifying efforts to validate the value of a proposed extension against large code bases.  Experimental extensions are expected to either transition to ratified status, or be eventually removed.  The decision on whether to accept an experimental extension is currently done on an entirely case by case basis; if you want to propose one, attending the bi-weekly RISC-V sync-up call is strongly advised.</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">experimental-zalasr</span></code></dt><dd><p>LLVM implements the <a class="reference external" href="https://github.com/mehnadnerd/riscv-zalasr">0.0.5 draft specification</a>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">experimental-zicfilp</span></code>, <code class="docutils literal notranslate"><span class="pre">experimental-zicfiss</span></code></dt><dd><p>LLVM implements the <a class="reference external" href="https://github.com/riscv/riscv-cfi/releases/tag/v1.0">1.0 release specification</a>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">experimental-zvbc32e</span></code>, <code class="docutils literal notranslate"><span class="pre">experimental-zvkgs</span></code></dt><dd><p>LLVM implements the <a class="reference external" href="https://github.com/user-attachments/files/16450464/riscv-crypto-spec-vector-extra_v0.0.7.pdf">0.7 release specification</a>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">experimental-sdext</span></code>, <code class="docutils literal notranslate"><span class="pre">experimental-sdtrig</span></code></dt><dd><p>LLVM implements the <a class="reference external" href="https://github.com/riscv/riscv-debug-spec/releases/download/1.0.0-rc4/riscv-debug-specification.pdf">1.0-rc4 specification</a>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">experimental-smctr</span></code>, <code class="docutils literal notranslate"><span class="pre">experimental-ssctr</span></code></dt><dd><p>LLVM implements the <a class="reference external" href="https://github.com/riscv/riscv-control-transfer-records/releases/tag/v1.0_rc3">1.0-rc3 specification</a>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">experimental-svukte</span></code></dt><dd><p>LLVM implements the <a class="reference external" href="https://github.com/riscv/riscv-isa-manual/pull/1564">0.3 draft specification</a>.</p>
</dd>
</dl>
<p>To use an experimental extension from <cite>clang</cite>, you must add <cite>-menable-experimental-extensions</cite> to the command line, and specify the exact version of the experimental extension you are using.  To use an experimental extension with LLVM’s internal developer tools (e.g. <cite>llc</cite>, <cite>llvm-objdump</cite>, <cite>llvm-mc</cite>), you must prefix the extension name with <cite>experimental-</cite>.  Note that you don’t need to specify the version with internal tools, and shouldn’t include the <cite>experimental-</cite> prefix with <cite>clang</cite>.</p>
</section>
<section id="vendor-extensions">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">Vendor Extensions</a><a class="headerlink" href="#vendor-extensions" title="Link to this heading">¶</a></h2>
<p>Vendor extensions are extensions which are not standardized by RISC-V International, and are instead defined by a hardware vendor.  The term vendor extension roughly parallels the definition of a <cite>non-standard</cite> extension from Section 1.3 of the Volume I: RISC-V Unprivileged ISA specification.  In particular, we expect to eventually accept both <cite>custom</cite> extensions and <cite>non-conforming</cite> extensions.</p>
<p>Inclusion of a vendor extension will be considered on a case by case basis.  All proposals should be brought to the bi-weekly RISCV sync calls for discussion.  For a general idea of the factors likely to be considered, please see the <a class="reference external" href="https://clang.llvm.org/get_involved.html">Clang documentation</a>.</p>
<p>It is our intention to follow the naming conventions described in <a class="reference external" href="https://github.com/riscv-non-isa/riscv-toolchain-conventions#conventions-for-vendor-extensions">riscv-non-isa/riscv-toolchain-conventions</a>.  Exceptions to this naming will need to be strongly motivated.</p>
<p>The current vendor extensions supported are:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">XTHeadBa</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://github.com/T-head-Semi/thead-extension-spec/releases/download/2.2.2/xthead-2023-01-30-2.2.2.pdf">the THeadBa (address-generation) vendor-defined instructions specified in</a> by T-HEAD of Alibaba.  Instructions are prefixed with <cite>th.</cite> as described in the specification.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XTHeadBb</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://github.com/T-head-Semi/thead-extension-spec/releases/download/2.2.2/xthead-2023-01-30-2.2.2.pdf">the THeadBb (basic bit-manipulation) vendor-defined instructions specified in</a> by T-HEAD of Alibaba.  Instructions are prefixed with <cite>th.</cite> as described in the specification.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XTHeadBs</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://github.com/T-head-Semi/thead-extension-spec/releases/download/2.2.2/xthead-2023-01-30-2.2.2.pdf">the THeadBs (single-bit operations) vendor-defined instructions specified in</a> by T-HEAD of Alibaba.  Instructions are prefixed with <cite>th.</cite> as described in the specification.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XTHeadCondMov</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://github.com/T-head-Semi/thead-extension-spec/releases/download/2.2.2/xthead-2023-01-30-2.2.2.pdf">the THeadCondMov (conditional move) vendor-defined instructions specified in</a> by T-HEAD of Alibaba.  Instructions are prefixed with <cite>th.</cite> as described in the specification.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XTHeadCmo</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://github.com/T-head-Semi/thead-extension-spec/releases/download/2.2.2/xthead-2023-01-30-2.2.2.pdf">the THeadCmo (cache management operations) vendor-defined instructions specified in</a>  by T-HEAD of Alibaba.  Instructions are prefixed with <cite>th.</cite> as described in the specification.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XTHeadFMemIdx</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://github.com/T-head-Semi/thead-extension-spec/releases/download/2.2.2/xthead-2023-01-30-2.2.2.pdf">the THeadFMemIdx (indexed memory operations for floating point) vendor-defined instructions specified in</a> by T-HEAD of Alibaba.  Instructions are prefixed with <cite>th.</cite> as described in the specification.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XTheadMac</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://github.com/T-head-Semi/thead-extension-spec/releases/download/2.2.2/xthead-2023-01-30-2.2.2.pdf">the XTheadMac (multiply-accumulate instructions) vendor-defined instructions specified in</a> by T-HEAD of Alibaba.  Instructions are prefixed with <cite>th.</cite> as described in the specification.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XTHeadMemIdx</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://github.com/T-head-Semi/thead-extension-spec/releases/download/2.2.2/xthead-2023-01-30-2.2.2.pdf">the THeadMemIdx (indexed memory operations) vendor-defined instructions specified in</a> by T-HEAD of Alibaba.  Instructions are prefixed with <cite>th.</cite> as described in the specification.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XTHeadMemPair</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://github.com/T-head-Semi/thead-extension-spec/releases/download/2.2.2/xthead-2023-01-30-2.2.2.pdf">the THeadMemPair (two-GPR memory operations) vendor-defined instructions specified in</a> by T-HEAD of Alibaba.  Instructions are prefixed with <cite>th.</cite> as described in the specification.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XTHeadSync</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://github.com/T-head-Semi/thead-extension-spec/releases/download/2.2.2/xthead-2023-01-30-2.2.2.pdf">the THeadSync (multi-core synchronization instructions) vendor-defined instructions specified in</a> by T-HEAD of Alibaba.  Instructions are prefixed with <cite>th.</cite> as described in the specification.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XTHeadVdot</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://github.com/T-head-Semi/thead-extension-spec/releases/download/2.2.0/xthead-2022-12-04-2.2.0.pdf">version 1.0.0 of the THeadV-family custom instructions specification</a> by T-HEAD of Alibaba.  All instructions are prefixed with <cite>th.</cite> as described in the specification, and the riscv-toolchain-convention document linked above.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XVentanaCondOps</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://github.com/ventanamicro/ventana-custom-extensions/releases/download/v1.0.0/ventana-custom-extensions-v1.0.0.pdf">version 1.0.0 of the VTx-family custom instructions specification</a> by Ventana Micro Systems.  All instructions are prefixed with <cite>vt.</cite> as described in the specification, and the riscv-toolchain-convention document linked above.  These instructions are only available for riscv64 at this time.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XSfvcp</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://sifive.cdn.prismic.io/sifive/Zn3m1R5LeNNTwnLS_vcix-spec-software-v1p1.pdf">version 1.1.0 of the SiFive Vector Coprocessor Interface (VCIX) Software Specification</a> by SiFive.  All instructions are prefixed with <cite>sf.vc.</cite> as described in the specification, and the riscv-toolchain-convention document linked above.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XSfvqmaccdod</span></code>, <code class="docutils literal notranslate"><span class="pre">XSfvqmaccqoq</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://sifive.cdn.prismic.io/sifive/1a2ad85b-d818-49f7-ba83-f51f1731edbe_int8-matmul-spec.pdf">version 1.1.0 of the SiFive Int8 Matrix Multiplication Extensions Specification</a> by SiFive.  All instructions are prefixed with <cite>sf.</cite> as described in the specification linked above.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Xsfvfnrclipxfqf</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://sifive.cdn.prismic.io/sifive/0aacff47-f530-43dc-8446-5caa2260ece0_xsfvfnrclipxfqf-spec.pdf">version 1.0.0 of the FP32-to-int8 Ranged Clip Instructions Extension Specification</a> by SiFive.  All instructions are prefixed with <cite>sf.</cite> as described in the specification linked above.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Xsfvfwmaccqqq</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://sifive.cdn.prismic.io/sifive/c391d53e-ffcf-4091-82f6-c37bf3e883ed_xsfvfwmaccqqq-spec.pdf">version 1.0.0 of the Matrix Multiply Accumulate Instruction Extension Specification</a> by SiFive.  All instructions are prefixed with <cite>sf.</cite> as described in the specification linked above.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XCVbitmanip</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://github.com/openhwgroup/cv32e40p/blob/62bec66b36182215e18c9cf10f723567e23878e9/docs/source/instruction_set_extensions.rst">version 1.0.0 of the CORE-V Bit Manipulation custom instructions specification</a> by OpenHW Group.  All instructions are prefixed with <cite>cv.</cite> as described in the specification.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XCVelw</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://github.com/openhwgroup/cv32e40p/blob/master/docs/source/instruction_set_extensions.rst">version 1.0.0 of the CORE-V Event load custom instructions specification</a> by OpenHW Group.  All instructions are prefixed with <cite>cv.</cite> as described in the specification. These instructions are only available for riscv32 at this time.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XCVmac</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://github.com/openhwgroup/cv32e40p/blob/4f024fe4b15a68b76615b0630c07a6745c620da7/docs/source/instruction_set_extensions.rst">version 1.0.0 of the CORE-V Multiply-Accumulate (MAC) custom instructions specification</a> by OpenHW Group.  All instructions are prefixed with <cite>cv.mac</cite> as described in the specification. These instructions are only available for riscv32 at this time.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XCVmem</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://github.com/openhwgroup/cv32e40p/blob/master/docs/source/instruction_set_extensions.rst">version 1.0.0 of the CORE-V Post-Increment load and stores custom instructions specification</a> by OpenHW Group.  All instructions are prefixed with <cite>cv.</cite> as described in the specification. These instructions are only available for riscv32 at this time.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XCValu</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://github.com/openhwgroup/cv32e40p/blob/4f024fe4b15a68b76615b0630c07a6745c620da7/docs/source/instruction_set_extensions.rst">version 1.0.0 of the Core-V ALU custom instructions specification</a> by Core-V.  All instructions are prefixed with <cite>cv.</cite> as described in the specification. These instructions are only available for riscv32 at this time.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XCVsimd</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://github.com/openhwgroup/cv32e40p/blob/cv32e40p_v1.3.2/docs/source/instruction_set_extensions.rst">version 1.0.0 of the CORE-V SIMD custom instructions specification</a> by OpenHW Group.  All instructions are prefixed with <cite>cv.</cite> as described in the specification.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XCVbi</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://github.com/openhwgroup/cv32e40p/blob/cv32e40p_v1.3.2/docs/source/instruction_set_extensions.rst">version 1.0.0 of the CORE-V immediate branching custom instructions specification</a> by OpenHW Group.  All instructions are prefixed with <cite>cv.</cite> as described in the specification. These instructions are only available for riscv32 at this time.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XSiFivecdiscarddlone</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://sifive.cdn.prismic.io/sifive/767804da-53b2-4893-97d5-b7c030ae0a94_s76mc_core_complex_manual_21G3.pdf">the SiFive sf.cdiscard.d.l1 instruction specified in</a> by SiFive.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XSiFivecflushdlone</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://sifive.cdn.prismic.io/sifive/767804da-53b2-4893-97d5-b7c030ae0a94_s76mc_core_complex_manual_21G3.pdf">the SiFive sf.cflush.d.l1 instruction specified in</a> by SiFive.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XSfcease</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://sifive.cdn.prismic.io/sifive/767804da-53b2-4893-97d5-b7c030ae0a94_s76mc_core_complex_manual_21G3.pdf">the SiFive sf.cease instruction specified in</a> by SiFive.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Xwchc</span></code></dt><dd><p>LLVM implements <cite>the custom compressed opcodes present in some QingKe cores</cite> by WCH / Nanjing Qinheng Microelectronics. The vendor refers to these opcodes by the name “XW”.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">experimental-Xqcia</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://github.com/quic/riscv-unified-db/releases/latest">version 0.2 of the Qualcomm uC Arithmetic extension specification</a> by Qualcomm.  All instructions are prefixed with <cite>qc.</cite> as described in the specification. These instructions are only available for riscv32.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">experimental-Xqciac</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://github.com/quic/riscv-unified-db/releases/latest">version 0.3 of the Qualcomm uC Load-Store Address Calculation extension specification</a> by Qualcomm.  All instructions are prefixed with <cite>qc.</cite> as described in the specification. These instructions are only available for riscv32.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">experimental-Xqcicli</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://github.com/quic/riscv-unified-db/releases/latest">version 0.2 of the Qualcomm uC Conditional Load Immediate extension specification</a> by Qualcomm.  All instructions are prefixed with <cite>qc.</cite> as described in the specification. These instructions are only available for riscv32.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">experimental-Xqcicm</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://github.com/quic/riscv-unified-db/releases/latest">version 0.2 of the Qualcomm uC Conditional Move extension specification</a> by Qualcomm.  All instructions are prefixed with <cite>qc.</cite> as described in the specification. These instructions are only available for riscv32.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">experimental-Xqcics</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://github.com/quic/riscv-unified-db/releases/latest">version 0.2 of the Qualcomm uC Conditional Select extension specification</a> by Qualcomm.  All instructions are prefixed with <cite>qc.</cite> as described in the specification. These instructions are only available for riscv32.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">experimental-Xqcicsr</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://github.com/quic/riscv-unified-db/releases/latest">version 0.2 of the Qualcomm uC CSR extension specification</a> by Qualcomm.  All instructions are prefixed with <cite>qc.</cite> as described in the specification. These instructions are only available for riscv32.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">experimental-Xqciint</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://github.com/quic/riscv-unified-db/releases/latest">version 0.2 of the Qualcomm uC Interrupts extension specification</a> by Qualcomm.  All instructions are prefixed with <cite>qc.</cite> as described in the specification. These instructions are only available for riscv32.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">experimental-Xqcilo</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://github.com/quic/riscv-unified-db/releases/latest">version 0.2 of the Qualcomm uC Large Offset Load Store extension specification</a> by Qualcomm.  All instructions are prefixed with <cite>qc.</cite> as described in the specification. These instructions are only available for riscv32.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">experimental-Xqcilsm</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://github.com/quic/riscv-unified-db/releases/latest">version 0.2 of the Qualcomm uC Load Store Multiple extension specification</a> by Qualcomm.  All instructions are prefixed with <cite>qc.</cite> as described in the specification. These instructions are only available for riscv32.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">experimental-Xqcisls</span></code></dt><dd><p>LLVM implements <a class="reference external" href="https://github.com/quic/riscv-unified-db/releases/latest">version 0.2 of the Qualcomm uC Scaled Load Store extension specification</a> by Qualcomm.  All instructions are prefixed with <cite>qc.</cite> as described in the specification. These instructions are only available for riscv32.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Xmipscmove</span></code></dt><dd><p>LLVM implements conditional move for the <cite>p8700 processor &lt;https://mips.com/products/hardware/p8700/&gt;</cite> by MIPS.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Xmipslsp</span></code></dt><dd><p>LLVM implements load/store pair instructions for the <cite>p8700 processor &lt;https://mips.com/products/hardware/p8700/&gt;</cite> by MIPS.</p>
</dd>
</dl>
</section>
<section id="experimental-c-intrinsics">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">Experimental C Intrinsics</a><a class="headerlink" href="#experimental-c-intrinsics" title="Link to this heading">¶</a></h2>
<p>In some cases an extension is non-experimental but the C intrinsics for that
extension are still experimental.  To use C intrinsics for such an extension
from <cite>clang</cite>, you must add <cite>-menable-experimental-extensions</cite> to the command
line.  This currently applies to the following extensions:</p>
<p>No extensions have experimental intrinsics.</p>
</section>
<section id="long-32-bit-instruction-support">
<h2><a class="toc-backref" href="#id12" role="doc-backlink">Long (&gt;32-bit) Instruction Support</a><a class="headerlink" href="#long-32-bit-instruction-support" title="Link to this heading">¶</a></h2>
<p>RISC-V is a variable-length ISA, but the standard currently only defines 16- and 32-bit instructions. The specification describes longer instruction encodings, but these are not ratified.</p>
<p>The LLVM disassembler, <cite>llvm-objdump</cite>, does use the longer instruction encodings described in the specification to guess the instruction length (up to 176 bits) and will group the disassembly view of encoding bytes correspondingly.</p>
<p>The LLVM integrated assembler for RISC-V supports two different kinds of <code class="docutils literal notranslate"><span class="pre">.insn</span></code> directive, for assembling instructions that LLVM does not yet support:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.insn</span> <span class="pre">type,</span> <span class="pre">args*</span></code> which takes a known instruction type, and a list of fields. You are strongly recommended to use this variant of the directive if your instruction fits an existing instruction type.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.insn</span> <span class="pre">[</span> <span class="pre">length</span> <span class="pre">,</span> <span class="pre">]</span> <span class="pre">encoding</span></code> which takes an (optional) explicit length (in bytes) and a raw encoding for the instruction. When given an explicit length, this variant can encode instructions up to 64 bits long. The encoding part of the directive must be given all bits for the instruction, none are filled in for the user. When used without the optional length, this variant of the directive will use the LSBs of the raw encoding to work out if an instruction is 16 or 32 bits long. LLVM does not infer that an instruction might be longer than 32 bits - in this case, the user must give the length explicitly.</p></li>
</ul>
<p>It is strongly recommended to use the <code class="docutils literal notranslate"><span class="pre">.insn</span></code> directive for assembling unsupported instructions instead of <code class="docutils literal notranslate"><span class="pre">.word</span></code> or <code class="docutils literal notranslate"><span class="pre">.hword</span></code>, because it will produce the correct mapping symbols to mark the word as an instruction, not data.</p>
</section>
<section id="global-pointer-gp-relaxation-and-the-small-data-limit">
<h2><a class="toc-backref" href="#id13" role="doc-backlink">Global Pointer (GP) Relaxation and the Small Data Limit</a><a class="headerlink" href="#global-pointer-gp-relaxation-and-the-small-data-limit" title="Link to this heading">¶</a></h2>
<p>Some of the RISC-V psABI variants reserve <code class="docutils literal notranslate"><span class="pre">gp</span></code> (<code class="docutils literal notranslate"><span class="pre">x3</span></code>) for use as a “Global Pointer”, to make generating data addresses more efficient.</p>
<p>To use this functionality, you need to be doing all of the following:</p>
<ul class="simple">
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">medlow</span></code> (aka <code class="docutils literal notranslate"><span class="pre">small</span></code>) code model;</p></li>
<li><p>Not use the <code class="docutils literal notranslate"><span class="pre">gp</span></code> register for any other uses (some platforms use it for the shadow stack and others as a temporary – as denoted by the <code class="docutils literal notranslate"><span class="pre">Tag_RISCV_x3_reg_usage</span></code> build attribute);</p></li>
<li><p>Compile your objects with Clang’s <code class="docutils literal notranslate"><span class="pre">-mrelax</span></code> option, to enable relaxation annotations on relocatable objects (this is the default, but <code class="docutils literal notranslate"><span class="pre">-mno-relax</span></code> disables these relaxation annotations);</p></li>
<li><p>Compile for a position-dependent static executable (not a shared library, and <code class="docutils literal notranslate"><span class="pre">-fno-PIC</span></code> / <code class="docutils literal notranslate"><span class="pre">-fno-pic</span></code> / <code class="docutils literal notranslate"><span class="pre">-fno-pie</span></code>); and</p></li>
<li><p>Use LLD’s <code class="docutils literal notranslate"><span class="pre">--relax-gp</span></code> option.</p></li>
</ul>
<p>LLD will relax (rewrite) any code sequences that materialize an address within 2048 bytes of <code class="docutils literal notranslate"><span class="pre">__global_pointer$</span></code> (which will be defined if it is used and does not already exist) to instead generate the address using <code class="docutils literal notranslate"><span class="pre">gp</span></code> and the correct (signed) 12-bit immediate. This usually saves at least one instruction compared to materialising a full 32-bit address value.</p>
<p>There can only be one <code class="docutils literal notranslate"><span class="pre">gp</span></code> value in a process (as <code class="docutils literal notranslate"><span class="pre">gp</span></code> is not changed when calling into a function in a shared library), so the symbol is is only defined and this relaxation is only done for executables, and not for shared libraries. The linker expects executable startup code to put the value of <code class="docutils literal notranslate"><span class="pre">__global_pointer$</span></code> (from the executable) into <code class="docutils literal notranslate"><span class="pre">gp</span></code> before any user code is run.</p>
<p>Arguably, the most efficient use for this addressing mode is for smaller global variables, as larger global variables likely need many more loads or stores when they are being accessed anyway, so the cost of materializing the upper bits can be shared.</p>
<p>Therefore the compiler can place smaller global variables into sections with names starting with <code class="docutils literal notranslate"><span class="pre">.sdata</span></code> or <code class="docutils literal notranslate"><span class="pre">.sbss</span></code> (matching sections with names starting with <code class="docutils literal notranslate"><span class="pre">.data</span></code> and <code class="docutils literal notranslate"><span class="pre">.bss</span></code> respectively). LLD knows to define the <code class="docutils literal notranslate"><span class="pre">global_pointer$</span></code> symbol close to these sections, and to lay these sections out adjacent to the <code class="docutils literal notranslate"><span class="pre">.data</span></code> section.</p>
<p>Clang’s <code class="docutils literal notranslate"><span class="pre">-msmall-data-limit=</span></code> option controls what the threshold size is (in bytes) for a global variable to be considered small. <code class="docutils literal notranslate"><span class="pre">-msmall-data-limit=0</span></code> disables the use of sections starting <code class="docutils literal notranslate"><span class="pre">.sdata</span></code> and <code class="docutils literal notranslate"><span class="pre">.sbss</span></code>. The <code class="docutils literal notranslate"><span class="pre">-msmall-data-limit=</span></code> option will not move global variables that have an explicit data section, and will keep globals in separate sections if you are using <code class="docutils literal notranslate"><span class="pre">-fdata-sections</span></code>.</p>
<p>The small data limit threshold is also used to separate small constants into sections with names starting with <code class="docutils literal notranslate"><span class="pre">.srodata</span></code>. LLD does not place these with the <code class="docutils literal notranslate"><span class="pre">.sdata</span></code> and <code class="docutils literal notranslate"><span class="pre">.sbss</span></code> sections as <code class="docutils literal notranslate"><span class="pre">.srodata</span></code> sections are read only and the other two are writable. Instead the <code class="docutils literal notranslate"><span class="pre">.srodata</span></code> sections are placed adjacent to <code class="docutils literal notranslate"><span class="pre">.rodata</span></code>.</p>
<p>Data suggests that these options can produce significant improvements across a range of benchmarks.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="RISCV/RISCVVectorExtension.html" title="RISC-V Vector Extension"
             >next</a> |</li>
        <li class="right" >
          <a href="RemoveDIsDebugInfo.html" title="Debug info migration: From intrinsics to records"
             >previous</a> |</li>
  <li><a href="https://llvm.org/">LLVM Home</a>&nbsp;|&nbsp;</li>
  <li><a href="index.html">Documentation</a>&raquo;</li>

          <li class="nav-item nav-item-1"><a href="UserGuides.html" >User Guides</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">User Guide for RISC-V Target</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2003-2025, LLVM Project.
      Last updated on 2025-03-04.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>