
<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>DirectX Container &#8212; LLVM 20.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=649a27d8" />
    <link rel="stylesheet" type="text/css" href="../_static/llvm-theme.css?v=96924833" />
    <script src="../_static/documentation_options.js?v=383a7952"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Architecture and Design of DXIL Support in LLVM" href="DXILArchitecture.html" />
    <link rel="prev" title="User Guide for the DirectX Target" href="../DirectXUsage.html" />
<style type="text/css">
  table.right { float: right; margin-left: 20px; }
  table.right td { border: 1px solid #ccc; }
</style>

  </head><body>
<div class="logo">
  <a href="../index.html">
    <img src="../_static/logo.png"
         alt="LLVM Logo" width="250" height="88"/></a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="DXILArchitecture.html" title="Architecture and Design of DXIL Support in LLVM"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../DirectXUsage.html" title="User Guide for the DirectX Target"
             accesskey="P">previous</a> |</li>
  <li><a href="https://llvm.org/">LLVM Home</a>&nbsp;|&nbsp;</li>
  <li><a href="../index.html">Documentation</a>&raquo;</li>

          <li class="nav-item nav-item-1"><a href="../UserGuides.html" >User Guides</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../DirectXUsage.html" accesskey="U">User Guide for the DirectX Target</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">DirectX Container</a></li> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">

<h3>Documentation</h3>

<ul class="want-points">
    <li><a href="https://llvm.org/docs/GettingStartedTutorials.html">Getting Started/Tutorials</a></li>
    <li><a href="https://llvm.org/docs/UserGuides.html">User Guides</a></li>
    <li><a href="https://llvm.org/docs/Reference.html">Reference</a></li>
</ul>

<h3>Getting Involved</h3>

<ul class="want-points">
    <li><a href="https://llvm.org/docs/Contributing.html">Contributing to LLVM</a></li>
    <li><a href="https://llvm.org/docs/HowToSubmitABug.html">Submitting Bug Reports</a></li>
    <li><a href="https://llvm.org/docs/GettingInvolved.html#mailing-lists">Mailing Lists</a></li>
    <li><a href="https://llvm.org/docs/GettingInvolved.html#discord">Discord</a></li>
    <li><a href="https://llvm.org/docs/GettingInvolved.html#meetups-and-social-events">Meetups and Social Events</a></li>
</ul>

<h3>Additional Links</h3>

<ul class="want-points">
    <li><a href="https://llvm.org/docs/FAQ.html">FAQ</a></li>
    <li><a href="https://llvm.org/docs/Lexicon.html">Glossary</a></li>
    <li><a href="https://llvm.org/pubs">Publications</a></li>
    <li><a href="https://github.com/llvm/llvm-project/">Github Repository</a></li>
</ul>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/DirectX/DXContainer.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="directx-container">
<h1>DirectX Container<a class="headerlink" href="#directx-container" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#overview" id="id2">Overview</a></p></li>
<li><p><a class="reference internal" href="#basic-structure" id="id3">Basic Structure</a></p>
<ul>
<li><p><a class="reference internal" href="#file-header" id="id4">File Header</a></p></li>
<li><p><a class="reference internal" href="#part-data" id="id5">Part Data</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#part-formats" id="id6">Part Formats</a></p>
<ul>
<li><p><a class="reference internal" href="#dxil-part" id="id7">DXIL Part</a></p></li>
<li><p><a class="reference internal" href="#hash-part" id="id8">HASH Part</a></p></li>
<li><p><a class="reference internal" href="#program-signature-sg1-parts" id="id9">Program Signature (SG1) Parts</a></p></li>
<li><p><a class="reference internal" href="#psv0-part" id="id10">PSV0 Part</a></p>
<ul>
<li><p><a class="reference internal" href="#psv0-signature-elements" id="id11">PSV0 Signature Elements</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#sfi0-part" id="id12">SFI0 Part</a></p></li>
</ul>
</li>
</ul>
</nav>
<div class="toctree-wrapper compound">
</div>
<section id="overview">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Overview</a><a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<p>The DirectX Container (DXContainer) file format is the binary file format for
compiled shaders targeting the DirectX runtime. The file format is also called
the DXIL Container or DXBC file format. Because the file format can be used to
include either DXIL or DXBC compiled shaders, the nomenclature in LLVM is simply
DirectX Container.</p>
<p>DirectX Container files are read by the compiler and associated tools as well as
the DirectX runtime, profiling tools and other users. This document serves as a
companion to the implementation in LLVM to more completely document the file
format for its many users.</p>
</section>
<section id="basic-structure">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Basic Structure</a><a class="headerlink" href="#basic-structure" title="Link to this heading">¶</a></h2>
<p>A DXContainer file begins with a header, and is then followed by a sequence of
“parts”, which are analogous to object file sections. Each part contains a part
header, and some number of bytes of data after the header in a defined format.</p>
<p>DX Container data structures are encoded little-endian in the binary file.</p>
<p>The LLVM versions of all data structures described and/or referenced in this
file are defined in
<a class="reference external" href="https://github.com/llvm/llvm-project/blob/main/llvm/include/llvm/BinaryFormat/DXContainer.h">llvm/include/llvm/BinaryFormat/DXContainer.h</a>.
Some pseudo code is provided in blocks below to ease understanding of this
document, but reading it with the header available will provide the most
clarity.</p>
<section id="file-header">
<h3><a class="toc-backref" href="#id4" role="doc-backlink">File Header</a><a class="headerlink" href="#file-header" title="Link to this heading">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">Header</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">Magic</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
<span class="w">  </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">Digest</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
<span class="w">  </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">MajorVersion</span><span class="p">;</span>
<span class="w">  </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">MinorVersion</span><span class="p">;</span>
<span class="w">  </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">FileSize</span><span class="p">;</span>
<span class="w">  </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">PartCount</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>The DXContainer header matches the pseudo-definition above. It begins with a
four character code (magic number) with the value <code class="docutils literal notranslate"><span class="pre">DXBC</span></code> to denote the file
format.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Digest</span></code> is a 128bit hash digest computed with a proprietary algorithm and
encoded in the binary by the bytecode validator.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">MajorVersion</span></code> and <code class="docutils literal notranslate"><span class="pre">MinorVersion</span></code> encode the file format version
<code class="docutils literal notranslate"><span class="pre">1.0</span></code>.</p>
<p>The remaining fields encode 32-bit unsigned integers for the file size and
number of parts.</p>
<p>Following the part header is an array of <code class="docutils literal notranslate"><span class="pre">PartCount</span></code> 32-bit unsigned integers
specifying the offsets of each part header.</p>
</section>
<section id="part-data">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">Part Data</a><a class="headerlink" href="#part-data" title="Link to this heading">¶</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">PartHeader</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">Name</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
<span class="w">  </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">Size</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Each part begins with a part header. A part header includes the 4-character part
name, and a 32-bit unsigned integer specifying the size of the part data. The
part header is followed by <code class="docutils literal notranslate"><span class="pre">Size</span></code> bytes of data comprising the part. The
format does not explicitly require 32-bit alignment of parts, although LLVM does
implement this restriction in the writer code (because it’s a good idea). The
LLVM object reader code does not assume inputs are correctly aligned to avoid
undefined behavior caused by misaligned inputs generated by other compilers.</p>
</section>
</section>
<section id="part-formats">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Part Formats</a><a class="headerlink" href="#part-formats" title="Link to this heading">¶</a></h2>
<p>The part name indicates the format of the part data. There are 24 part headers
used by DXC and FXC. Not all compiled shaders contain all parts. In the list
below parts generated only by DXC are marked with †, and parts generated only by
FXC are marked with *.</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#dxil">DXIL</a>† - Stores the DXIL bytecode.</p></li>
<li><p><a class="reference internal" href="#hash">HASH</a>† - Stores the shader MD5 hash.</p></li>
<li><p>ILDB† - Stores the DXIL bytecode with LLVM Debug Information embedded in the module.</p></li>
<li><p>ILDN† - Stores shader debug name for external debug information.</p></li>
<li><p><a class="reference internal" href="#isg1">ISG1</a> - Stores the input signature for Shader Model 5.1+.</p></li>
<li><p>ISGN* - Stores the input signature for Shader Model 4 and earlier.</p></li>
<li><p><a class="reference internal" href="#osg1">OSG1</a> - Stores the output signature for Shader Model 5.1+.</p></li>
<li><p>OSG5* - Stores the output signature for Shader Model 5.</p></li>
<li><p>OSGN* - Stores the output signature for Shader Model 4 and earlier.</p></li>
<li><p>PCSG* - Stores the patch constant signature for Shader Model 5.1 and earlier.</p></li>
<li><p>PDBI† - Stores PDB information.</p></li>
<li><p>PRIV - Stores arbitrary private data (Not encoded by either FXC or DXC).</p></li>
<li><p><a class="reference internal" href="#psg1">PSG1</a> - Stores the patch constant signature for Shader Model 6+.</p></li>
<li><p><a class="reference internal" href="#psv0">PSV0</a> - Stores Pipeline State Validation data.</p></li>
<li><p>RDAT† - Stores Runtime Data.</p></li>
<li><p>RDEF* - Stores resource definitions.</p></li>
<li><p>RTS0 - Stores compiled root signature.</p></li>
<li><p><a class="reference internal" href="#sfi0">SFI0</a> - Stores shader feature flags.</p></li>
<li><p>SHDR* - Stores compiled DXBC bytecode.</p></li>
<li><p>SHEX* - Stores compiled DXBC bytecode.</p></li>
<li><p>DXBC* - Stores compiled DXBC bytecode.</p></li>
<li><p>SRCI† - Stores shader source information.</p></li>
<li><p>STAT† - Stores shader statistics.</p></li>
<li><p>VERS† - Stores shader compiler version information.</p></li>
</ol>
<section id="dxil-part">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">DXIL Part</a><a class="headerlink" href="#dxil-part" title="Link to this heading">¶</a></h3>
<p id="dxil">The DXIL part is comprised of three data structures: the <code class="docutils literal notranslate"><span class="pre">ProgramHeader</span></code>, the
<code class="docutils literal notranslate"><span class="pre">BitcodeHeader</span></code> and the bitcode serialized LLVM 3.7 IR Module.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ProgramHeader</span></code> contains the shader model version and pipeline stage
enumeration value. This identifies the target profile of the contained shader
bitcode.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">BitcodeHeader</span></code> contains the DXIL version information and refers to the
start of the bitcode data.</p>
</section>
<section id="hash-part">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">HASH Part</a><a class="headerlink" href="#hash-part" title="Link to this heading">¶</a></h3>
<p id="hash">The HASH part contains a 32-bit unsigned integer with the shader hash flags, and
a 128-bit MD5 hash digest. The flags field can either have the value <code class="docutils literal notranslate"><span class="pre">0</span></code> to
indicate no flags, or <code class="docutils literal notranslate"><span class="pre">1</span></code> to indicate that the file hash was computed
including the source code that produced the binary.</p>
</section>
<section id="program-signature-sg1-parts">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">Program Signature (SG1) Parts</a><a class="headerlink" href="#program-signature-sg1-parts" title="Link to this heading">¶</a></h3>
<div class="highlight-c notranslate" id="psg1"><span id="osg1"></span><span id="isg1"></span><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">ProgramSignatureHeader</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">ParamCount</span><span class="p">;</span>
<span class="w">  </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">FirstParamOffset</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The program signature parts (ISG1, OSG1, &amp; PSG1) all use the same data
structures to encode inputs, outputs and patch information. The
<code class="docutils literal notranslate"><span class="pre">ProgramSignatureHeader</span></code> includes two 32-bit unsigned integers to specify the
number of signature parameters and the offset of the first parameter.</p>
<p>Beginning at <code class="docutils literal notranslate"><span class="pre">FirstParamOffset</span></code> bytes from the start of the
<code class="docutils literal notranslate"><span class="pre">ProgramSignatureHeader</span></code>, <code class="docutils literal notranslate"><span class="pre">ParamCount</span></code> <code class="docutils literal notranslate"><span class="pre">ProgramSignatureElement</span></code>
structures are written. Following the <code class="docutils literal notranslate"><span class="pre">ProgramSignatureElements</span></code> is a string
table of null terminated strings padded to 32-byte alignment. This string table
matches the DWARF string table format as implemented by LLVM.</p>
<p>Each <code class="docutils literal notranslate"><span class="pre">ProgramSignatureElement</span></code> encodes a <code class="docutils literal notranslate"><span class="pre">NameOffset</span></code> value which specifies
the offset into the string table. A value of <code class="docutils literal notranslate"><span class="pre">0</span></code> denotes no name. The offsets
encoded here are from the beginning of the <code class="docutils literal notranslate"><span class="pre">ProgramSignatureHeader</span></code> not the
beginning of the string table.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ProgramSignatureElement</span></code> contains several enumeration fields which are
defined in <a class="reference external" href="https://github.com/llvm/llvm-project/blob/main/llvm/include/llvm/BinaryFormat/DXContainerConstants.def">llvm/include/llvm/BinaryFormat/DXContainerConstants.def</a>.
These fields encode the D3D system value, the type of data and its precision
requirements.</p>
</section>
<section id="psv0-part">
<h3><a class="toc-backref" href="#id10" role="doc-backlink">PSV0 Part</a><a class="headerlink" href="#psv0-part" title="Link to this heading">¶</a></h3>
<p id="psv0">The Pipeline State Validation data encodes versioned runtime information
structures. These structures use a scheme where in lieu of encoding a version
number, they encode the size of the structure and each new version of the
structure is additive. This allows readers to infer the version of the structure
by comparing the encoded size with the size of known structures. If the encoded
size is larger than any known structure, the largest known structure can validly
parse the data represented in the known structure.</p>
<p>In LLVM we represent the versions of the associated data structures with
versioned namespaces under the <code class="docutils literal notranslate"><span class="pre">llvm::dxbc::PSV</span></code> namespace (e.g. <code class="docutils literal notranslate"><span class="pre">v0</span></code>,
<code class="docutils literal notranslate"><span class="pre">v1</span></code>). Each structure in the <code class="docutils literal notranslate"><span class="pre">v0</span></code> namespace is the base version, the
structures in the <code class="docutils literal notranslate"><span class="pre">v1</span></code> namespace inherit from the <code class="docutils literal notranslate"><span class="pre">v0</span></code> namespace, and the
<code class="docutils literal notranslate"><span class="pre">v2</span></code> structures inherit from the <code class="docutils literal notranslate"><span class="pre">v1</span></code> structures, and so on.</p>
<p>The high-level structure of the PSV data is:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">RuntimeInfo</span></code> structure</p></li>
<li><p>Resource bindings</p></li>
<li><p>Signature elements</p></li>
<li><p>Mask Vectors (Output, Input, InputPatch, PatchOutput)</p></li>
</ol>
<p>Immediately following the part header for the PSV0 part is a 32-bit unsigned
integer specifying the size of the <code class="docutils literal notranslate"><span class="pre">RuntimeInfo</span></code> structure that follows.</p>
<p>Immediately following the <code class="docutils literal notranslate"><span class="pre">RuntimeInfo</span></code> structure is a 32-bit unsigned integer
specifying the number of resource bindings. If the number of resources is
greater than zero, another unsigned 32-bit integer follows to specify the size
of the <code class="docutils literal notranslate"><span class="pre">ResourceBindInfo</span></code> structure. This is followed by the specified number
of structures of the specified size (which infers the version of the structure).</p>
<p>For version 0 of the data this ends the part data.</p>
<section id="psv0-signature-elements">
<h4><a class="toc-backref" href="#id11" role="doc-backlink">PSV0 Signature Elements</a><a class="headerlink" href="#psv0-signature-elements" title="Link to this heading">¶</a></h4>
<p>The signature elements are conceptually a single concept but the data is encoded
in three different blocks. The first block is a string table, the second block
is an index table, and the third block is the elements themselves, which in turn
are separeated by input, output and patch constant or primitive elements.</p>
<p>Signature elements capture much of the same data captured in the <a class="reference internal" href="#isg1"><span class="std std-ref">SG1</span></a> parts. The use of an index table allows de-duplciation of data for a more
compact final representation.</p>
<p>The string table begins with a 32-bit unsigned integer specifying the table
size. This string table uses the DXContainer format as implemented in LLVM. This
format prefixes the string table with a null byte so that offset <code class="docutils literal notranslate"><span class="pre">0</span></code> is a null
string, and pads to 32-byte alignment.</p>
<p>The index table begins with a 32-bit unsigned integer specifying the size of the
table, and is followed by that many 32-bit unsigned integers representing the
table. The index table may or may not deduplicate repeated sequences (both DXC
and Clang do). The indices signify the indices in the flattened aggregate
representation which the signature element describes. A single semantic may have
more than one entry in this table to denote the different attributes of its
members.</p>
<p>For example given the following code:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">VSOut_1</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">float4</span><span class="w"> </span><span class="n">f3</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">VOUT2</span><span class="p">;</span>
<span class="w">    </span><span class="n">float3</span><span class="w"> </span><span class="n">f4</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">VOUT3</span><span class="p">;</span>
<span class="p">};</span>


<span class="k">struct</span><span class="w"> </span><span class="nc">VSOut</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">float4</span><span class="w"> </span><span class="n">f1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">VOUT0</span><span class="p">;</span>
<span class="w">    </span><span class="n">float2</span><span class="w"> </span><span class="n">f2</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">VOUT1</span><span class="p">;</span>
<span class="w">    </span><span class="n">VSOut_1</span><span class="w"> </span><span class="n">s</span><span class="p">;</span>
<span class="w">    </span><span class="n">int4</span><span class="w"> </span><span class="n">f5</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">VOUT4</span><span class="p">;</span>
<span class="p">};</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">out</span><span class="w"> </span><span class="n">VSOut</span><span class="w"> </span><span class="n">o1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">A</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The semantic <code class="docutils literal notranslate"><span class="pre">A</span></code> gets expanded into 5 output signature elements. Those
elements are:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the example below, it is a coincidence that the rows match the indices, in
more complicated examples with multiple semantics this is not the case.</p>
</div>
<ol class="arabic simple">
<li><p>Index 0 starts at row 0, contains 4 columns, and is float32. This represents
<code class="docutils literal notranslate"><span class="pre">f1</span></code> in the source.</p></li>
<li><p>Index 1, 2, 3, and 4 starts at row 1, contains two columns and is float32.
This represents <code class="docutils literal notranslate"><span class="pre">f2</span></code> in the source, and it spreads across rows 1 - 4.</p></li>
<li><p>Index 5 starts at row 5, contains 4 columns, and is float32. This represents
<code class="docutils literal notranslate"><span class="pre">f3</span></code> in the source.</p></li>
<li><p>Index 6 starts at row 6, contains 3 columns, and is float32. This represents
<code class="docutils literal notranslate"><span class="pre">f4</span></code>.</p></li>
<li><p>Index 7 starts at row 7, contains 4 columns, and is signed 32-bit integer.
This represents <code class="docutils literal notranslate"><span class="pre">f5</span></code> in the source.</p></li>
</ol>
<p>The LLVM <code class="docutils literal notranslate"><span class="pre">obj2yaml</span></code> tool can parse this data out of the PSV and present it in
human readable YAML. For the example above it produces the output:</p>
<div class="highlight-YAML notranslate"><div class="highlight"><pre><span></span><span class="nt">SigOutputElements</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Name</span><span class="p">:</span><span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">A</span>
<span class="w">    </span><span class="nt">Indices</span><span class="p">:</span><span class="w">         </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">0</span><span class="w"> </span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">StartRow</span><span class="p">:</span><span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">    </span><span class="nt">Cols</span><span class="p">:</span><span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">4</span>
<span class="w">    </span><span class="nt">StartCol</span><span class="p">:</span><span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">    </span><span class="nt">Allocated</span><span class="p">:</span><span class="w">       </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">Kind</span><span class="p">:</span><span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">Arbitrary</span>
<span class="w">    </span><span class="nt">ComponentType</span><span class="p">:</span><span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">Float32</span>
<span class="w">    </span><span class="nt">Interpolation</span><span class="p">:</span><span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">Linear</span>
<span class="w">    </span><span class="nt">DynamicMask</span><span class="p">:</span><span class="w">     </span><span class="l l-Scalar l-Scalar-Plain">0x0</span>
<span class="w">    </span><span class="nt">Stream</span><span class="p">:</span><span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Name</span><span class="p">:</span><span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">A</span>
<span class="w">    </span><span class="nt">Indices</span><span class="p">:</span><span class="w">         </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">4</span><span class="w"> </span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">StartRow</span><span class="p">:</span><span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">Cols</span><span class="p">:</span><span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">    </span><span class="nt">StartCol</span><span class="p">:</span><span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">    </span><span class="nt">Allocated</span><span class="p">:</span><span class="w">       </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">Kind</span><span class="p">:</span><span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">Arbitrary</span>
<span class="w">    </span><span class="nt">ComponentType</span><span class="p">:</span><span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">Float32</span>
<span class="w">    </span><span class="nt">Interpolation</span><span class="p">:</span><span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">Linear</span>
<span class="w">    </span><span class="nt">DynamicMask</span><span class="p">:</span><span class="w">     </span><span class="l l-Scalar l-Scalar-Plain">0x0</span>
<span class="w">    </span><span class="nt">Stream</span><span class="p">:</span><span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Name</span><span class="p">:</span><span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">A</span>
<span class="w">    </span><span class="nt">Indices</span><span class="p">:</span><span class="w">         </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">5</span><span class="w"> </span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">StartRow</span><span class="p">:</span><span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">    </span><span class="nt">Cols</span><span class="p">:</span><span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">4</span>
<span class="w">    </span><span class="nt">StartCol</span><span class="p">:</span><span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">    </span><span class="nt">Allocated</span><span class="p">:</span><span class="w">       </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">Kind</span><span class="p">:</span><span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">Arbitrary</span>
<span class="w">    </span><span class="nt">ComponentType</span><span class="p">:</span><span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">Float32</span>
<span class="w">    </span><span class="nt">Interpolation</span><span class="p">:</span><span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">Linear</span>
<span class="w">    </span><span class="nt">DynamicMask</span><span class="p">:</span><span class="w">     </span><span class="l l-Scalar l-Scalar-Plain">0x0</span>
<span class="w">    </span><span class="nt">Stream</span><span class="p">:</span><span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Name</span><span class="p">:</span><span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">A</span>
<span class="w">    </span><span class="nt">Indices</span><span class="p">:</span><span class="w">         </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">6</span><span class="w"> </span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">StartRow</span><span class="p">:</span><span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">6</span>
<span class="w">    </span><span class="nt">Cols</span><span class="p">:</span><span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="w">    </span><span class="nt">StartCol</span><span class="p">:</span><span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">    </span><span class="nt">Allocated</span><span class="p">:</span><span class="w">       </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">Kind</span><span class="p">:</span><span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">Arbitrary</span>
<span class="w">    </span><span class="nt">ComponentType</span><span class="p">:</span><span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">Float32</span>
<span class="w">    </span><span class="nt">Interpolation</span><span class="p">:</span><span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">Linear</span>
<span class="w">    </span><span class="nt">DynamicMask</span><span class="p">:</span><span class="w">     </span><span class="l l-Scalar l-Scalar-Plain">0x0</span>
<span class="w">    </span><span class="nt">Stream</span><span class="p">:</span><span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Name</span><span class="p">:</span><span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">A</span>
<span class="w">    </span><span class="nt">Indices</span><span class="p">:</span><span class="w">         </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">7</span><span class="w"> </span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">StartRow</span><span class="p">:</span><span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">7</span>
<span class="w">    </span><span class="nt">Cols</span><span class="p">:</span><span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">4</span>
<span class="w">    </span><span class="nt">StartCol</span><span class="p">:</span><span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">    </span><span class="nt">Allocated</span><span class="p">:</span><span class="w">       </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">Kind</span><span class="p">:</span><span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">Arbitrary</span>
<span class="w">    </span><span class="nt">ComponentType</span><span class="p">:</span><span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">SInt32</span>
<span class="w">    </span><span class="nt">Interpolation</span><span class="p">:</span><span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">Constant</span>
<span class="w">    </span><span class="nt">DynamicMask</span><span class="p">:</span><span class="w">     </span><span class="l l-Scalar l-Scalar-Plain">0x0</span>
<span class="w">    </span><span class="nt">Stream</span><span class="p">:</span><span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">0</span>
</pre></div>
</div>
<p>The number of signature elements of each type is encoded in the
<code class="docutils literal notranslate"><span class="pre">llvm::dxbc::PSV::v1::RuntimeInfo</span></code> structure. If any of the element count
values are non-zero, the size of the <code class="docutils literal notranslate"><span class="pre">ProgramSignatureElement</span></code> structure is
encoded next to allow versioning of that structure. Today there is only one
version. Following the size field is the specified number of signature elements
in the order input, output, then patch constant or primitive.</p>
<p>Following the signature elements is a sequence of mask vectors encoded as a
series of 32-bit integers. Each 32-bit integer in the mask encodes values for 8
input/output/patch or primitive elements. The mask vector is filled from least
significant bit to most significant bit with each added element shifting the
previous elements left. A reader needs to consult the total number of vectors
encoded in the <code class="docutils literal notranslate"><span class="pre">RuntimeInfo</span></code> structure to know how to read the mask vector.</p>
<p>If the shader has <code class="docutils literal notranslate"><span class="pre">UsesViewID</span></code> enabled in the <code class="docutils literal notranslate"><span class="pre">RuntimeInfo</span></code> an output mask
vector will be included. The output mask vector is four arrays of 32-bit
unsigned integers. Each of the four arrays corresponds to an output stream.
Geometry shaders have a maximum of four output streams, all other shader stages
only support one output stream. Each bit in the mask vector identifies one
column of an output from the output signature depends on the ViewID.</p>
<p>If the shader has <code class="docutils literal notranslate"><span class="pre">UsesViewID</span></code> enabled, it is a hull shader, and it has patch
constant or primitive vector elements, a patch constant or primitive vector mask
will be included. It is identical in structure to the output mask vector. Each
bit in the mask vector identifies one column of a patch constant output which
depends on the ViewID.</p>
<p>The next series of mask vectors are similar in structure to the output mask
vector, but they contain an extra dimension.</p>
<p>The output/input map is encoded next if the shader has inputs and outputs. The
output/input mask encodes which outputs are impacted by each column of each
input. The size for each mask vector is the size of the output max vector * the
number of inputs * 4 (for each component). Each bit in the mask vector
identifies one column of an output and a column of an input. A value of 1 means
the output is impacted by the input.</p>
<p>If the shader is a hull shader, and it has inputs and patch outputs, an input to
patch map will be included next. This is identical in structure to the
output/input map. The dimensions are defined by the size of the patch constant
or primitive vector mask * the number of inputs * 4 (for each component). Each
bit in the mask vector identifies one column of a patch constant output and a
column of an input. A value of 1 means the output is impacted by the input.</p>
<p>If the shader is a domain shader, and it has outputs and patch outputs, an
output patch map will be included next. This is identical in structure to the
output/input map. The dimensions are defined by the size of the patch constant
or primitive vector mask * the number of outputs * 4 (for each component). Each
bit in the mask vector identifies one column of a patch constant input and a
column of an output. A value of 1 means the output is impacted by the primitive
input.</p>
</section>
</section>
<section id="sfi0-part">
<h3><a class="toc-backref" href="#id12" role="doc-backlink">SFI0 Part</a><a class="headerlink" href="#sfi0-part" title="Link to this heading">¶</a></h3>
<p id="sfi0">The SFI0 part encodes a 64-bit unsigned integer bitmask of the feature flags.
This denotes which optional features the shader requires. The flag values are
defined in <a class="reference external" href="https://github.com/llvm/llvm-project/blob/main/llvm/include/llvm/BinaryFormat/DXContainerConstants.def">llvm/include/llvm/BinaryFormat/DXContainerConstants.def</a>.</p>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="DXILArchitecture.html" title="Architecture and Design of DXIL Support in LLVM"
             >next</a> |</li>
        <li class="right" >
          <a href="../DirectXUsage.html" title="User Guide for the DirectX Target"
             >previous</a> |</li>
  <li><a href="https://llvm.org/">LLVM Home</a>&nbsp;|&nbsp;</li>
  <li><a href="../index.html">Documentation</a>&raquo;</li>

          <li class="nav-item nav-item-1"><a href="../UserGuides.html" >User Guides</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../DirectXUsage.html" >User Guide for the DirectX Target</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">DirectX Container</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2003-2025, LLVM Project.
      Last updated on 2025-03-04.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>