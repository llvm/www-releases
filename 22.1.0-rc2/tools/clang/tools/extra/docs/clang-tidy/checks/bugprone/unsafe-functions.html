<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>clang-tidy - bugprone-unsafe-functions &#8212; Extra Clang Tools 22.1.0-rc2 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=649a27d8" />
    <link rel="stylesheet" type="text/css" href="../../../_static/haiku.css?v=e491ac2d" />
    <link rel="stylesheet" href="../../../_static/clang-tools-extra-styles.css" type="text/css" />
    <script src="../../../_static/documentation_options.js?v=106f770c"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="bugprone-unused-local-non-trivial-variable" href="unused-local-non-trivial-variable.html" />
    <link rel="prev" title="bugprone-unique-ptr-array-mismatch" href="unique-ptr-array-mismatch.html" /> 
  </head><body>
      <div class="header" role="banner"><h1 class="heading"><a href="../../../index.html">
          <span>Extra Clang Tools 22.1.0-rc2 documentation</span></a></h1>
        <h2 class="heading"><span>clang-tidy - bugprone-unsafe-functions</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="unique-ptr-array-mismatch.html">bugprone-unique-ptr-array-mismatch</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../../../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="unused-local-non-trivial-variable.html">bugprone-unused-local-non-trivial-variable</a>&#160;&#160;»
        </p>

      </div>
      <div class="content" role="main">
        
        
  <section id="bugprone-unsafe-functions">
<h1>bugprone-unsafe-functions<a class="headerlink" href="#bugprone-unsafe-functions" title="Link to this heading">¶</a></h1>
<p>Checks for functions that have safer, more secure replacements available, or
are considered deprecated due to design flaws.
The check heavily relies on the functions from the
<strong>Annex K.</strong> “Bounds-checking interfaces” of C11.</p>
<dl class="simple">
<dt>The check implements the following rules from the CERT C Coding Standard:</dt><dd><ul class="simple">
<li><p>Recommendation <a class="reference external" href="https://wiki.sei.cmu.edu/confluence/display/c/MSC24-C.+Do+not+use+deprecated+or+obsolescent+functions">MSC24-C. Do not use deprecated or obsolescent functions</a>.</p></li>
<li><p>Rule <a class="reference external" href="https://wiki.sei.cmu.edu/confluence/display/c/MSC33-C.+Do+not+pass+invalid+data+to+the+asctime%28%29+function">MSC33-C. Do not pass invalid data to the asctime() function</a>.</p></li>
</ul>
</dd>
</dl>
<p><cite>cert-msc24-c</cite> and <cite>cert-msc33-c</cite> redirect here as aliases of this check.</p>
<section id="unsafe-functions">
<h2>Unsafe functions<a class="headerlink" href="#unsafe-functions" title="Link to this heading">¶</a></h2>
<p>The following functions are reported if <a class="reference internal" href="#cmdoption-arg-ReportDefaultFunctions"><code class="xref std std-option docutils literal notranslate"><span class="pre">ReportDefaultFunctions</span></code></a>
is enabled.</p>
<p>If <em>Annex K.</em> is available, a replacement from <em>Annex K.</em> is suggested for the
following functions:</p>
<p><code class="docutils literal notranslate"><span class="pre">asctime</span></code>, <code class="docutils literal notranslate"><span class="pre">asctime_r</span></code>, <code class="docutils literal notranslate"><span class="pre">bsearch</span></code>, <code class="docutils literal notranslate"><span class="pre">ctime</span></code>, <code class="docutils literal notranslate"><span class="pre">fopen</span></code>, <code class="docutils literal notranslate"><span class="pre">fprintf</span></code>,
<code class="docutils literal notranslate"><span class="pre">freopen</span></code>, <code class="docutils literal notranslate"><span class="pre">fscanf</span></code>, <code class="docutils literal notranslate"><span class="pre">fwprintf</span></code>, <code class="docutils literal notranslate"><span class="pre">fwscanf</span></code>, <code class="docutils literal notranslate"><span class="pre">getenv</span></code>, <code class="docutils literal notranslate"><span class="pre">gets</span></code>,
<code class="docutils literal notranslate"><span class="pre">gmtime</span></code>, <code class="docutils literal notranslate"><span class="pre">localtime</span></code>, <code class="docutils literal notranslate"><span class="pre">mbsrtowcs</span></code>, <code class="docutils literal notranslate"><span class="pre">mbstowcs</span></code>, <code class="docutils literal notranslate"><span class="pre">memcpy</span></code>,
<code class="docutils literal notranslate"><span class="pre">memmove</span></code>, <code class="docutils literal notranslate"><span class="pre">memset</span></code>, <code class="docutils literal notranslate"><span class="pre">printf</span></code>, <code class="docutils literal notranslate"><span class="pre">qsort</span></code>, <code class="docutils literal notranslate"><span class="pre">scanf</span></code>,  <code class="docutils literal notranslate"><span class="pre">snprintf</span></code>,
<code class="docutils literal notranslate"><span class="pre">sprintf</span></code>,  <code class="docutils literal notranslate"><span class="pre">sscanf</span></code>, <code class="docutils literal notranslate"><span class="pre">strcat</span></code>, <code class="docutils literal notranslate"><span class="pre">strcpy</span></code>, <code class="docutils literal notranslate"><span class="pre">strerror</span></code>, <code class="docutils literal notranslate"><span class="pre">strlen</span></code>,
<code class="docutils literal notranslate"><span class="pre">strncat</span></code>, <code class="docutils literal notranslate"><span class="pre">strncpy</span></code>, <code class="docutils literal notranslate"><span class="pre">strtok</span></code>, <code class="docutils literal notranslate"><span class="pre">swprintf</span></code>, <code class="docutils literal notranslate"><span class="pre">swscanf</span></code>, <code class="docutils literal notranslate"><span class="pre">vfprintf</span></code>,
<code class="docutils literal notranslate"><span class="pre">vfscanf</span></code>, <code class="docutils literal notranslate"><span class="pre">vfwprintf</span></code>, <code class="docutils literal notranslate"><span class="pre">vfwscanf</span></code>, <code class="docutils literal notranslate"><span class="pre">vprintf</span></code>, <code class="docutils literal notranslate"><span class="pre">vscanf</span></code>,
<code class="docutils literal notranslate"><span class="pre">vsnprintf</span></code>, <code class="docutils literal notranslate"><span class="pre">vsprintf</span></code>, <code class="docutils literal notranslate"><span class="pre">vsscanf</span></code>, <code class="docutils literal notranslate"><span class="pre">vswprintf</span></code>, <code class="docutils literal notranslate"><span class="pre">vswscanf</span></code>,
<code class="docutils literal notranslate"><span class="pre">vwprintf</span></code>, <code class="docutils literal notranslate"><span class="pre">vwscanf</span></code>, <code class="docutils literal notranslate"><span class="pre">wcrtomb</span></code>, <code class="docutils literal notranslate"><span class="pre">wcscat</span></code>, <code class="docutils literal notranslate"><span class="pre">wcscpy</span></code>,
<code class="docutils literal notranslate"><span class="pre">wcslen</span></code>, <code class="docutils literal notranslate"><span class="pre">wcsncat</span></code>, <code class="docutils literal notranslate"><span class="pre">wcsncpy</span></code>, <code class="docutils literal notranslate"><span class="pre">wcsrtombs</span></code>, <code class="docutils literal notranslate"><span class="pre">wcstok</span></code>, <code class="docutils literal notranslate"><span class="pre">wcstombs</span></code>,
<code class="docutils literal notranslate"><span class="pre">wctomb</span></code>, <code class="docutils literal notranslate"><span class="pre">wmemcpy</span></code>, <code class="docutils literal notranslate"><span class="pre">wmemmove</span></code>, <code class="docutils literal notranslate"><span class="pre">wprintf</span></code>, <code class="docutils literal notranslate"><span class="pre">wscanf</span></code>.</p>
<p>If <em>Annex K.</em> is not available, replacements are suggested only for the
following functions from the previous list:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">asctime</span></code>, <code class="docutils literal notranslate"><span class="pre">asctime_r</span></code>, suggested replacement: <code class="docutils literal notranslate"><span class="pre">strftime</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gets</span></code>, suggested replacement: <code class="docutils literal notranslate"><span class="pre">fgets</span></code></p></li>
</ul>
</div></blockquote>
<p>The following functions are always checked, regardless of <em>Annex K</em>
availability:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">rewind</span></code>, suggested replacement: <code class="docutils literal notranslate"><span class="pre">fseek</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">setbuf</span></code>, suggested replacement: <code class="docutils literal notranslate"><span class="pre">setvbuf</span></code></p></li>
</ul>
</div></blockquote>
<p>If <a class="reference internal" href="#cmdoption-arg-ReportMoreUnsafeFunctions"><code class="xref std std-option docutils literal notranslate"><span class="pre">ReportMoreUnsafeFunctions</span></code></a> is enabled,
the following functions are also checked:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bcmp</span></code>, suggested replacement: <code class="docutils literal notranslate"><span class="pre">memcmp</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bcopy</span></code>, suggested replacement: <code class="docutils literal notranslate"><span class="pre">memcpy_s</span></code> if <em>Annex K</em> is available,
or <code class="docutils literal notranslate"><span class="pre">memcpy</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bzero</span></code>, suggested replacement: <code class="docutils literal notranslate"><span class="pre">memset_s</span></code> if <em>Annex K</em> is available,
or <code class="docutils literal notranslate"><span class="pre">memset</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">getpw</span></code>, suggested replacement: <code class="docutils literal notranslate"><span class="pre">getpwuid</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vfork</span></code>, suggested replacement: <code class="docutils literal notranslate"><span class="pre">posix_spawn</span></code></p></li>
</ul>
</div></blockquote>
<p>Although mentioned in the associated CERT rules, the following functions are
<strong>ignored</strong> by the check:</p>
<p><code class="docutils literal notranslate"><span class="pre">atof</span></code>, <code class="docutils literal notranslate"><span class="pre">atoi</span></code>, <code class="docutils literal notranslate"><span class="pre">atol</span></code>, <code class="docutils literal notranslate"><span class="pre">atoll</span></code>, <code class="docutils literal notranslate"><span class="pre">tmpfile</span></code>.</p>
<p>The availability of <em>Annex K</em> is determined based on the following macros:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">__STDC_LIB_EXT1__</span></code>: feature macro, which indicates the presence of
<em>Annex K. “Bounds-checking interfaces”</em> in the library implementation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">__STDC_WANT_LIB_EXT1__</span></code>: user-defined macro, which indicates that the
user requests the functions from <em>Annex K.</em> to be defined.</p></li>
</ul>
</div></blockquote>
<p>Both macros have to be defined to suggest replacement functions from <em>Annex K.</em>
<code class="docutils literal notranslate"><span class="pre">__STDC_LIB_EXT1__</span></code> is defined by the library implementation, and
<code class="docutils literal notranslate"><span class="pre">__STDC_WANT_LIB_EXT1__</span></code> must be defined to <code class="docutils literal notranslate"><span class="pre">1</span></code> by the user <strong>before</strong>
including any system headers.</p>
</section>
<section id="custom-functions">
<span id="customfunctions"></span><h2>Custom functions<a class="headerlink" href="#custom-functions" title="Link to this heading">¶</a></h2>
<p>The option <a class="reference internal" href="#cmdoption-arg-CustomFunctions"><code class="xref std std-option docutils literal notranslate"><span class="pre">CustomFunctions</span></code></a> allows the user to define custom functions
to be checked. The format is the following, without newlines:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bugprone</span><span class="o">-</span><span class="n">unsafe</span><span class="o">-</span><span class="n">functions</span><span class="o">.</span><span class="n">CustomFunctions</span><span class="o">=</span><span class="s2">&quot;</span>
  <span class="n">functionRegex1</span><span class="p">[,</span> <span class="n">replacement1</span><span class="p">[,</span> <span class="n">reason1</span><span class="p">]];</span>
  <span class="n">functionRegex2</span><span class="p">[,</span> <span class="n">replacement2</span><span class="p">[,</span> <span class="n">reason2</span><span class="p">]];</span>
  <span class="o">...</span>
<span class="s2">&quot;</span>
</pre></div>
</div>
<p>The functions are matched using POSIX extended regular expressions.
<em>(Note: The regular expressions do not support negative</em> <code class="docutils literal notranslate"><span class="pre">(?!)</span></code> <em>matches.)</em></p>
<p>The <cite>reason</cite> is optional and is used to provide additional information about
the reasoning behind the replacement. The default reason is
<cite>is marked as unsafe</cite>.</p>
<p>If <cite>replacement</cite> is empty, the default text <cite>it should not be used</cite> will be
shown instead of the suggestion for a replacement.</p>
<p>If the <cite>reason</cite> starts with the character <cite>&gt;</cite>, the reason becomes fully
custom. The default suffix is disabled even if a <cite>replacement</cite> is present,
and only the reason message is shown after the matched function, to allow
better control over the suggestions. (The starting <cite>&gt;</cite> and whitespace
directly after it are trimmed from the message.)</p>
<p>As an example, the following configuration matches only the function
<code class="docutils literal notranslate"><span class="pre">original</span></code> in the default namespace. A similar diagnostic can also be printed
using a fully custom reason.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">// bugprone-unsafe-functions.CustomFunctions:</span>
<span class="c1">//   ^original$, replacement, is deprecated;</span>
<span class="c1">// Using the fully custom message syntax:</span>
<span class="c1">//   ^suspicious$,,&gt; should be avoided if possible.</span>
<span class="n">original</span><span class="p">();</span><span class="w"> </span><span class="c1">// warning: function &#39;original&#39; is deprecated; &#39;replacement&#39; should be used instead.</span>
<span class="n">suspicious</span><span class="p">();</span><span class="w"> </span><span class="c1">// warning: function &#39;suspicious&#39; should be avoided if possible.</span>
<span class="o">::</span><span class="n">std</span><span class="o">::</span><span class="n">original</span><span class="p">();</span><span class="w"> </span><span class="c1">// no-warning</span>
<span class="n">original_function</span><span class="p">();</span><span class="w"> </span><span class="c1">// no-warning</span>
</pre></div>
</div>
<p>If the regular expression contains the character <cite>:</cite>, it is matched against
the qualified name (i.e. <code class="docutils literal notranslate"><span class="pre">std::original</span></code>), otherwise the regex is matched
against the unqualified name (<code class="docutils literal notranslate"><span class="pre">original</span></code>). If the regular expression starts
with <cite>::</cite> (or <cite>^::</cite>), it is matched against the fully qualified name
(<code class="docutils literal notranslate"><span class="pre">::std::original</span></code>).</p>
<p>One of the use cases for fully custom messages is suggesting compiler options
and warning flags:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">// bugprone-unsafe-functions.CustomFunctions:</span>
<span class="c1">//   ^memcpy$,,&gt;is recommended to have compiler hardening using &#39;_FORTIFY_SOURCE&#39;;</span>
<span class="c1">//   ^printf$,,&gt;is recommended to have the &#39;-Werror=format-security&#39; compiler warning flag;</span>

<span class="n">memcpy</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span><span class="w"> </span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="mi">999&#39;999</span><span class="p">);</span><span class="w"> </span><span class="c1">// warning: function &#39;memcpy&#39; is recommended to have compiler hardening using &#39;_FORTIFY_SOURCE&#39;</span>
<span class="n">printf</span><span class="p">(</span><span class="n">raw_str</span><span class="p">);</span><span class="w"> </span><span class="c1">// warning: function &#39;printf&#39; is recommended to have the &#39;-Werror=format-security&#39; compiler warning flag</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Fully qualified names can contain template parameters on certain C++ classes,
but not on C++ functions. Type aliases are resolved before matching.</p>
<p>As an example, the member function <code class="docutils literal notranslate"><span class="pre">open</span></code> in the class <code class="docutils literal notranslate"><span class="pre">std::ifstream</span></code>
has a fully qualified name of <code class="docutils literal notranslate"><span class="pre">::std::basic_ifstream&lt;char&gt;::open</span></code>.</p>
<p>The example could also be matched with the regex
<code class="docutils literal notranslate"><span class="pre">::std::basic_ifstream&lt;[^&gt;]*&gt;::open</span></code>, which matches all potential template
parameters, but does not match nested template classes.</p>
</div>
</section>
<section id="options">
<h2>Options<a class="headerlink" href="#options" title="Link to this heading">¶</a></h2>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-ReportMoreUnsafeFunctions">
<span class="sig-name descname"><span class="pre">ReportMoreUnsafeFunctions</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-ReportMoreUnsafeFunctions" title="Link to this definition">¶</a></dt>
<dd><p>When <cite>true</cite>, additional functions from widely used APIs (such as POSIX) are
added to the list of reported functions.
See the main documentation of the check for the complete list as to what
this option enables.
Default is <cite>true</cite>.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-ReportDefaultFunctions">
<span class="sig-name descname"><span class="pre">ReportDefaultFunctions</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-ReportDefaultFunctions" title="Link to this definition">¶</a></dt>
<dd><p>When <cite>true</cite>, the check reports the default set of functions.
Consider changing the setting to false if you only want to see custom
functions matched via <a class="reference internal" href="#customfunctions"><span class="std std-ref">custom functions</span></a>.
Default is <cite>true</cite>.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-arg-CustomFunctions">
<span class="sig-name descname"><span class="pre">CustomFunctions</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-arg-CustomFunctions" title="Link to this definition">¶</a></dt>
<dd><p>A semicolon-separated list of custom functions to be matched. A matched
function contains a regular expression, an optional name of the replacement
function, and an optional reason, separated by comma. For more information,
see <a class="reference internal" href="#customfunctions"><span class="std std-ref">Custom functions</span></a>.</p>
</dd></dl>

</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Link to this heading">¶</a></h2>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifndef __STDC_LIB_EXT1__</span>
<span class="cp">#error &quot;Annex K is not supported by the current standard library implementation.&quot;</span>
<span class="cp">#endif</span>

<span class="cp">#define __STDC_WANT_LIB_EXT1__ 1</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string.h&gt;</span><span class="c1"> // Defines functions from Annex K.</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>

<span class="k">enum</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">BUFSIZE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">32</span><span class="w"> </span><span class="p">};</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">Unsafe</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">Msg</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">Prefix</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Error: &quot;</span><span class="p">;</span>
<span class="w">  </span><span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">Suffix</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">Buf</span><span class="p">[</span><span class="n">BUFSIZE</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>

<span class="w">  </span><span class="n">strcpy</span><span class="p">(</span><span class="n">Buf</span><span class="p">,</span><span class="w"> </span><span class="n">Prefix</span><span class="p">);</span><span class="w"> </span><span class="c1">// warning: function &#39;strcpy&#39; is not bounds-checking; &#39;strcpy_s&#39; should be used instead.</span>
<span class="w">  </span><span class="n">strcat</span><span class="p">(</span><span class="n">Buf</span><span class="p">,</span><span class="w"> </span><span class="n">Msg</span><span class="p">);</span><span class="w">    </span><span class="c1">// warning: function &#39;strcat&#39; is not bounds-checking; &#39;strcat_s&#39; should be used instead.</span>
<span class="w">  </span><span class="n">strcat</span><span class="p">(</span><span class="n">Buf</span><span class="p">,</span><span class="w"> </span><span class="n">Suffix</span><span class="p">);</span><span class="w"> </span><span class="c1">// warning: function &#39;strcat&#39; is not bounds-checking; &#39;strcat_s&#39; should be used instead.</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fputs</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">stderr</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// error handling</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">UsingSafeFunctions</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">Msg</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">Prefix</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Error: &quot;</span><span class="p">;</span>
<span class="w">  </span><span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">Suffix</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">Buf</span><span class="p">[</span><span class="n">BUFSIZE</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">strcpy_s</span><span class="p">(</span><span class="n">Buf</span><span class="p">,</span><span class="w"> </span><span class="n">BUFSIZE</span><span class="p">,</span><span class="w"> </span><span class="n">Prefix</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// error handling</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">strcat_s</span><span class="p">(</span><span class="n">Buf</span><span class="p">,</span><span class="w"> </span><span class="n">BUFSIZE</span><span class="p">,</span><span class="w"> </span><span class="n">Msg</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// error handling</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">strcat_s</span><span class="p">(</span><span class="n">Buf</span><span class="p">,</span><span class="w"> </span><span class="n">BUFSIZE</span><span class="p">,</span><span class="w"> </span><span class="n">Suffix</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// error handling</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fputs</span><span class="p">(</span><span class="n">Buf</span><span class="p">,</span><span class="w"> </span><span class="n">stderr</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// error handling</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="unique-ptr-array-mismatch.html">bugprone-unique-ptr-array-mismatch</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../../../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="unused-local-non-trivial-variable.html">bugprone-unused-local-non-trivial-variable</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer" role="contentinfo">
    &#169; Copyright 2007-2026, The Clang Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>