

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Symbolizer Markup Format &#8212; LLVM 15.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/llvm-theme.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="System Library" href="SystemLibrary.html" />
    <link rel="prev" title="Garbage Collection Safepoints in LLVM" href="Statepoints.html" />
<style type="text/css">
  table.right { float: right; margin-left: 20px; }
  table.right td { border: 1px solid #ccc; }
</style>

  </head><body>
<div class="logo">
  <a href="index.html">
    <img src="_static/logo.png"
         alt="LLVM Logo" width="250" height="88"/></a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="SystemLibrary.html" title="System Library"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="Statepoints.html" title="Garbage Collection Safepoints in LLVM"
             accesskey="P">previous</a> |</li>
  <li><a href="https://llvm.org/">LLVM Home</a>&nbsp;|&nbsp;</li>
  <li><a href="index.html">Documentation</a>&raquo;</li>

          <li class="nav-item nav-item-1"><a href="Reference.html" accesskey="U">Reference</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Symbolizer Markup Format</a></li> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">

<h3>Documentation</h3>

<ul class="want-points">
    <li><a href="https://llvm.org/docs/GettingStartedTutorials.html">Getting Started/Tutorials</a></li>
    <li><a href="https://llvm.org/docs/UserGuides.html">User Guides</a></li>
    <li><a href="https://llvm.org/docs/Reference.html">Reference</a></li>
</ul>

<h3>Getting Involved</h3>

<ul class="want-points">
    <li><a href="https://llvm.org/docs/Contributing.html">Contributing to LLVM</a></li>
    <li><a href="https://llvm.org/docs/HowToSubmitABug.html">Submitting Bug Reports</a></li>
    <li><a href="https://llvm.org/docs/GettingInvolved.html#mailing-lists">Mailing Lists</a></li>
    <li><a href="https://llvm.org/docs/GettingInvolved.html#irc">IRC</a></li>
    <li><a href="https://llvm.org/docs/GettingInvolved.html#meetups-and-social-events">Meetups and Social Events</a></li>
</ul>

<h3>Additional Links</h3>

<ul class="want-points">
    <li><a href="https://llvm.org/docs/FAQ.html">FAQ</a></li>
    <li><a href="https://llvm.org/docs/Lexicon.html">Glossary</a></li>
    <li><a href="https://llvm.org/pubs">Publications</a></li>
    <li><a href="https://github.com/llvm/llvm-project//">Github Repository</a></li>
</ul>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/SymbolizerMarkupFormat.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="symbolizer-markup-format">
<h1>Symbolizer Markup Format<a class="headerlink" href="#symbolizer-markup-format" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#overview" id="id6">Overview</a></p></li>
<li><p><a class="reference internal" href="#scope-and-assumptions" id="id7">Scope and assumptions</a></p></li>
<li><p><a class="reference internal" href="#dependence-on-build-ids" id="id8">Dependence on Build IDs</a></p></li>
<li><p><a class="reference internal" href="#colorization" id="id9">Colorization</a></p></li>
<li><p><a class="reference internal" href="#common-markup-element-syntax" id="id10">Common markup element syntax</a></p></li>
<li><p><a class="reference internal" href="#presentation-elements" id="id11">Presentation elements</a></p></li>
<li><p><a class="reference internal" href="#trigger-elements" id="id12">Trigger elements</a></p></li>
<li><p><a class="reference internal" href="#contextual-elements" id="id13">Contextual elements</a></p></li>
</ul>
</div>
<div class="section" id="overview">
<h2><a class="toc-backref" href="#id6">Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>This document defines a text format for log messages that can be processed by a
symbolizing filter. The basic idea is that logging code emits text that contains
raw address values and so forth, without the logging code doing any real work to
convert those values to human-readable form. Instead, logging text uses the
markup format defined here to identify pieces of information that should be
converted to human-readable form after the fact. As with other markup formats,
the expectation is that most of the text will be displayed as is, while the
markup elements will be replaced with expanded text, or converted into active UI
elements, that present more details in symbolic form.</p>
<p>This means there is no need for symbol tables, DWARF debugging sections, or
similar information to be directly accessible at runtime. There is also no need
at runtime for any logic intended to compute human-readable presentation of
information, such as C++ symbol demangling. Instead, logging must include markup
elements that give the contextual information necessary to make sense of the raw
data, such as memory layout details.</p>
<p>This format identifies markup elements with a syntax that is both simple and
distinctive. It’s simple enough to be matched and parsed with straightforward
code. It’s distinctive enough that character sequences that look like the start
or end of a markup element should rarely if ever appear incidentally in logging
text. It’s specifically intended not to require sanitizing plain text, such as
the HTML/XML requirement to replace <code class="docutils literal notranslate"><span class="pre">&lt;</span></code> with <code class="docutils literal notranslate"><span class="pre">&amp;lt;</span></code> and the like.</p>
<p><em class="manpage"><a class="manpage reference external" href="https://llvm.org/docs/CommandGuide/llvm-symbolizer.html">llvm-symbolizer(1)</a></em> includes a symbolizing filter via its <code class="docutils literal notranslate"><span class="pre">--filter</span></code>
option.</p>
</div>
<div class="section" id="scope-and-assumptions">
<h2><a class="toc-backref" href="#id7">Scope and assumptions</a><a class="headerlink" href="#scope-and-assumptions" title="Permalink to this headline">¶</a></h2>
<p>A symbolizing filter implementation will be independent both of the target
operating system and machine architecture where the logs are generated and of
the host operating system and machine architecture where the filter runs.</p>
<p>This format assumes that the symbolizing filter processes intact whole lines. If
long lines might be split during some stage of a logging pipeline, they must be
reassembled to restore the original line breaks before feeding lines into the
symbolizing filter. Most markup elements must appear entirely on a single line
(often with other text before and/or after the markup element). There are some
markup elements that are specified to span lines, with line breaks in the middle
of the element. Even in those cases, the filter is not expected to handle line
breaks in arbitrary places inside a markup element, but only inside certain
fields.</p>
<p>This format assumes that the symbolizing filter processes a coherent stream of
log lines from a single process address space context. If a logging stream
interleaves log lines from more than one process, these must be collated into
separate per-process log streams and each stream processed by a separate
instance of the symbolizing filter. Because the kernel and user processes use
disjoint address regions in most operating systems, a single user process
address space plus the kernel address space can be treated as a single address
space for symbolization purposes if desired.</p>
</div>
<div class="section" id="dependence-on-build-ids">
<h2><a class="toc-backref" href="#id8">Dependence on Build IDs</a><a class="headerlink" href="#dependence-on-build-ids" title="Permalink to this headline">¶</a></h2>
<p>The symbolizer markup scheme relies on contextual information about runtime
memory address layout to make it possible to convert markup elements into useful
symbolic form. This relies on having an unmistakable identification of which
binary was loaded at each address.</p>
<p>An ELF Build ID is the payload of an ELF note with name <code class="docutils literal notranslate"><span class="pre">&quot;GNU&quot;</span></code> and type
<code class="docutils literal notranslate"><span class="pre">NT_GNU_BUILD_ID</span></code>, a unique byte sequence that identifies a particular binary
(executable, shared library, loadable module, or driver module). The linker
generates this automatically based on a hash that includes the complete symbol
table and debugging information, even if this is later stripped from the binary.</p>
<p>This specification uses the ELF Build ID as the sole means of identifying
binaries. Each binary relevant to the log must have been linked with a unique
Build ID. The symbolizing filter must have some means of mapping a Build ID back
to the original ELF binary (either the whole unstripped binary, or a stripped
binary paired with a separate debug file).</p>
</div>
<div class="section" id="colorization">
<h2><a class="toc-backref" href="#id9">Colorization</a><a class="headerlink" href="#colorization" title="Permalink to this headline">¶</a></h2>
<p>The markup format supports a restricted subset of ANSI X3.64 SGR (Select Graphic
Rendition) control sequences. These are unlike other markup elements:</p>
<ul class="simple">
<li><p>They specify presentation details (bold or colors) rather than semantic
information. The association of semantic meaning with color (e.g. red for
errors) is chosen by the code doing the logging, rather than by the UI
presentation of the symbolizing filter. This is a concession to existing code
(e.g. LLVM sanitizer runtimes) that use specific colors and would require
substantial changes to generate semantic markup instead.</p></li>
<li><p>A single control sequence changes “the state”, rather than being an
hierarchical structure that surrounds affected text.</p></li>
</ul>
<p>The filter processes ANSI SGR control sequences only within a single line. If a
control sequence to enter a bold or color state is encountered, it’s expected
that the control sequence to reset to default state will be encountered before
the end of that line. If a “dangling” state is left at the end of a line, the
filter may reset to default state for the next line.</p>
<p>An SGR control sequence is not interpreted inside any other markup element.
However, other markup elements may appear between SGR control sequences and the
color/bold state is expected to apply to the symbolic output that replaces the
markup element in the filter’s output.</p>
<p>The accepted SGR control sequences all have the form <code class="docutils literal notranslate"><span class="pre">&quot;\033[%um&quot;</span></code> (expressed here
using C string syntax), where <code class="docutils literal notranslate"><span class="pre">%u</span></code> is one of these:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 5%" />
<col style="width: 35%" />
<col style="width: 59%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Code</p></th>
<th class="head"><p>Effect</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Reset to default formatting.</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Bold text</p></td>
<td><p>Combines with color states, doesn’t reset them.</p></td>
</tr>
<tr class="row-even"><td><p>30</p></td>
<td><p>Black foreground</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>31</p></td>
<td><p>Red foreground</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>32</p></td>
<td><p>Green foreground</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>33</p></td>
<td><p>Yellow foreground</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>34</p></td>
<td><p>Blue foreground</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>35</p></td>
<td><p>Magenta foreground</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>36</p></td>
<td><p>Cyan foreground</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>37</p></td>
<td><p>White foreground</p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="common-markup-element-syntax">
<h2><a class="toc-backref" href="#id10">Common markup element syntax</a><a class="headerlink" href="#common-markup-element-syntax" title="Permalink to this headline">¶</a></h2>
<p>All the markup elements share a common syntactic structure to facilitate simple
matching and parsing code. Each element has the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{{</span><span class="n">tag</span><span class="p">:</span><span class="n">fields</span><span class="p">}}}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">tag</span></code> identifies one of the element types described below, and is always a
short alphabetic string that must be in lower case. The rest of the element
consists of one or more fields. Fields are separated by <code class="docutils literal notranslate"><span class="pre">:</span></code> and cannot contain
any <code class="docutils literal notranslate"><span class="pre">:</span></code> or <code class="docutils literal notranslate"><span class="pre">}</span></code> characters. How many fields must be or may be present and
what they contain is specified for each element type.</p>
<p>No markup elements or ANSI SGR control sequences are interpreted inside the
contents of a field.</p>
<p>In the descriptions of each element type, <code class="docutils literal notranslate"><span class="pre">printf</span></code>-style placeholders indicate
field contents:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">%s</span></code></dt><dd><p>A string of printable characters, not including <code class="docutils literal notranslate"><span class="pre">:</span></code> or <code class="docutils literal notranslate"><span class="pre">}</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">%p</span></code></dt><dd><p>An address value represented by <code class="docutils literal notranslate"><span class="pre">0x</span></code> followed by an even number of
hexadecimal digits (using either lower-case or upper-case for <code class="docutils literal notranslate"><span class="pre">A</span></code>–<code class="docutils literal notranslate"><span class="pre">F</span></code>).
If the digits are all <code class="docutils literal notranslate"><span class="pre">0</span></code> then the <code class="docutils literal notranslate"><span class="pre">0x</span></code> prefix may be omitted. No more
than 16 hexadecimal digits are expected to appear in a single value (64 bits).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">%u</span></code></dt><dd><p>A nonnegative decimal integer.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">%i</span></code></dt><dd><p>A nonnegative integer. The digits are hexadecimal if prefixed by <code class="docutils literal notranslate"><span class="pre">0x</span></code>, octal
if prefixed by <code class="docutils literal notranslate"><span class="pre">0</span></code>, or decimal otherwise.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">%x</span></code></dt><dd><p>A sequence of an even number of hexadecimal digits (using either lower-case or
upper-case for <code class="docutils literal notranslate"><span class="pre">A</span></code>–<code class="docutils literal notranslate"><span class="pre">F</span></code>), with no <code class="docutils literal notranslate"><span class="pre">0x</span></code> prefix. This represents an
arbitrary sequence of bytes, such as an ELF Build ID.</p>
</dd>
</dl>
</div>
<div class="section" id="presentation-elements">
<h2><a class="toc-backref" href="#id11">Presentation elements</a><a class="headerlink" href="#presentation-elements" title="Permalink to this headline">¶</a></h2>
<p>These are elements that convey a specific program entity to be displayed in
human-readable symbolic form.</p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">{{{symbol:%s}}}</span></code></dt><dd><p>Here <code class="docutils literal notranslate"><span class="pre">%s</span></code> is the linkage name for a symbol or type. It may require
demangling according to language ABI rules. Even for unmangled names, it’s
recommended that this markup element be used to identify a symbol name so that
it can be presented distinctively.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{{</span><span class="n">symbol</span><span class="p">:</span><span class="n">_ZN7Mangled4NameEv</span><span class="p">}}}</span>
<span class="p">{{{</span><span class="n">symbol</span><span class="p">:</span><span class="n">foobar</span><span class="p">}}}</span>
</pre></div>
</div>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">{{{pc:%p}}}</span></code>, <code class="docutils literal notranslate"><span class="pre">{{{pc:%p:ra}}}</span></code>, <code class="docutils literal notranslate"><span class="pre">{{{pc:%p:pc}}}</span></code> <a class="footnote-reference brackets" href="#not-yet-implemented" id="id1">1</a></p>
<blockquote>
<div><p>Here <code class="docutils literal notranslate"><span class="pre">%p</span></code> is the memory address of a code location. It might be presented as a
function name and source location. The second two forms distinguish the kind of
code location, as described in detail for bt elements below.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{{</span><span class="n">pc</span><span class="p">:</span><span class="mh">0x12345678</span><span class="p">}}}</span>
<span class="p">{{{</span><span class="n">pc</span><span class="p">:</span><span class="mh">0xffffffff9abcdef0</span><span class="p">}}}</span>
</pre></div>
</div>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">{{{data:%p}}}</span></code> <a class="footnote-reference brackets" href="#not-yet-implemented" id="id2">1</a></p>
<blockquote>
<div><p>Here <code class="docutils literal notranslate"><span class="pre">%p</span></code> is the memory address of a data location. It might be presented as
the name of a global variable at that location.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{{</span><span class="n">data</span><span class="p">:</span><span class="mh">0x12345678</span><span class="p">}}}</span>
<span class="p">{{{</span><span class="n">data</span><span class="p">:</span><span class="mh">0xffffffff9abcdef0</span><span class="p">}}}</span>
</pre></div>
</div>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">{{{bt:%u:%p}}}</span></code>, <code class="docutils literal notranslate"><span class="pre">{{{bt:%u:%p:ra}}}</span></code>, <code class="docutils literal notranslate"><span class="pre">{{{bt:%u:%p:pc}}}</span></code> <a class="footnote-reference brackets" href="#not-yet-implemented" id="id3">1</a></p>
<blockquote>
<div><p>This represents one frame in a backtrace. It usually appears on a line by
itself (surrounded only by whitespace), in a sequence of such lines with
ascending frame numbers. So the human-readable output might be formatted
assuming that, such that it looks good for a sequence of bt elements each
alone on its line with uniform indentation of each line. But it can appear
anywhere, so the filter should not remove any non-whitespace text surrounding
the element.</p>
<p>Here <code class="docutils literal notranslate"><span class="pre">%u</span></code> is the frame number, which starts at zero for the location of the
fault being identified, increments to one for the caller of frame zero’s call
frame, to two for the caller of frame one, etc. <code class="docutils literal notranslate"><span class="pre">%p</span></code> is the memory address
of a code location.</p>
<p>Code locations in a backtrace come from two distinct sources. Most backtrace
frames describe a return address code location, i.e. the instruction
immediately after a call instruction. This is the location of code that has
yet to run, since the function called there has not yet returned. Hence the
code location of actual interest is usually the call site itself rather than
the return address, i.e. one instruction earlier. When presenting the source
location for a return address frame, the symbolizing filter will subtract one
byte or one instruction length from the actual return address for the call
site, with the intent that the address logged can be translated directly to a
source location for the call site and not for the apparent return site
thereafter (which can be confusing).  When inlined functions are involved, the
call site and the return site can appear to be in different functions at
entirely unrelated source locations rather than just a line away, making the
confusion of showing the return site rather the call site quite severe.</p>
<p>Often the first frame in a backtrace (“frame zero”) identifies the precise
code location of a fault, trap, or asynchronous interrupt rather than a return
address. At other times, even the first frame is actually a return address
(for example, backtraces collected at the time of an object allocation and
reported later when the allocated object is used or misused). When a system
supports in-thread trap handling, there may also be frames after the first
that represent a precise interrupted code location rather than a return
address, presented as the “caller” of a trap handler function (for example,
signal handlers in POSIX systems).</p>
<p>Return address frames are identified by the <code class="docutils literal notranslate"><span class="pre">:ra</span></code> suffix. Precise code
location frames are identified by the <code class="docutils literal notranslate"><span class="pre">:pc</span></code> suffix.</p>
<p>Traditional practice has often been to collect backtraces as simple address
lists, losing the distinction between return address code locations and
precise code locations. Some such code applies the “subtract one” adjustment
described above to the address values before reporting them, and it’s not
always clear or consistent whether this adjustment has been applied or not.
These ambiguous cases are supported by the <code class="docutils literal notranslate"><span class="pre">bt</span></code> and <code class="docutils literal notranslate"><span class="pre">pc</span></code> forms with no
<code class="docutils literal notranslate"><span class="pre">:ra</span></code> or <code class="docutils literal notranslate"><span class="pre">:pc</span></code> suffix, which indicate it’s unclear which sort of code
location this is.  However, it’s highly recommended that all emitters use the
suffixed forms and deliver address values with no adjustments applied. When
traditional practice has been ambiguous, the majority of cases seem to have
been of printing addresses that are return address code locations and printing
them without adjustment. So the symbolizing filter will usually apply the
“subtract one byte” adjustment to an address printed without a disambiguating
suffix. Assuming that a call instruction is longer than one byte on all
supported machines, applying the “subtract one byte” adjustment a second time
still results in an address somewhere in the call instruction, so a little
sloppiness here often does little or no harm.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{{</span><span class="n">bt</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mh">0x12345678</span><span class="p">:</span><span class="n">pc</span><span class="p">}}}</span>
<span class="p">{{{</span><span class="n">bt</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mh">0xffffffff9abcdef0</span><span class="p">:</span><span class="n">ra</span><span class="p">}}}</span>
</pre></div>
</div>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">{{{hexdict:...}}}</span></code> <a class="footnote-reference brackets" href="#not-yet-implemented" id="id4">1</a></p>
<blockquote>
<div><p>This element can span multiple lines. Here <code class="docutils literal notranslate"><span class="pre">...</span></code> is a sequence of key-value
pairs where a single <code class="docutils literal notranslate"><span class="pre">:</span></code> separates each key from its value, and arbitrary
whitespace separates the pairs. The value (right-hand side) of each pair
either is one or more <code class="docutils literal notranslate"><span class="pre">0</span></code> digits, or is <code class="docutils literal notranslate"><span class="pre">0x</span></code> followed by hexadecimal
digits. Each value might be a memory address or might be some other integer
(including an integer that looks like a likely memory address but actually has
an unrelated purpose). When the contextual information about the memory layout
suggests that a given value could be a code location or a global variable data
address, it might be presented as a source location or variable name or with
active UI that makes such interpretation optionally visible.</p>
<p>The intended use is for things like register dumps, where the emitter doesn’t
know which values might have a symbolic interpretation but a presentation that
makes plausible symbolic interpretations available might be very useful to
someone reading the log. At the same time, a flat text presentation should
usually avoid interfering too much with the original contents and formatting
of the dump. For example, it might use footnotes with source locations for
values that appear to be code locations. An active UI presentation might show
the dump text as is, but highlight values with symbolic information available
and pop up a presentation of symbolic details when a value is selected.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{{</span><span class="n">hexdict</span><span class="p">:</span>
    <span class="n">CS</span><span class="p">:</span>                   <span class="mi">0</span> <span class="n">RIP</span><span class="p">:</span>     <span class="mh">0x6ee17076fb80</span> <span class="n">EFL</span><span class="p">:</span>            <span class="mh">0x10246</span> <span class="n">CR2</span><span class="p">:</span>                  <span class="mi">0</span>
    <span class="n">RAX</span><span class="p">:</span>      <span class="mh">0xc53d0acbcf0</span> <span class="n">RBX</span><span class="p">:</span>     <span class="mh">0x1e659ea7e0d0</span> <span class="n">RCX</span><span class="p">:</span>                  <span class="mi">0</span> <span class="n">RDX</span><span class="p">:</span>     <span class="mh">0x6ee1708300cc</span>
    <span class="n">RSI</span><span class="p">:</span>                  <span class="mi">0</span> <span class="n">RDI</span><span class="p">:</span>     <span class="mh">0x6ee170830040</span> <span class="n">RBP</span><span class="p">:</span>     <span class="mh">0x3b13734898e0</span> <span class="n">RSP</span><span class="p">:</span>     <span class="mh">0x3b13734898d8</span>
    <span class="n">R8</span><span class="p">:</span>      <span class="mh">0x3b1373489860</span> <span class="n">R9</span><span class="p">:</span>          <span class="mh">0x2776ff4f</span> <span class="n">R10</span><span class="p">:</span>     <span class="mh">0x2749d3e9a940</span> <span class="n">R11</span><span class="p">:</span>              <span class="mh">0x246</span>
    <span class="n">R12</span><span class="p">:</span>     <span class="mh">0x1e659ea7e0f0</span> <span class="n">R13</span><span class="p">:</span> <span class="mh">0xd7231230fd6ff2e7</span> <span class="n">R14</span><span class="p">:</span>     <span class="mh">0x1e659ea7e108</span> <span class="n">R15</span><span class="p">:</span>      <span class="mh">0xc53d0acbcf0</span>
  <span class="p">}}}</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="trigger-elements">
<h2><a class="toc-backref" href="#id12">Trigger elements</a><a class="headerlink" href="#trigger-elements" title="Permalink to this headline">¶</a></h2>
<p>These elements cause an external action and will be presented to the user in a
human readable form. Generally they trigger an external action to occur that
results in a linkable page. The link or some other informative information about
the external action can then be presented to the user.</p>
<p><code class="docutils literal notranslate"><span class="pre">{{{dumpfile:%s:%s}}}</span></code> <a class="footnote-reference brackets" href="#not-yet-implemented" id="id5">1</a></p>
<blockquote>
<div><p>Here the first <code class="docutils literal notranslate"><span class="pre">%s</span></code> is an identifier for a type of dump and the second
<code class="docutils literal notranslate"><span class="pre">%s</span></code> is an identifier for a particular dump that’s just been published. The
types of dumps, the exact meaning of “published”, and the nature of the
identifier are outside the scope of the markup format per se. In general it
might correspond to writing a file by that name or something similar.</p>
<p>This element may trigger additional post-processing work beyond symbolizing
the markup. It indicates that a dump file of some sort has been published.
Some logic attached to the symbolizing filter may understand certain types of
dump file and trigger additional post-processing of the dump file upon
encountering this element (e.g. generating visualizations, symbolization). The
expectation is that the information collected from contextual elements
(described below) in the logging stream may be necessary to decode the content
of the dump. So if the symbolizing filter triggers other processing, it may
need to feed some distilled form of the contextual information to those
processes.</p>
<p>An example of a type identifier is <code class="docutils literal notranslate"><span class="pre">sancov</span></code>, for dumps from LLVM
<a class="reference external" href="https://clang.llvm.org/docs/SanitizerCoverage.html">SanitizerCoverage</a>.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{{</span><span class="n">dumpfile</span><span class="p">:</span><span class="n">sancov</span><span class="p">:</span><span class="n">sancov</span><span class="mf">.8675</span><span class="p">}}}</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="contextual-elements">
<h2><a class="toc-backref" href="#id13">Contextual elements</a><a class="headerlink" href="#contextual-elements" title="Permalink to this headline">¶</a></h2>
<p>These are elements that supply information necessary to convert presentation
elements to symbolic form. Unlike presentation elements, they are not directly
related to the surrounding text. Contextual elements should appear alone on
lines with no other non-whitespace text, so that the symbolizing filter might
elide the whole line from its output without hiding any other log text.</p>
<p>The contextual elements themselves do not necessarily need to be presented in
human-readable output. However, the information they impart may be essential to
understanding the logging text even after symbolization. So it’s recommended
that this information be preserved in some form when the original raw log with
markup may no longer be readily accessible for whatever reason.</p>
<p>Contextual elements should appear in the logging stream before they are needed.
That is, if some piece of context may affect how the symbolizing filter would
interpret or present a later presentation element, the necessary contextual
elements should have appeared somewhere earlier in the logging stream. It should
always be possible for the symbolizing filter to be implemented as a single pass
over the raw logging stream, accumulating context and massaging text as it goes.</p>
<p><code class="docutils literal notranslate"><span class="pre">{{{reset}}}</span></code></p>
<blockquote>
<div><p>This should be output before any other contextual element. The need for this
contextual element is to support implementations that handle logs coming from
multiple processes. Such implementations might not know when a new process
starts or ends. Because some identifying information (like process IDs) might
be the same between old and new processes, a way is needed to distinguish two
processes with such identical identifying information. This element informs
such implementations to reset the state of a filter so that information from a
previous process’s contextual elements is not assumed for new process that
just happens have the same identifying information.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">{{{module:%i:%s:%s:...}}}</span></code></p>
<blockquote>
<div><p>This element represents a so-called “module”. A “module” is a single linked
binary, such as a loaded ELF file. Usually each module occupies a contiguous
range of memory.</p>
<p>Here <code class="docutils literal notranslate"><span class="pre">%i</span></code> is the module ID which is used by other contextual elements to
refer to this module. The first <code class="docutils literal notranslate"><span class="pre">%s</span></code> is a human-readable identifier for the
module, such as an ELF <code class="docutils literal notranslate"><span class="pre">DT_SONAME</span></code> string or a file name; but it might be
empty. It’s only for casual information. Only the module ID is used to refer
to this module in other contextual elements, never the <code class="docutils literal notranslate"><span class="pre">%s</span></code> string. The
<code class="docutils literal notranslate"><span class="pre">module</span></code> element defining a module ID must always be emitted before any
other elements that refer to that module ID, so that a filter never needs to
keep track of dangling references. The second <code class="docutils literal notranslate"><span class="pre">%s</span></code> is the module type and it
determines what the remaining fields are. The following module types are
supported:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">elf:%x</span></code></p></li>
</ul>
<p>Here <code class="docutils literal notranslate"><span class="pre">%x</span></code> encodes an ELF Build ID. The Build ID should refer to a single
linked binary. The Build ID string is the sole way to identify the binary from
which this module was loaded.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{{</span><span class="n">module</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="n">libc</span><span class="o">.</span><span class="n">so</span><span class="p">:</span><span class="n">elf</span><span class="p">:</span><span class="mi">83238</span><span class="n">ab56ba10497</span><span class="p">}}}</span>
</pre></div>
</div>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">{{{mmap:%p:%i:...}}}</span></code></p>
<blockquote>
<div><p>This contextual element is used to give information about a particular region
in memory. <code class="docutils literal notranslate"><span class="pre">%p</span></code> is the starting address and <code class="docutils literal notranslate"><span class="pre">%i</span></code> gives the size in hex of the
region of memory. The <code class="docutils literal notranslate"><span class="pre">...</span></code> part can take different forms to give different
information about the specified region of memory. The allowed forms are the
following:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">load:%i:%s:%p</span></code></p></li>
</ul>
<p>This subelement informs the filter that a segment was loaded from a module.
The module is identified by its module ID <code class="docutils literal notranslate"><span class="pre">%i</span></code>. The <code class="docutils literal notranslate"><span class="pre">%s</span></code> is one or more of
the letters ‘r’, ‘w’, and ‘x’ (in that order and in either upper or lower
case) to indicate this segment of memory is readable, writable, and/or
executable. The symbolizing filter can use this information to guess whether
an address is a likely code address or a likely data address in the given
module. The remaining <code class="docutils literal notranslate"><span class="pre">%p</span></code> gives the module relative address. For ELF files
the module relative address will be the <code class="docutils literal notranslate"><span class="pre">p_vaddr</span></code> of the associated program
header. For example if your module’s executable segment has
<code class="docutils literal notranslate"><span class="pre">p_vaddr=0x1000</span></code>, <code class="docutils literal notranslate"><span class="pre">p_memsz=0x1234</span></code>, and was loaded at <code class="docutils literal notranslate"><span class="pre">0x7acba69d5000</span></code>
then you need to subtract <code class="docutils literal notranslate"><span class="pre">0x7acba69d4000</span></code> from any address between
<code class="docutils literal notranslate"><span class="pre">0x7acba69d5000</span></code> and <code class="docutils literal notranslate"><span class="pre">0x7acba69d6234</span></code> to get the module relative address.
The starting address will usually have been rounded down to the active page
size, and the size rounded up.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{{</span><span class="n">mmap</span><span class="p">:</span><span class="mh">0x7acba69d5000</span><span class="p">:</span><span class="mh">0x5a000</span><span class="p">:</span><span class="n">load</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="n">rx</span><span class="p">:</span><span class="mh">0x1000</span><span class="p">}}}</span>
</pre></div>
</div>
</div></blockquote>
<p class="rubric">Footnotes</p>
<dl class="footnote brackets">
<dt class="label" id="not-yet-implemented"><span class="brackets">1</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id2">2</a>,<a href="#id3">3</a>,<a href="#id4">4</a>,<a href="#id5">5</a>)</span></dt>
<dd><p>This markup element is not yet implemented in
<em class="manpage"><a class="manpage reference external" href="https://llvm.org/docs/CommandGuide/llvm-symbolizer.html">llvm-symbolizer(1)</a></em>.</p>
</dd>
</dl>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="SystemLibrary.html" title="System Library"
             >next</a> |</li>
        <li class="right" >
          <a href="Statepoints.html" title="Garbage Collection Safepoints in LLVM"
             >previous</a> |</li>
  <li><a href="https://llvm.org/">LLVM Home</a>&nbsp;|&nbsp;</li>
  <li><a href="index.html">Documentation</a>&raquo;</li>

          <li class="nav-item nav-item-1"><a href="Reference.html" >Reference</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Symbolizer Markup Format</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2003-2022, LLVM Project.
      Last updated on 2022-09-06.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.5.0.
    </div>
  </body>
</html>