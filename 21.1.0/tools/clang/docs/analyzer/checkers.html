<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1. Available Checkers &#8212; Clang 21.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=649a27d8" />
    <link rel="stylesheet" type="text/css" href="../_static/haiku.css?v=e491ac2d" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <script src="../_static/documentation_options.js?v=c54a4614"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2. User Docs" href="user-docs.html" />
    <link rel="prev" title="Clang Static Analyzer" href="../ClangStaticAnalyzer.html" /> 
  </head><body>
      <div class="header" role="banner"><h1 class="heading"><a href="../index.html">
          <span>Clang 21.1.0 documentation</span></a></h1>
        <h2 class="heading"><span>1. Available Checkers</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="../ClangStaticAnalyzer.html">Clang Static Analyzer</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="user-docs.html"><span class="section-number">2. </span>User Docs</a>&#160;&#160;»
        </p>

      </div>
      <div class="content" role="main">
        
        
  <section id="available-checkers">
<h1><a class="toc-backref" href="#id34" role="doc-backlink"><span class="section-number">1. </span>Available Checkers</a><a class="headerlink" href="#available-checkers" title="Link to this heading">¶</a></h1>
<p>The analyzer performs checks that are categorized into families or “checkers”.</p>
<p>The default set of checkers covers a variety of checks targeted at finding security and API usage bugs,
dead code, and other logic errors. See the <a class="reference internal" href="#default-checkers"><span class="std std-ref">Default Checkers</span></a> checkers list below.</p>
<p>In addition to these, the analyzer contains a number of <a class="reference internal" href="#alpha-checkers"><span class="std std-ref">Experimental Checkers</span></a> (aka <em>alpha</em> checkers).
These checkers are under development and are switched off by default. They may crash or emit a higher number of false positives.</p>
<p>The <a class="reference internal" href="#id19"><span class="std std-ref">debug</span></a> package contains checkers for analyzer developers for debugging purposes.</p>
<nav class="contents" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#available-checkers" id="id34">Available Checkers</a></p>
<ul>
<li><p><a class="reference internal" href="#default-checkers" id="id35">Default Checkers</a></p>
<ul>
<li><p><a class="reference internal" href="#core" id="id36">core</a></p>
<ul>
<li><p><a class="reference internal" href="#core-bitwiseshift-c-c" id="id37">core.BitwiseShift (C, C++)</a></p></li>
<li><p><a class="reference internal" href="#core-callandmessage-c-c-objc" id="id38">core.CallAndMessage (C, C++, ObjC)</a></p></li>
<li><p><a class="reference internal" href="#core-dividezero-c-c-objc" id="id39">core.DivideZero (C, C++, ObjC)</a></p></li>
<li><p><a class="reference internal" href="#core-fixedaddressdereference-c-c-objc" id="id40">core.FixedAddressDereference (C, C++, ObjC)</a></p></li>
<li><p><a class="reference internal" href="#core-nonnullparamchecker-c-c-objc" id="id41">core.NonNullParamChecker (C, C++, ObjC)</a></p></li>
<li><p><a class="reference internal" href="#core-nulldereference-c-c-objc" id="id42">core.NullDereference (C, C++, ObjC)</a></p></li>
<li><p><a class="reference internal" href="#core-stackaddressescape-c" id="id43">core.StackAddressEscape (C)</a></p></li>
<li><p><a class="reference internal" href="#core-undefinedbinaryoperatorresult-c" id="id44">core.UndefinedBinaryOperatorResult (C)</a></p></li>
<li><p><a class="reference internal" href="#core-vlasize-c" id="id45">core.VLASize (C)</a></p></li>
<li><p><a class="reference internal" href="#core-uninitialized-arraysubscript-c" id="id46">core.uninitialized.ArraySubscript (C)</a></p></li>
<li><p><a class="reference internal" href="#core-uninitialized-assign-c" id="id47">core.uninitialized.Assign (C)</a></p></li>
<li><p><a class="reference internal" href="#core-uninitialized-branch-c" id="id48">core.uninitialized.Branch (C)</a></p></li>
<li><p><a class="reference internal" href="#core-uninitialized-capturedblockvariable-c" id="id49">core.uninitialized.CapturedBlockVariable (C)</a></p></li>
<li><p><a class="reference internal" href="#core-uninitialized-undefreturn-c" id="id50">core.uninitialized.UndefReturn (C)</a></p></li>
<li><p><a class="reference internal" href="#core-uninitialized-newarraysize-c" id="id51">core.uninitialized.NewArraySize (C++)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#cplusplus" id="id52">cplusplus</a></p>
<ul>
<li><p><a class="reference internal" href="#cplusplus-arraydelete-c" id="id53">cplusplus.ArrayDelete (C++)</a></p></li>
<li><p><a class="reference internal" href="#cplusplus-innerpointer-c" id="id54">cplusplus.InnerPointer (C++)</a></p></li>
<li><p><a class="reference internal" href="#cplusplus-move-c" id="id55">cplusplus.Move (C++)</a></p></li>
<li><p><a class="reference internal" href="#cplusplus-newdelete-c" id="id56">cplusplus.NewDelete (C++)</a></p></li>
<li><p><a class="reference internal" href="#cplusplus-newdeleteleaks-c" id="id57">cplusplus.NewDeleteLeaks (C++)</a></p></li>
<li><p><a class="reference internal" href="#cplusplus-placementnew-c" id="id58">cplusplus.PlacementNew (C++)</a></p></li>
<li><p><a class="reference internal" href="#cplusplus-selfassignment-c" id="id59">cplusplus.SelfAssignment (C++)</a></p></li>
<li><p><a class="reference internal" href="#cplusplus-stringchecker-c" id="id60">cplusplus.StringChecker (C++)</a></p></li>
<li><p><a class="reference internal" href="#cplusplus-purevirtualcall-c" id="id61">cplusplus.PureVirtualCall (C++)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#deadcode" id="id62">deadcode</a></p>
<ul>
<li><p><a class="reference internal" href="#deadcode-deadstores-c" id="id63">deadcode.DeadStores (C)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#nullability" id="id64">nullability</a></p>
<ul>
<li><p><a class="reference internal" href="#nullability-nullpassedtononnull-objc" id="id65">nullability.NullPassedToNonnull (ObjC)</a></p></li>
<li><p><a class="reference internal" href="#nullability-nullreturnedfromnonnull-c-c-objc" id="id66">nullability.NullReturnedFromNonnull (C, C++, ObjC)</a></p></li>
<li><p><a class="reference internal" href="#nullability-nullabledereferenced-objc" id="id67">nullability.NullableDereferenced (ObjC)</a></p></li>
<li><p><a class="reference internal" href="#nullability-nullablepassedtononnull-objc" id="id68">nullability.NullablePassedToNonnull (ObjC)</a></p></li>
<li><p><a class="reference internal" href="#nullability-nullablereturnedfromnonnull-objc" id="id69">nullability.NullableReturnedFromNonnull (ObjC)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#optin" id="id70">optin</a></p>
<ul>
<li><p><a class="reference internal" href="#optin-core-enumcastoutofrange-c-c" id="id71">optin.core.EnumCastOutOfRange (C, C++)</a></p></li>
<li><p><a class="reference internal" href="#optin-cplusplus-uninitializedobject-c" id="id72">optin.cplusplus.UninitializedObject (C++)</a></p></li>
<li><p><a class="reference internal" href="#optin-cplusplus-virtualcall-c" id="id73">optin.cplusplus.VirtualCall (C++)</a></p></li>
<li><p><a class="reference internal" href="#optin-mpi-mpi-checker-c" id="id74">optin.mpi.MPI-Checker (C)</a></p></li>
<li><p><a class="reference internal" href="#optin-osx-cocoa-localizability-emptylocalizationcontextchecker-objc" id="id75">optin.osx.cocoa.localizability.EmptyLocalizationContextChecker (ObjC)</a></p></li>
<li><p><a class="reference internal" href="#optin-osx-cocoa-localizability-nonlocalizedstringchecker-objc" id="id76">optin.osx.cocoa.localizability.NonLocalizedStringChecker (ObjC)</a></p></li>
<li><p><a class="reference internal" href="#optin-performance-gcdantipattern" id="id77">optin.performance.GCDAntipattern</a></p></li>
<li><p><a class="reference internal" href="#optin-performance-padding-c-c-objc" id="id78">optin.performance.Padding (C, C++, ObjC)</a></p></li>
<li><p><a class="reference internal" href="#optin-portability-unixapi" id="id79">optin.portability.UnixAPI</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#optin-taint" id="id80">optin.taint</a></p>
<ul>
<li><p><a class="reference internal" href="#optin-taint-generictaint-c-c" id="id81">optin.taint.GenericTaint (C, C++)</a></p></li>
<li><p><a class="reference internal" href="#optin-taint-taintedalloc-c-c" id="id82">optin.taint.TaintedAlloc (C, C++)</a></p></li>
<li><p><a class="reference internal" href="#optin-taint-tainteddiv-c-c-objc" id="id83">optin.taint.TaintedDiv (C, C++, ObjC)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#security" id="id84">security</a></p>
<ul>
<li><p><a class="reference internal" href="#security-arraybound-c-c" id="id85">security.ArrayBound (C, C++)</a></p></li>
<li><p><a class="reference internal" href="#security-cert-env-invalidptr" id="id86">security.cert.env.InvalidPtr</a></p></li>
<li><p><a class="reference internal" href="#security-floatloopcounter-c" id="id87">security.FloatLoopCounter (C)</a></p></li>
<li><p><a class="reference internal" href="#security-insecureapi-uncheckedreturn-c" id="id88">security.insecureAPI.UncheckedReturn (C)</a></p></li>
<li><p><a class="reference internal" href="#security-insecureapi-bcmp-c" id="id89">security.insecureAPI.bcmp (C)</a></p></li>
<li><p><a class="reference internal" href="#security-insecureapi-bcopy-c" id="id90">security.insecureAPI.bcopy (C)</a></p></li>
<li><p><a class="reference internal" href="#security-insecureapi-bzero-c" id="id91">security.insecureAPI.bzero (C)</a></p></li>
<li><p><a class="reference internal" href="#security-insecureapi-getpw-c" id="id92">security.insecureAPI.getpw (C)</a></p></li>
<li><p><a class="reference internal" href="#security-insecureapi-gets-c" id="id93">security.insecureAPI.gets (C)</a></p></li>
<li><p><a class="reference internal" href="#security-insecureapi-mkstemp-c" id="id94">security.insecureAPI.mkstemp (C)</a></p></li>
<li><p><a class="reference internal" href="#security-insecureapi-mktemp-c" id="id95">security.insecureAPI.mktemp (C)</a></p></li>
<li><p><a class="reference internal" href="#security-insecureapi-rand-c" id="id96">security.insecureAPI.rand (C)</a></p></li>
<li><p><a class="reference internal" href="#security-insecureapi-strcpy-c" id="id97">security.insecureAPI.strcpy (C)</a></p></li>
<li><p><a class="reference internal" href="#security-insecureapi-vfork-c" id="id98">security.insecureAPI.vfork (C)</a></p></li>
<li><p><a class="reference internal" href="#security-insecureapi-deprecatedorunsafebufferhandling-c" id="id99">security.insecureAPI.DeprecatedOrUnsafeBufferHandling (C)</a></p></li>
<li><p><a class="reference internal" href="#security-mmapwriteexec-c" id="id100">security.MmapWriteExec (C)</a></p></li>
<li><p><a class="reference internal" href="#security-pointersub-c" id="id101">security.PointerSub (C)</a></p></li>
<li><p><a class="reference internal" href="#security-putenvstackarray-c" id="id102">security.PutenvStackArray (C)</a></p></li>
<li><p><a class="reference internal" href="#security-setgidsetuidorder-c" id="id103">security.SetgidSetuidOrder (C)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#unix" id="id104">unix</a></p>
<ul>
<li><p><a class="reference internal" href="#unix-api-c" id="id105">unix.API (C)</a></p></li>
<li><p><a class="reference internal" href="#unix-blockincriticalsection-c-c" id="id106">unix.BlockInCriticalSection (C, C++)</a></p></li>
<li><p><a class="reference internal" href="#unix-chroot-c" id="id107">unix.Chroot (C)</a></p></li>
<li><p><a class="reference internal" href="#unix-errno-c" id="id108">unix.Errno (C)</a></p></li>
<li><p><a class="reference internal" href="#unix-malloc-c" id="id109">unix.Malloc (C)</a></p></li>
<li><p><a class="reference internal" href="#unix-mallocsizeof-c" id="id110">unix.MallocSizeof (C)</a></p></li>
<li><p><a class="reference internal" href="#unix-mismatcheddeallocator-c-c" id="id111">unix.MismatchedDeallocator (C, C++)</a></p></li>
<li><p><a class="reference internal" href="#unix-vfork-c" id="id112">unix.Vfork (C)</a></p></li>
<li><p><a class="reference internal" href="#unix-cstring-badsizearg-c" id="id113">unix.cstring.BadSizeArg (C)</a></p></li>
<li><p><a class="reference internal" href="#unix-cstring-notnullterminated-c" id="id114">unix.cstring.NotNullTerminated (C)</a></p></li>
<li><p><a class="reference internal" href="#unix-cstring-nullarg-c" id="id115">unix.cstring.NullArg (C)</a></p></li>
<li><p><a class="reference internal" href="#unix-stdclibraryfunctions-c" id="id116">unix.StdCLibraryFunctions (C)</a></p></li>
<li><p><a class="reference internal" href="#unix-stream-c" id="id117">unix.Stream (C)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#osx" id="id118">osx</a></p>
<ul>
<li><p><a class="reference internal" href="#osx-api-c" id="id119">osx.API (C)</a></p></li>
<li><p><a class="reference internal" href="#osx-numberobjectconversion-c-c-objc" id="id120">osx.NumberObjectConversion (C, C++, ObjC)</a></p></li>
<li><p><a class="reference internal" href="#osx-objcproperty-objc" id="id121">osx.ObjCProperty (ObjC)</a></p></li>
<li><p><a class="reference internal" href="#osx-seckeychainapi-c" id="id122">osx.SecKeychainAPI (C)</a></p></li>
<li><p><a class="reference internal" href="#osx-cocoa-atsync-objc" id="id123">osx.cocoa.AtSync (ObjC)</a></p></li>
<li><p><a class="reference internal" href="#osx-cocoa-autoreleasewrite" id="id124">osx.cocoa.AutoreleaseWrite</a></p></li>
<li><p><a class="reference internal" href="#osx-cocoa-classrelease-objc" id="id125">osx.cocoa.ClassRelease (ObjC)</a></p></li>
<li><p><a class="reference internal" href="#osx-cocoa-dealloc-objc" id="id126">osx.cocoa.Dealloc (ObjC)</a></p></li>
<li><p><a class="reference internal" href="#osx-cocoa-incompatiblemethodtypes-objc" id="id127">osx.cocoa.IncompatibleMethodTypes (ObjC)</a></p></li>
<li><p><a class="reference internal" href="#osx-cocoa-loops" id="id128">osx.cocoa.Loops</a></p></li>
<li><p><a class="reference internal" href="#osx-cocoa-missingsupercall-objc" id="id129">osx.cocoa.MissingSuperCall (ObjC)</a></p></li>
<li><p><a class="reference internal" href="#osx-cocoa-nsautoreleasepool-objc" id="id130">osx.cocoa.NSAutoreleasePool (ObjC)</a></p></li>
<li><p><a class="reference internal" href="#osx-cocoa-nserror-objc" id="id131">osx.cocoa.NSError (ObjC)</a></p></li>
<li><p><a class="reference internal" href="#osx-cocoa-nilarg-objc" id="id132">osx.cocoa.NilArg (ObjC)</a></p></li>
<li><p><a class="reference internal" href="#osx-cocoa-nonnilreturnvalue" id="id133">osx.cocoa.NonNilReturnValue</a></p></li>
<li><p><a class="reference internal" href="#osx-cocoa-objcgenerics-objc" id="id134">osx.cocoa.ObjCGenerics (ObjC)</a></p></li>
<li><p><a class="reference internal" href="#osx-cocoa-retaincount-objc" id="id135">osx.cocoa.RetainCount (ObjC)</a></p></li>
<li><p><a class="reference internal" href="#osx-cocoa-runloopautoreleaseleak" id="id136">osx.cocoa.RunLoopAutoreleaseLeak</a></p></li>
<li><p><a class="reference internal" href="#osx-cocoa-selfinit-objc" id="id137">osx.cocoa.SelfInit (ObjC)</a></p></li>
<li><p><a class="reference internal" href="#osx-cocoa-superdealloc-objc" id="id138">osx.cocoa.SuperDealloc (ObjC)</a></p></li>
<li><p><a class="reference internal" href="#osx-cocoa-unusedivars-objc" id="id139">osx.cocoa.UnusedIvars (ObjC)</a></p></li>
<li><p><a class="reference internal" href="#osx-cocoa-variadicmethodtypes-objc" id="id140">osx.cocoa.VariadicMethodTypes (ObjC)</a></p></li>
<li><p><a class="reference internal" href="#osx-corefoundation-cferror-c" id="id141">osx.coreFoundation.CFError (C)</a></p></li>
<li><p><a class="reference internal" href="#osx-corefoundation-cfnumber-c" id="id142">osx.coreFoundation.CFNumber (C)</a></p></li>
<li><p><a class="reference internal" href="#osx-corefoundation-cfretainrelease-c" id="id143">osx.coreFoundation.CFRetainRelease (C)</a></p></li>
<li><p><a class="reference internal" href="#osx-corefoundation-containers-outofbounds-c" id="id144">osx.coreFoundation.containers.OutOfBounds (C)</a></p></li>
<li><p><a class="reference internal" href="#osx-corefoundation-containers-pointersizedvalues-c" id="id145">osx.coreFoundation.containers.PointerSizedValues (C)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#fuchsia" id="id146">Fuchsia</a></p>
<ul>
<li><p><a class="reference internal" href="#fuchsia-handlechecker" id="id147">fuchsia.HandleChecker</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#webkit" id="id148">WebKit</a></p>
<ul>
<li><p><a class="reference internal" href="#webkit-refcntblbasevirtualdtor" id="id149">webkit.RefCntblBaseVirtualDtor</a></p></li>
<li><p><a class="reference internal" href="#webkit-nouncountedmemberchecker" id="id150">webkit.NoUncountedMemberChecker</a></p></li>
<li><p><a class="reference internal" href="#webkit-uncountedlambdacaptureschecker" id="id151">webkit.UncountedLambdaCapturesChecker</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#experimental-checkers" id="id152">Experimental Checkers</a></p>
<ul>
<li><p><a class="reference internal" href="#alpha-clone" id="id153">alpha.clone</a></p>
<ul>
<li><p><a class="reference internal" href="#alpha-clone-clonechecker-c-c-objc" id="id154">alpha.clone.CloneChecker (C, C++, ObjC)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#alpha-core" id="id155">alpha.core</a></p>
<ul>
<li><p><a class="reference internal" href="#alpha-core-boolassignment-objc" id="id156">alpha.core.BoolAssignment (ObjC)</a></p></li>
<li><p><a class="reference internal" href="#alpha-core-c11lock" id="id157">alpha.core.C11Lock</a></p></li>
<li><p><a class="reference internal" href="#alpha-core-castsize-c" id="id158">alpha.core.CastSize (C)</a></p></li>
<li><p><a class="reference internal" href="#alpha-core-casttostruct-c-c" id="id159">alpha.core.CastToStruct (C, C++)</a></p></li>
<li><p><a class="reference internal" href="#alpha-core-conversion-c-c-objc" id="id160">alpha.core.Conversion (C, C++, ObjC)</a></p></li>
<li><p><a class="reference internal" href="#alpha-core-dynamictypechecker-objc" id="id161">alpha.core.DynamicTypeChecker (ObjC)</a></p></li>
<li><p><a class="reference internal" href="#alpha-core-fixedaddr-c" id="id162">alpha.core.FixedAddr (C)</a></p></li>
<li><p><a class="reference internal" href="#alpha-core-pointerarithm-c" id="id163">alpha.core.PointerArithm (C)</a></p></li>
<li><p><a class="reference internal" href="#alpha-core-stackaddressasyncescape-objc" id="id164">alpha.core.StackAddressAsyncEscape (ObjC)</a></p></li>
<li><p><a class="reference internal" href="#alpha-core-stdvariant-c" id="id165">alpha.core.StdVariant (C++)</a></p></li>
<li><p><a class="reference internal" href="#alpha-core-testafterdivzero-c" id="id166">alpha.core.TestAfterDivZero (C)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#alpha-cplusplus" id="id167">alpha.cplusplus</a></p>
<ul>
<li><p><a class="reference internal" href="#alpha-cplusplus-deletewithnonvirtualdtor-c" id="id168">alpha.cplusplus.DeleteWithNonVirtualDtor (C++)</a></p></li>
<li><p><a class="reference internal" href="#alpha-cplusplus-invalidatediterator-c" id="id169">alpha.cplusplus.InvalidatedIterator (C++)</a></p></li>
<li><p><a class="reference internal" href="#alpha-cplusplus-iteratorrange-c" id="id170">alpha.cplusplus.IteratorRange (C++)</a></p></li>
<li><p><a class="reference internal" href="#alpha-cplusplus-mismatchediterator-c" id="id171">alpha.cplusplus.MismatchedIterator (C++)</a></p></li>
<li><p><a class="reference internal" href="#alpha-cplusplus-smartptr-c" id="id172">alpha.cplusplus.SmartPtr (C++)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#alpha-deadcode" id="id173">alpha.deadcode</a></p>
<ul>
<li><p><a class="reference internal" href="#alpha-deadcode-unreachablecode-c-c" id="id174">alpha.deadcode.UnreachableCode (C, C++)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#alpha-fuchsia" id="id175">alpha.fuchsia</a></p>
<ul>
<li><p><a class="reference internal" href="#alpha-fuchsia-lock" id="id176">alpha.fuchsia.Lock</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#alpha-llvm" id="id177">alpha.llvm</a></p>
<ul>
<li><p><a class="reference internal" href="#alpha-llvm-conventions" id="id178">alpha.llvm.Conventions</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#alpha-osx" id="id179">alpha.osx</a></p>
<ul>
<li><p><a class="reference internal" href="#alpha-osx-cocoa-directivarassignment-objc" id="id180">alpha.osx.cocoa.DirectIvarAssignment (ObjC)</a></p></li>
<li><p><a class="reference internal" href="#alpha-osx-cocoa-directivarassignmentforannotatedfunctions-objc" id="id181">alpha.osx.cocoa.DirectIvarAssignmentForAnnotatedFunctions (ObjC)</a></p></li>
<li><p><a class="reference internal" href="#alpha-osx-cocoa-instancevariableinvalidation-objc" id="id182">alpha.osx.cocoa.InstanceVariableInvalidation (ObjC)</a></p></li>
<li><p><a class="reference internal" href="#alpha-osx-cocoa-missinginvalidationmethod-objc" id="id183">alpha.osx.cocoa.MissingInvalidationMethod (ObjC)</a></p></li>
<li><p><a class="reference internal" href="#alpha-osx-cocoa-localizability-pluralmisusechecker-objc" id="id184">alpha.osx.cocoa.localizability.PluralMisuseChecker (ObjC)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#alpha-security" id="id185">alpha.security</a></p>
<ul>
<li><p><a class="reference internal" href="#alpha-security-returnptrrange-c" id="id186">alpha.security.ReturnPtrRange (C)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#alpha-security-cert" id="id187">alpha.security.cert</a></p></li>
<li><p><a class="reference internal" href="#alpha-unix" id="id188">alpha.unix</a></p>
<ul>
<li><p><a class="reference internal" href="#alpha-unix-pthreadlock-c" id="id189">alpha.unix.PthreadLock (C)</a></p></li>
<li><p><a class="reference internal" href="#alpha-unix-simplestream-c" id="id190">alpha.unix.SimpleStream (C)</a></p></li>
<li><p><a class="reference internal" href="#alpha-unix-cstring-bufferoverlap-c" id="id191">alpha.unix.cstring.BufferOverlap (C)</a></p></li>
<li><p><a class="reference internal" href="#alpha-unix-cstring-outofbounds-c" id="id192">alpha.unix.cstring.OutOfBounds (C)</a></p></li>
<li><p><a class="reference internal" href="#alpha-unix-cstring-uninitializedread-c" id="id193">alpha.unix.cstring.UninitializedRead (C)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#alpha-webkit" id="id194">alpha.WebKit</a></p>
<ul>
<li><p><a class="reference internal" href="#alpha-webkit-forwarddeclchecker" id="id195">alpha.webkit.ForwardDeclChecker</a></p></li>
<li><p><a class="reference internal" href="#alpha-webkit-memoryunsafecastchecker" id="id196">alpha.webkit.MemoryUnsafeCastChecker</a></p></li>
<li><p><a class="reference internal" href="#id16" id="id197">alpha.webkit.NoUncheckedPtrMemberChecker</a></p></li>
<li><p><a class="reference internal" href="#alpha-webkit-nounretainedmemberchecker" id="id198">alpha.webkit.NoUnretainedMemberChecker</a></p></li>
<li><p><a class="reference internal" href="#alpha-webkit-unretainedlambdacaptureschecker" id="id199">alpha.webkit.UnretainedLambdaCapturesChecker</a></p></li>
<li><p><a class="reference internal" href="#alpha-webkit-uncountedcallargschecker" id="id200">alpha.webkit.UncountedCallArgsChecker</a></p></li>
<li><p><a class="reference internal" href="#alpha-webkit-uncheckedcallargschecker" id="id201">alpha.webkit.UncheckedCallArgsChecker</a></p></li>
<li><p><a class="reference internal" href="#alpha-webkit-unretainedcallargschecker" id="id202">alpha.webkit.UnretainedCallArgsChecker</a></p></li>
<li><p><a class="reference internal" href="#alpha-webkit-uncountedlocalvarschecker" id="id203">alpha.webkit.UncountedLocalVarsChecker</a></p></li>
<li><p><a class="reference internal" href="#alpha-webkit-uncheckedlocalvarschecker" id="id204">alpha.webkit.UncheckedLocalVarsChecker</a></p></li>
<li><p><a class="reference internal" href="#alpha-webkit-unretainedlocalvarschecker" id="id205">alpha.webkit.UnretainedLocalVarsChecker</a></p></li>
<li><p><a class="reference internal" href="#webkit-retainptrctoradoptchecker" id="id206">webkit.RetainPtrCtorAdoptChecker</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#debug-checkers" id="id207">Debug Checkers</a></p>
<ul>
<li><p><a class="reference internal" href="#debug" id="id208">debug</a></p>
<ul>
<li><p><a class="reference internal" href="#debug-analysisorder" id="id209">debug.AnalysisOrder</a></p></li>
<li><p><a class="reference internal" href="#debug-configdumper" id="id210">debug.ConfigDumper</a></p></li>
<li><p><a class="reference internal" href="#debug-dumpcfg-display" id="id211">debug.DumpCFG Display</a></p></li>
<li><p><a class="reference internal" href="#debug-dumpcallgraph" id="id212">debug.DumpCallGraph</a></p></li>
<li><p><a class="reference internal" href="#debug-dumpcalls" id="id213">debug.DumpCalls</a></p></li>
<li><p><a class="reference internal" href="#debug-dumpdominators" id="id214">debug.DumpDominators</a></p></li>
<li><p><a class="reference internal" href="#debug-dumplivevars" id="id215">debug.DumpLiveVars</a></p></li>
<li><p><a class="reference internal" href="#debug-dumptraversal" id="id216">debug.DumpTraversal</a></p></li>
<li><p><a class="reference internal" href="#debug-exprinspection" id="id217">debug.ExprInspection</a></p></li>
<li><p><a class="reference internal" href="#debug-stats" id="id218">debug.Stats</a></p></li>
<li><p><a class="reference internal" href="#debug-tainttest" id="id219">debug.TaintTest</a></p></li>
<li><p><a class="reference internal" href="#debug-viewcfg" id="id220">debug.ViewCFG</a></p></li>
<li><p><a class="reference internal" href="#debug-viewcallgraph" id="id221">debug.ViewCallGraph</a></p></li>
<li><p><a class="reference internal" href="#debug-viewexplodedgraph" id="id222">debug.ViewExplodedGraph</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
<section id="default-checkers">
<span id="id1"></span><h2><a class="toc-backref" href="#id35" role="doc-backlink"><span class="section-number">1.1. </span>Default Checkers</a><a class="headerlink" href="#default-checkers" title="Link to this heading">¶</a></h2>
<section id="core">
<span id="core-checkers"></span><h3><a class="toc-backref" href="#id36" role="doc-backlink"><span class="section-number">1.1.1. </span>core</a><a class="headerlink" href="#core" title="Link to this heading">¶</a></h3>
<p>Models core language features and contains general-purpose checkers such as division by zero,
null pointer dereference, usage of uninitialized values, etc.
<em>These checkers must be always switched on as other checker rely on them.</em></p>
<section id="core-bitwiseshift-c-c">
<span id="core-bitwiseshift"></span><h4><a class="toc-backref" href="#id37" role="doc-backlink"><span class="section-number">1.1.1.1. </span>core.BitwiseShift (C, C++)</a><a class="headerlink" href="#core-bitwiseshift-c-c" title="Link to this heading">¶</a></h4>
<p>Finds undefined behavior caused by the bitwise left- and right-shift operator
operating on integer types.</p>
<p>By default, this checker only reports situations when the right operand is
either negative or larger than the bit width of the type of the left operand;
these are logically unsound.</p>
<p>Moreover, if the pedantic mode is activated by
<code class="docutils literal notranslate"><span class="pre">-analyzer-config</span> <span class="pre">core.BitwiseShift:Pedantic=true</span></code>, then this checker also
reports situations where the _left_ operand of a shift operator is negative or
overflow occurs during the right shift of a signed value. (Most compilers
handle these predictably, but the C standard and the C++ standards before C++20
say that they’re undefined behavior. In the C++20 standard these constructs are
well-defined, so activating pedantic mode in C++20 has no effect.)</p>
<p><strong>Examples</strong></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">static_assert</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;assuming 32-bit int&quot;</span><span class="p">)</span>

<span class="kt">void</span><span class="w"> </span><span class="n">basic_examples</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">b</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn: right operand is negative in left shift</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">b</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn: right shift overflows the capacity of &#39;int&#39;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="n">pedantic_examples</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn: left operand is negative in right shift</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1000u</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">31</span><span class="p">;</span><span class="w"> </span><span class="c1">// OK, overflow of unsigned value is well-defined, a == 0</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">b</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">31</span><span class="p">;</span><span class="w"> </span><span class="c1">// this is undefined before C++20, but the checker doesn&#39;t</span>
<span class="w">                 </span><span class="c1">// warn because it doesn&#39;t know the exact value of b</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">31</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn: this overflows the capacity of &#39;int&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Solution</strong></p>
<p>Ensure the shift operands are in proper range before shifting.</p>
</section>
<section id="core-callandmessage-c-c-objc">
<span id="core-callandmessage"></span><h4><a class="toc-backref" href="#id38" role="doc-backlink"><span class="section-number">1.1.1.2. </span>core.CallAndMessage (C, C++, ObjC)</a><a class="headerlink" href="#core-callandmessage-c-c-objc" title="Link to this heading">¶</a></h4>
<blockquote>
<div><p>Check for logical errors for function calls and Objective-C message expressions (e.g., uninitialized arguments, null function pointers).</p>
</div></blockquote>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="c1">//C</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">foo</span><span class="p">)(</span><span class="kt">void</span><span class="p">);</span>
<span class="w">   </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">   </span><span class="n">foo</span><span class="p">();</span><span class="w"> </span><span class="c1">// warn: function pointer is null</span>
<span class="w"> </span><span class="p">}</span>

<span class="w"> </span><span class="c1">// C++</span>
<span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">{</span>
<span class="w"> </span><span class="n">public</span><span class="o">:</span>
<span class="w">   </span><span class="kt">void</span><span class="w"> </span><span class="n">f</span><span class="p">();</span>
<span class="w"> </span><span class="p">};</span>

<span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">C</span><span class="w"> </span><span class="o">*</span><span class="n">pc</span><span class="p">;</span>
<span class="w">   </span><span class="n">pc</span><span class="o">-&gt;</span><span class="n">f</span><span class="p">();</span><span class="w"> </span><span class="c1">// warn: object pointer is uninitialized</span>
<span class="w"> </span><span class="p">}</span>

<span class="w"> </span><span class="c1">// C++</span>
<span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">{</span>
<span class="w"> </span><span class="n">public</span><span class="o">:</span>
<span class="w">   </span><span class="kt">void</span><span class="w"> </span><span class="n">f</span><span class="p">();</span>
<span class="w"> </span><span class="p">};</span>

<span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">C</span><span class="w"> </span><span class="o">*</span><span class="n">pc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">   </span><span class="n">pc</span><span class="o">-&gt;</span><span class="n">f</span><span class="p">();</span><span class="w"> </span><span class="c1">// warn: object pointer is null</span>
<span class="w"> </span><span class="p">}</span>

<span class="w"> </span><span class="c1">// Objective-C</span>
<span class="w"> </span><span class="k">@interface</span> <span class="bp">MyClass</span> : <span class="bp">NSObject</span>
<span class="w"> </span><span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">readwrite</span><span class="p">,</span><span class="k">assign</span><span class="p">)</span><span class="w"> </span><span class="kt">id</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">double</span><span class="p">)</span><span class="n">longDoubleM</span><span class="p">;</span>
<span class="w"> </span><span class="k">@end</span>

<span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="bp">MyClass</span><span class="w"> </span><span class="o">*</span><span class="n">obj1</span><span class="p">;</span>
<span class="w">   </span><span class="kt">long</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">ld1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">obj1</span><span class="w"> </span><span class="n">longDoubleM</span><span class="p">];</span>
<span class="w">     </span><span class="c1">// warn: receiver is uninitialized</span>
<span class="w"> </span><span class="p">}</span>

<span class="w"> </span><span class="c1">// Objective-C</span>
<span class="w"> </span><span class="k">@interface</span> <span class="bp">MyClass</span> : <span class="bp">NSObject</span>
<span class="w"> </span><span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">readwrite</span><span class="p">,</span><span class="k">assign</span><span class="p">)</span><span class="w"> </span><span class="kt">id</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">double</span><span class="p">)</span><span class="n">longDoubleM</span><span class="p">;</span>
<span class="w"> </span><span class="k">@end</span>

<span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="bp">MyClass</span><span class="w"> </span><span class="o">*</span><span class="n">obj1</span><span class="p">;</span>
<span class="w">   </span><span class="kt">id</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj1</span><span class="p">.</span><span class="n">x</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn: uninitialized object pointer</span>
<span class="w"> </span><span class="p">}</span>

<span class="w"> </span><span class="c1">// Objective-C</span>
<span class="w"> </span><span class="k">@interface</span> <span class="nc">Subscriptable</span> : <span class="bp">NSObject</span>
<span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="n">objectAtIndexedSubscript</span><span class="o">:</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="n">index</span><span class="p">;</span>
<span class="w"> </span><span class="k">@end</span>

<span class="w"> </span><span class="k">@interface</span> <span class="bp">MyClass</span> : <span class="nc">Subscriptable</span>
<span class="w"> </span><span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">readwrite</span><span class="p">,</span><span class="k">assign</span><span class="p">)</span><span class="w"> </span><span class="kt">id</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">double</span><span class="p">)</span><span class="n">longDoubleM</span><span class="p">;</span>
<span class="w"> </span><span class="k">@end</span>

<span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="bp">MyClass</span><span class="w"> </span><span class="o">*</span><span class="n">obj1</span><span class="p">;</span>
<span class="w">   </span><span class="kt">id</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj1</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="w"> </span><span class="c1">// warn: uninitialized object pointer</span>
<span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</section>
<section id="core-dividezero-c-c-objc">
<span id="core-dividezero"></span><h4><a class="toc-backref" href="#id39" role="doc-backlink"><span class="section-number">1.1.1.3. </span>core.DivideZero (C, C++, ObjC)</a><a class="headerlink" href="#core-dividezero-c-c-objc" title="Link to this heading">¶</a></h4>
<blockquote>
<div><p>Check for division by zero.</p>
</div></blockquote>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">z</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">z</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="core-fixedaddressdereference-c-c-objc">
<span id="core-fixedaddressdereference"></span><h4><a class="toc-backref" href="#id40" role="doc-backlink"><span class="section-number">1.1.1.4. </span>core.FixedAddressDereference (C, C++, ObjC)</a><a class="headerlink" href="#core-fixedaddressdereference-c-c-objc" title="Link to this heading">¶</a></h4>
<p>Check for dereferences of fixed addresses.</p>
<p>A pointer contains a fixed address if it was set to a hard-coded value or it
becomes otherwise obvious that at that point it can have only a single fixed
numerical value.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test1</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x020</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test2</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mi">-1</span><span class="p">)</span>
<span class="w">    </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test3</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">p_function</span><span class="p">)(</span><span class="kt">char</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="p">);</span>
<span class="w">  </span><span class="n">p_function</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">)(</span><span class="kt">char</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="p">))</span><span class="mh">0x04080</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">p_function</span><span class="p">)(</span><span class="sc">&#39;x&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;y&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// NO warning yet at functon pointer calls</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If the analyzer option <code class="docutils literal notranslate"><span class="pre">suppress-dereferences-from-any-address-space</span></code> is set
to true (the default value), then this checker never reports dereference of
pointers with a specified address space. If the option is set to false, then
reports from the specific x86 address spaces 256, 257 and 258 are still
suppressed, but fixed address dereferences from other address spaces are
reported.</p>
</section>
<section id="core-nonnullparamchecker-c-c-objc">
<span id="core-nonnullparamchecker"></span><h4><a class="toc-backref" href="#id41" role="doc-backlink"><span class="section-number">1.1.1.5. </span>core.NonNullParamChecker (C, C++, ObjC)</a><a class="headerlink" href="#core-nonnullparamchecker-c-c-objc" title="Link to this heading">¶</a></h4>
<p>Check for null pointers passed as arguments to a function whose arguments are references or marked with the ‘nonnull’ attribute.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="n">__attribute__</span><span class="p">((</span><span class="n">nonnull</span><span class="p">));</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">p</span><span class="p">)</span>
<span class="w">    </span><span class="n">f</span><span class="p">(</span><span class="n">p</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="core-nulldereference-c-c-objc">
<span id="core-nulldereference"></span><h4><a class="toc-backref" href="#id42" role="doc-backlink"><span class="section-number">1.1.1.6. </span>core.NullDereference (C, C++, ObjC)</a><a class="headerlink" href="#core-nulldereference-c-c-objc" title="Link to this heading">¶</a></h4>
<p>Check for dereferences of null pointers.</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="c1">// C</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span>

<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>

<span class="c1">// C</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">p</span><span class="p">)</span>
<span class="w">    </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>

<span class="c1">// C++</span>
<span class="k">class</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">{</span>
<span class="n">public</span><span class="o">:</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="p">};</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">C</span><span class="w"> </span><span class="o">*</span><span class="n">pc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pc</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>

<span class="c1">// Objective-C</span>
<span class="k">@interface</span> <span class="bp">MyClass</span> <span class="p">{</span>
<span class="k">@public</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">@end</span>

<span class="kt">void</span><span class="w"> </span><span class="n">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="bp">MyClass</span><span class="w"> </span><span class="o">*</span><span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">obj</span><span class="o">-&gt;</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Null pointer dereferences of pointers with address spaces are not always defined
as error. Specifically on x86/x86-64 target if the pointer address space is
256 (x86 GS Segment), 257 (x86 FS Segment), or 258 (x86 SS Segment), a null
dereference is not defined as error. See <a class="reference external" href="https://clang.llvm.org/docs/LanguageExtensions.html#memory-references-to-specified-segments">X86/X86-64 Language Extensions</a>
for reference.</p>
<p>If the analyzer option <code class="docutils literal notranslate"><span class="pre">suppress-dereferences-from-any-address-space</span></code> is set
to true (the default value), then this checker never reports dereference of
pointers with a specified address space. If the option is set to false, then
reports from the specific x86 address spaces 256, 257 and 258 are still
suppressed, but null dereferences from other address spaces are reported.</p>
</section>
<section id="core-stackaddressescape-c">
<span id="core-stackaddressescape"></span><h4><a class="toc-backref" href="#id43" role="doc-backlink"><span class="section-number">1.1.1.7. </span>core.StackAddressEscape (C)</a><a class="headerlink" href="#core-stackaddressescape-c" title="Link to this heading">¶</a></h4>
<p>Check that addresses to stack memory do not escape the function.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">char</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">str</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;string&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">str</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>

<span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">__builtin_alloca</span><span class="p">(</span><span class="mi">12</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="p">;</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">y</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="core-undefinedbinaryoperatorresult-c">
<span id="core-undefinedbinaryoperatorresult"></span><h4><a class="toc-backref" href="#id44" role="doc-backlink"><span class="section-number">1.1.1.8. </span>core.UndefinedBinaryOperatorResult (C)</a><a class="headerlink" href="#core-undefinedbinaryoperatorresult-c" title="Link to this heading">¶</a></h4>
<p>Check for undefined results of binary operators.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn: left operand is garbage</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="core-vlasize-c">
<span id="core-vlasize"></span><h4><a class="toc-backref" href="#id45" role="doc-backlink"><span class="section-number">1.1.1.9. </span>core.VLASize (C)</a><a class="headerlink" href="#core-vlasize-c" title="Link to this heading">¶</a></h4>
<p>Check for declarations of Variable Length Arrays (VLA) of undefined, zero or negative
size.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">vla1</span><span class="p">[</span><span class="n">x</span><span class="p">];</span><span class="w"> </span><span class="c1">// warn: garbage as size</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">vla2</span><span class="p">[</span><span class="n">x</span><span class="p">];</span><span class="w"> </span><span class="c1">// warn: zero size</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The checker also gives warning if the <cite>TaintPropagation</cite> checker is switched on
and an unbound, attacker controlled (tainted) value is used to define
the size of the VLA.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">taintedVLA</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="w">  </span><span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">x</span><span class="p">);</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">vla</span><span class="p">[</span><span class="n">x</span><span class="p">];</span><span class="w"> </span><span class="c1">// Declared variable-length array (VLA) has tainted (attacker controlled) size, that can be 0 or negative</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">taintedVerfieidVLA</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="w">  </span><span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">x</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">vla</span><span class="p">[</span><span class="n">x</span><span class="p">];</span><span class="w"> </span><span class="c1">// no-warning. The analyzer can prove that x must be positive.</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="core-uninitialized-arraysubscript-c">
<span id="core-uninitialized-arraysubscript"></span><h4><a class="toc-backref" href="#id46" role="doc-backlink"><span class="section-number">1.1.1.10. </span>core.uninitialized.ArraySubscript (C)</a><a class="headerlink" href="#core-uninitialized-arraysubscript-c" title="Link to this heading">¶</a></h4>
<p>Check for uninitialized values used as array subscripts.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"> </span><span class="c1">// warn: array subscript is undefined</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="core-uninitialized-assign-c">
<span id="core-uninitialized-assign"></span><h4><a class="toc-backref" href="#id47" role="doc-backlink"><span class="section-number">1.1.1.11. </span>core.uninitialized.Assign (C)</a><a class="headerlink" href="#core-uninitialized-assign-c" title="Link to this heading">¶</a></h4>
<p>Check for assigning uninitialized values.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn: left expression is uninitialized</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="core-uninitialized-branch-c">
<span id="core-uninitialized-branch"></span><h4><a class="toc-backref" href="#id48" role="doc-backlink"><span class="section-number">1.1.1.12. </span>core.uninitialized.Branch (C)</a><a class="headerlink" href="#core-uninitialized-branch-c" title="Link to this heading">¶</a></h4>
<p>Check for uninitialized values used as branch conditions.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="c1">// warn</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="core-uninitialized-capturedblockvariable-c">
<span id="core-uninitialized-capturedblockvariable"></span><h4><a class="toc-backref" href="#id49" role="doc-backlink"><span class="section-number">1.1.1.13. </span>core.uninitialized.CapturedBlockVariable (C)</a><a class="headerlink" href="#core-uninitialized-capturedblockvariable-c" title="Link to this heading">¶</a></h4>
<p>Check for blocks that capture uninitialized values.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="w">  </span><span class="o">^</span><span class="p">{</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">;</span><span class="w"> </span><span class="p">}();</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="core-uninitialized-undefreturn-c">
<span id="core-uninitialized-undefreturn"></span><h4><a class="toc-backref" href="#id50" role="doc-backlink"><span class="section-number">1.1.1.14. </span>core.uninitialized.UndefReturn (C)</a><a class="headerlink" href="#core-uninitialized-undefreturn-c" title="Link to this heading">¶</a></h4>
<p>Check for uninitialized values being returned to the caller.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="core-uninitialized-newarraysize-c">
<span id="core-uninitialized-newarraysize"></span><h4><a class="toc-backref" href="#id51" role="doc-backlink"><span class="section-number">1.1.1.15. </span>core.uninitialized.NewArraySize (C++)</a><a class="headerlink" href="#core-uninitialized-newarraysize-c" title="Link to this heading">¶</a></h4>
<p>Check if the element count in new[] is garbage or undefined.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">int</span><span class="p">[</span><span class="n">n</span><span class="p">];</span><span class="w"> </span><span class="c1">// warn: Element count in new[] is a garbage value</span>
<span class="w">  </span><span class="k">delete</span><span class="p">[]</span><span class="w"> </span><span class="n">arr</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="cplusplus">
<span id="cplusplus-checkers"></span><h3><a class="toc-backref" href="#id52" role="doc-backlink"><span class="section-number">1.1.2. </span>cplusplus</a><a class="headerlink" href="#cplusplus" title="Link to this heading">¶</a></h3>
<p>C++ Checkers.</p>
<section id="cplusplus-arraydelete-c">
<span id="cplusplus-arraydelete"></span><h4><a class="toc-backref" href="#id53" role="doc-backlink"><span class="section-number">1.1.2.1. </span>cplusplus.ArrayDelete (C++)</a><a class="headerlink" href="#cplusplus-arraydelete-c" title="Link to this heading">¶</a></h4>
<p>Reports destructions of arrays of polymorphic objects that are destructed as
their base class. If the dynamic type of the array is different from its static
type, calling <cite>delete[]</cite> is undefined.</p>
<p>This checker corresponds to the SEI CERT rule <a class="reference external" href="https://wiki.sei.cmu.edu/confluence/display/cplusplus/EXP51-CPP.+Do+not+delete+an+array+through+a+pointer+of+the+incorrect+type">EXP51-CPP: Do not delete an array through a pointer of the incorrect type</a>.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Base</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">  </span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">Base</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span>
<span class="p">};</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Derived</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Base</span><span class="w"> </span><span class="p">{};</span>

<span class="n">Base</span><span class="w"> </span><span class="o">*</span><span class="nf">create</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">Base</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Derived</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span><span class="w"> </span><span class="c1">// note: Casting from &#39;Derived&#39; to &#39;Base&#39; here</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">foo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">Base</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create</span><span class="p">();</span>
<span class="w">  </span><span class="k">delete</span><span class="p">[]</span><span class="w"> </span><span class="n">x</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn: Deleting an array of &#39;Derived&#39; objects as their base class &#39;Base&#39; is undefined</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Limitations</strong></p>
<p>The checker does not emit note tags when casting to and from reference types,
even though the pointer values are tracked across references.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">foo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">Derived</span><span class="w"> </span><span class="o">*</span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Derived</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
<span class="w">  </span><span class="n">Derived</span><span class="w"> </span><span class="o">&amp;</span><span class="n">dref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="n">d</span><span class="p">;</span>

<span class="w">  </span><span class="n">Base</span><span class="w"> </span><span class="o">&amp;</span><span class="n">bref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">Base</span><span class="o">&amp;&gt;</span><span class="p">(</span><span class="n">dref</span><span class="p">);</span><span class="w"> </span><span class="c1">// no note</span>
<span class="w">  </span><span class="n">Base</span><span class="w"> </span><span class="o">*</span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">bref</span><span class="p">;</span>
<span class="w">  </span><span class="k">delete</span><span class="p">[]</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn: Deleting an array of &#39;Derived&#39; objects as their base class &#39;Base&#39; is undefined</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="cplusplus-innerpointer-c">
<span id="cplusplus-innerpointer"></span><h4><a class="toc-backref" href="#id54" role="doc-backlink"><span class="section-number">1.1.2.2. </span>cplusplus.InnerPointer (C++)</a><a class="headerlink" href="#cplusplus-innerpointer-c" title="Link to this heading">¶</a></h4>
<p>Check for inner pointers of C++ containers used after re/deallocation.</p>
<p>Many container methods in the C++ standard library are known to invalidate
“references” (including actual references, iterators and raw pointers) to
elements of the container. Using such references after they are invalidated
causes undefined behavior, which is a common source of memory errors in C++ that
this checker is capable of finding.</p>
<p>The checker is currently limited to <code class="docutils literal notranslate"><span class="pre">std::string</span></code> objects and doesn’t
recognize some of the more sophisticated approaches to passing unowned pointers
around, such as <code class="docutils literal notranslate"><span class="pre">std::string_view</span></code>.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">deref_after_assignment</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;llvm&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">data</span><span class="p">();</span><span class="w"> </span><span class="c1">// note: pointer to inner buffer of &#39;std::string&#39; obtained here</span>
<span class="w">  </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;clang&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// note: inner buffer of &#39;std::string&#39; reallocated by call to &#39;operator=&#39;</span>
<span class="w">  </span><span class="n">consume</span><span class="p">(</span><span class="n">c</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn: inner pointer of container used after re/deallocation</span>
<span class="p">}</span>

<span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="nf">return_temp</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">x</span><span class="p">).</span><span class="n">c_str</span><span class="p">();</span><span class="w"> </span><span class="c1">// warn: inner pointer of container used after re/deallocation</span>
<span class="w">  </span><span class="c1">// note: pointer to inner buffer of &#39;std::string&#39; obtained here</span>
<span class="w">  </span><span class="c1">// note: inner buffer of &#39;std::string&#39; deallocated by call to destructor</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="cplusplus-move-c">
<span id="cplusplus-move"></span><h4><a class="toc-backref" href="#id55" role="doc-backlink"><span class="section-number">1.1.2.3. </span>cplusplus.Move (C++)</a><a class="headerlink" href="#cplusplus-move-c" title="Link to this heading">¶</a></h4>
<p>Find use-after-move bugs in C++. This includes method calls on moved-from
objects, assignment of a moved-from object, and repeated move of a moved-from
object.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">A</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">foo</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span>
<span class="p">};</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">f1</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">A</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="w">  </span><span class="n">A</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">a</span><span class="p">);</span><span class="w"> </span><span class="c1">// note: &#39;a&#39; became &#39;moved-from&#39; here</span>
<span class="w">  </span><span class="n">a</span><span class="p">.</span><span class="n">foo</span><span class="p">();</span><span class="w">            </span><span class="c1">// warn: method call on a &#39;moved-from&#39; object &#39;a&#39;</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">f2</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">A</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="w">  </span><span class="n">A</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
<span class="w">  </span><span class="n">A</span><span class="w"> </span><span class="n">c</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">a</span><span class="p">));</span><span class="w"> </span><span class="c1">// warn: move of an already moved-from object</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">f3</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">A</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="w">  </span><span class="n">A</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
<span class="w">  </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn: copy of moved-from object</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The checker option <code class="docutils literal notranslate"><span class="pre">WarnOn</span></code> controls on what objects the use-after-move is
checked:</p>
<ul class="simple">
<li><p>The most strict value is <code class="docutils literal notranslate"><span class="pre">KnownsOnly</span></code>, in this mode only objects are
checked whose type is known to be move-unsafe. These include most STL objects
(but excluding move-safe ones) and smart pointers.</p></li>
<li><p>With option value <code class="docutils literal notranslate"><span class="pre">KnownsAndLocals</span></code> local variables (of any type) are
additionally checked. The idea behind this is that local variables are
usually not tempting to be re-used so an use after move is more likely a bug
than with member variables.</p></li>
<li><p>With option value <code class="docutils literal notranslate"><span class="pre">All</span></code> any use-after move condition is checked on all
kinds of variables, excluding global variables and known move-safe cases.</p></li>
</ul>
<p>Default value is <code class="docutils literal notranslate"><span class="pre">KnownsAndLocals</span></code>.</p>
<p>Calls of methods named <code class="docutils literal notranslate"><span class="pre">empty()</span></code> or <code class="docutils literal notranslate"><span class="pre">isEmpty()</span></code> are allowed on moved-from
objects because these methods are considered as move-safe. Functions called
<code class="docutils literal notranslate"><span class="pre">reset()</span></code>, <code class="docutils literal notranslate"><span class="pre">destroy()</span></code>, <code class="docutils literal notranslate"><span class="pre">clear()</span></code>, <code class="docutils literal notranslate"><span class="pre">assign</span></code>, <code class="docutils literal notranslate"><span class="pre">resize</span></code>,  <code class="docutils literal notranslate"><span class="pre">shrink</span></code> are
treated as state-reset functions and are allowed on moved-from objects, these
make the object valid again. This applies to any type of object (not only STL
ones).</p>
</section>
<section id="cplusplus-newdelete-c">
<span id="cplusplus-newdelete"></span><h4><a class="toc-backref" href="#id56" role="doc-backlink"><span class="section-number">1.1.2.4. </span>cplusplus.NewDelete (C++)</a><a class="headerlink" href="#cplusplus-newdelete-c" title="Link to this heading">¶</a></h4>
<p>Check for double-free and use-after-free problems. Traces memory managed by new/delete.</p>
<p>Custom allocation/deallocation functions can be defined using
<a class="reference internal" href="../AttributeReference.html#analyzer-ownership-attrs"><span class="std std-ref">ownership attributes</span></a>.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">);</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">testUseMiddleArgAfterDelete</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">delete</span><span class="w"> </span><span class="n">p</span><span class="p">;</span>
<span class="w">  </span><span class="n">f</span><span class="p">(</span><span class="n">p</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn: use after free</span>
<span class="p">}</span>

<span class="k">class</span><span class="w"> </span><span class="nc">SomeClass</span><span class="w"> </span><span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">f</span><span class="p">();</span>
<span class="p">};</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">SomeClass</span><span class="w"> </span><span class="o">*</span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SomeClass</span><span class="p">;</span>
<span class="w">  </span><span class="k">delete</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="w">  </span><span class="n">c</span><span class="o">-&gt;</span><span class="n">f</span><span class="p">();</span><span class="w"> </span><span class="c1">// warn: use after free</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">__builtin_alloca</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
<span class="w">  </span><span class="k">delete</span><span class="w"> </span><span class="n">p</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn: deleting memory allocated by alloca</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">int</span><span class="p">;</span>
<span class="w">  </span><span class="k">delete</span><span class="w"> </span><span class="n">p</span><span class="p">;</span>
<span class="w">  </span><span class="k">delete</span><span class="w"> </span><span class="n">p</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn: attempt to free released</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">  </span><span class="k">delete</span><span class="w"> </span><span class="o">&amp;</span><span class="n">i</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn: delete address of local</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">int</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
<span class="w">  </span><span class="k">delete</span><span class="p">[]</span><span class="w"> </span><span class="p">(</span><span class="o">++</span><span class="n">p</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// warn: argument to &#39;delete[]&#39; is offset by 4 bytes</span>
<span class="w">    </span><span class="c1">// from the start of memory allocated by &#39;new[]&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="cplusplus-newdeleteleaks-c">
<span id="cplusplus-newdeleteleaks"></span><h4><a class="toc-backref" href="#id57" role="doc-backlink"><span class="section-number">1.1.2.5. </span>cplusplus.NewDeleteLeaks (C++)</a><a class="headerlink" href="#cplusplus-newdeleteleaks-c" title="Link to this heading">¶</a></h4>
<p>Check for memory leaks. Traces memory managed by new/delete.</p>
<p>Custom allocation/deallocation functions can be defined using
<a class="reference internal" href="../AttributeReference.html#analyzer-ownership-attrs"><span class="std std-ref">ownership attributes</span></a>.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">int</span><span class="p">;</span>
<span class="p">}</span><span class="w"> </span><span class="c1">// warn</span>
</pre></div>
</div>
</section>
<section id="cplusplus-placementnew-c">
<span id="cplusplus-placementnew"></span><h4><a class="toc-backref" href="#id58" role="doc-backlink"><span class="section-number">1.1.2.6. </span>cplusplus.PlacementNew (C++)</a><a class="headerlink" href="#cplusplus-placementnew-c" title="Link to this heading">¶</a></h4>
<p>Check if default placement new is provided with pointers to sufficient storage capacity.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;new&gt;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">f</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">short</span><span class="w"> </span><span class="n">s</span><span class="p">;</span>
<span class="w">  </span><span class="kt">long</span><span class="w"> </span><span class="o">*</span><span class="n">lp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">::</span><span class="k">new</span><span class="w"> </span><span class="p">(</span><span class="o">&amp;</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="kt">long</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="cplusplus-selfassignment-c">
<span id="cplusplus-selfassignment"></span><h4><a class="toc-backref" href="#id59" role="doc-backlink"><span class="section-number">1.1.2.7. </span>cplusplus.SelfAssignment (C++)</a><a class="headerlink" href="#cplusplus-selfassignment-c" title="Link to this heading">¶</a></h4>
<p>Checks C++ copy and move assignment operators for self assignment.</p>
</section>
<section id="cplusplus-stringchecker-c">
<span id="cplusplus-stringchecker"></span><h4><a class="toc-backref" href="#id60" role="doc-backlink"><span class="section-number">1.1.2.8. </span>cplusplus.StringChecker (C++)</a><a class="headerlink" href="#cplusplus-stringchecker-c" title="Link to this heading">¶</a></h4>
<p>Checks std::string operations.</p>
<p>Checks if the cstring pointer from which the <code class="docutils literal notranslate"><span class="pre">std::string</span></code> object is
constructed is <code class="docutils literal notranslate"><span class="pre">NULL</span></code> or not.
If the checker cannot reason about the nullness of the pointer it will assume
that it was non-null to satisfy the precondition of the constructor.</p>
<p>This checker is capable of checking the <a class="reference external" href="https://wiki.sei.cmu.edu/confluence/x/E3s-BQ">SEI CERT C++ coding rule STR51-CPP.
Do not attempt to create a std::string from a null pointer</a>.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">msg</span><span class="p">(</span><span class="n">p</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn: The parameter must not be null</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="cplusplus-purevirtualcall-c">
<span id="cplusplus-purevirtualcall"></span><h4><a class="toc-backref" href="#id61" role="doc-backlink"><span class="section-number">1.1.2.9. </span>cplusplus.PureVirtualCall (C++)</a><a class="headerlink" href="#cplusplus-purevirtualcall-c" title="Link to this heading">¶</a></h4>
<p>When <a class="reference external" href="https://en.cppreference.com/w/cpp/language/virtual#During_construction_and_destruction">virtual methods are called during construction and destruction</a>
the polymorphism is restricted to the class that’s being constructed or
destructed because the more derived contexts are either not yet initialized or
already destructed.</p>
<p>This checker reports situations where this restricted polymorphism causes a
call to a pure virtual method, which is undefined behavior. (See also the
related checker <a class="reference internal" href="#optin-cplusplus-virtualcall"><span class="std std-ref">optin.cplusplus.VirtualCall (C++)</span></a> which reports situations
where the restricted polymorphism affects a call and the called method is not
pure virtual – but may be still surprising for the programmer.)</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">A</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">virtual</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">getKind</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">  </span><span class="n">A</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// warn: This calls the pure virtual method A::getKind().</span>
<span class="w">    </span><span class="n">log</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Constructing &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">getKind</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">A</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">releaseResources</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">releaseResources</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// warn: This can call the pure virtual method A::getKind() when this is</span>
<span class="w">    </span><span class="c1">// called from the destructor.</span>
<span class="w">    </span><span class="n">callSomeFunction</span><span class="p">(</span><span class="n">getKind</span><span class="p">());</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
</section>
</section>
<section id="deadcode">
<span id="deadcode-checkers"></span><h3><a class="toc-backref" href="#id62" role="doc-backlink"><span class="section-number">1.1.3. </span>deadcode</a><a class="headerlink" href="#deadcode" title="Link to this heading">¶</a></h3>
<p>Dead Code Checkers.</p>
<section id="deadcode-deadstores-c">
<span id="deadcode-deadstores"></span><h4><a class="toc-backref" href="#id63" role="doc-backlink"><span class="section-number">1.1.3.1. </span>deadcode.DeadStores (C)</a><a class="headerlink" href="#deadcode-deadstores-c" title="Link to this heading">¶</a></h4>
<p>Check for values stored to variables that are never read afterwards.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">WarnForDeadNestedAssignments</span></code> option enables the checker to emit
warnings for nested dead assignments. You can disable with the
<code class="docutils literal notranslate"><span class="pre">-analyzer-config</span> <span class="pre">deadcode.DeadStores:WarnForDeadNestedAssignments=false</span></code>.
<em>Defaults to true</em>.</p>
<p>Would warn for this e.g.:
if ((y = make_int())) {
}</p>
</section>
</section>
<section id="nullability">
<span id="nullability-checkers"></span><h3><a class="toc-backref" href="#id64" role="doc-backlink"><span class="section-number">1.1.4. </span>nullability</a><a class="headerlink" href="#nullability" title="Link to this heading">¶</a></h3>
<p>Checkers (mostly Objective C) that warn for null pointer passing and dereferencing errors.</p>
<section id="nullability-nullpassedtononnull-objc">
<span id="nullability-nullpassedtononnull"></span><h4><a class="toc-backref" href="#id65" role="doc-backlink"><span class="section-number">1.1.4.1. </span>nullability.NullPassedToNonnull (ObjC)</a><a class="headerlink" href="#nullability-nullpassedtononnull-objc" title="Link to this heading">¶</a></h4>
<p>Warns when a null pointer is passed to a pointer which has a _Nonnull type.</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">nil</span><span class="p">)</span>
<span class="w">  </span><span class="k">return</span><span class="p">;</span>
<span class="c1">// Warning: nil passed to a callee that requires a non-null 1st parameter</span>
<span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">greeting</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s">@&quot;Hello &quot;</span><span class="w"> </span><span class="n">stringByAppendingString</span><span class="o">:</span><span class="n">name</span><span class="p">];</span>
</pre></div>
</div>
</section>
<section id="nullability-nullreturnedfromnonnull-c-c-objc">
<span id="nullability-nullreturnedfromnonnull"></span><h4><a class="toc-backref" href="#id66" role="doc-backlink"><span class="section-number">1.1.4.2. </span>nullability.NullReturnedFromNonnull (C, C++, ObjC)</a><a class="headerlink" href="#nullability-nullreturnedfromnonnull-c-c-objc" title="Link to this heading">¶</a></h4>
<p>Warns when a null pointer is returned from a function that has _Nonnull return type.</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="p">-</span> <span class="p">(</span><span class="n">nonnull</span><span class="w"> </span><span class="kt">id</span><span class="p">)</span><span class="nf">firstChild</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">id</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nil</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">([</span><span class="n">_children</span><span class="w"> </span><span class="n">count</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_children</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

<span class="w">  </span><span class="c1">// Warning: nil returned from a method that is expected</span>
<span class="w">  </span><span class="c1">// to return a non-null value</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Warns when a null pointer is returned from a function annotated with <code class="docutils literal notranslate"><span class="pre">__attribute__((returns_nonnull))</span></code></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">global</span><span class="p">;</span>
<span class="n">__attribute__</span><span class="p">((</span><span class="n">returns_nonnull</span><span class="p">))</span><span class="w"> </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">getPtr</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>

<span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="nf">getPtr</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// forgot to negate the condition</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">&amp;</span><span class="n">global</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="c1">// Warning: nullptr returned from a function that is expected</span>
<span class="w">  </span><span class="c1">// to return a non-null value</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">p</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="nullability-nullabledereferenced-objc">
<span id="nullability-nullabledereferenced"></span><h4><a class="toc-backref" href="#id67" role="doc-backlink"><span class="section-number">1.1.4.3. </span>nullability.NullableDereferenced (ObjC)</a><a class="headerlink" href="#nullability-nullabledereferenced-objc" title="Link to this heading">¶</a></h4>
<p>Warns when a nullable pointer is dereferenced.</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">LinkedList</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">data</span><span class="p">;</span>
<span class="w">  </span><span class="k">struct</span><span class="w"> </span><span class="nc">LinkedList</span><span class="w"> </span><span class="o">*</span><span class="n">next</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span><span class="w"> </span><span class="nc">LinkedList</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">_Nullable</span><span class="w"> </span><span class="n">getNext</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">LinkedList</span><span class="w"> </span><span class="o">*</span><span class="n">l</span><span class="p">);</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">updateNextData</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">LinkedList</span><span class="w"> </span><span class="o">*</span><span class="n">list</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">newData</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">struct</span><span class="w"> </span><span class="nc">LinkedList</span><span class="w"> </span><span class="o">*</span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getNext</span><span class="p">(</span><span class="n">list</span><span class="p">);</span>
<span class="w">  </span><span class="c1">// Warning: Nullable pointer is dereferenced</span>
<span class="w">  </span><span class="n">next</span><span class="o">-&gt;</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="nullability-nullablepassedtononnull-objc">
<span id="nullability-nullablepassedtononnull"></span><h4><a class="toc-backref" href="#id68" role="doc-backlink"><span class="section-number">1.1.4.4. </span>nullability.NullablePassedToNonnull (ObjC)</a><a class="headerlink" href="#nullability-nullablepassedtononnull-objc" title="Link to this heading">¶</a></h4>
<p>Warns when a nullable pointer is passed to a pointer which has a _Nonnull type.</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">Dummy</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">val</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="n">Dummy</span><span class="p">;</span>
<span class="n">Dummy</span><span class="w"> </span><span class="o">*</span><span class="n">_Nullable</span><span class="w"> </span><span class="n">returnsNullable</span><span class="p">();</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">takesNonnull</span><span class="p">(</span><span class="n">Dummy</span><span class="w"> </span><span class="o">*</span><span class="n">_Nonnull</span><span class="p">);</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">Dummy</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">returnsNullable</span><span class="p">();</span>
<span class="w">  </span><span class="n">takesNonnull</span><span class="p">(</span><span class="n">p</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="nullability-nullablereturnedfromnonnull-objc">
<span id="nullability-nullablereturnedfromnonnull"></span><h4><a class="toc-backref" href="#id69" role="doc-backlink"><span class="section-number">1.1.4.5. </span>nullability.NullableReturnedFromNonnull (ObjC)</a><a class="headerlink" href="#nullability-nullablereturnedfromnonnull-objc" title="Link to this heading">¶</a></h4>
<p>Warns when a nullable pointer is returned from a function that has _Nonnull return type.</p>
</section>
</section>
<section id="optin">
<span id="optin-checkers"></span><h3><a class="toc-backref" href="#id70" role="doc-backlink"><span class="section-number">1.1.5. </span>optin</a><a class="headerlink" href="#optin" title="Link to this heading">¶</a></h3>
<p>Checkers for portability, performance, optional security and coding style specific rules.</p>
<section id="optin-core-enumcastoutofrange-c-c">
<span id="optin-core-enumcastoutofrange"></span><h4><a class="toc-backref" href="#id71" role="doc-backlink"><span class="section-number">1.1.5.1. </span>optin.core.EnumCastOutOfRange (C, C++)</a><a class="headerlink" href="#optin-core-enumcastoutofrange-c-c" title="Link to this heading">¶</a></h4>
<p>Check for integer to enumeration casts that would produce a value with no
corresponding enumerator. This is not necessarily undefined behavior, but can
lead to nasty surprises, so projects may decide to use a coding standard that
disallows these “unusual” conversions.</p>
<p>Note that no warnings are produced when the enum type (e.g. <cite>std::byte</cite>) has no
enumerators at all.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">enum</span><span class="w"> </span><span class="nc">WidgetKind</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">A</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="o">=</span><span class="mi">99</span><span class="w"> </span><span class="p">};</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">foo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">WidgetKind</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">WidgetKind</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span><span class="w">  </span><span class="c1">// OK</span>
<span class="w">  </span><span class="n">WidgetKind</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">WidgetKind</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">99</span><span class="p">);</span><span class="w"> </span><span class="c1">// OK</span>
<span class="w">  </span><span class="n">WidgetKind</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">WidgetKind</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span><span class="w">  </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Limitations</strong></p>
<p>This checker does not accept the coding pattern where an enum type is used to
store combinations of flag values.
Such enums should be annotated with the <cite>__attribute__((flag_enum))</cite> or by the
<cite>[[clang::flag_enum]]</cite> attribute to signal this intent. Refer to the
<a class="reference external" href="https://clang.llvm.org/docs/AttributeReference.html#flag-enum">documentation</a>
of this Clang attribute.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">enum</span><span class="w"> </span><span class="nc">AnimalFlags</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">HasClaws</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="n">CanFly</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">    </span><span class="n">EatsFish</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span>
<span class="w">    </span><span class="n">Endangered</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span>
<span class="p">};</span>

<span class="n">AnimalFlags</span><span class="w"> </span><span class="k">operator</span><span class="o">|</span><span class="p">(</span><span class="n">AnimalFlags</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">AnimalFlags</span><span class="w"> </span><span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">AnimalFlags</span><span class="o">&gt;</span><span class="p">(</span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">b</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">auto</span><span class="w"> </span><span class="n">flags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HasClaws</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">CanFly</span><span class="p">;</span>
</pre></div>
</div>
<p>Projects that use this pattern should not enable this optin checker.</p>
</section>
<section id="optin-cplusplus-uninitializedobject-c">
<span id="optin-cplusplus-uninitializedobject"></span><h4><a class="toc-backref" href="#id72" role="doc-backlink"><span class="section-number">1.1.5.2. </span>optin.cplusplus.UninitializedObject (C++)</a><a class="headerlink" href="#optin-cplusplus-uninitializedobject-c" title="Link to this heading">¶</a></h4>
<p>This checker reports uninitialized fields in objects created after a constructor
call. It doesn’t only find direct uninitialized fields, but rather makes a deep
inspection of the object, analyzing all of its fields’ subfields.
The checker regards inherited fields as direct fields, so one will receive
warnings for uninitialized inherited data members as well.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// With Pedantic and CheckPointeeInitialization set to true</span>

<span class="k">struct</span><span class="w"> </span><span class="nc">A</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">struct</span><span class="w"> </span><span class="nc">B</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">;</span><span class="w"> </span><span class="c1">// note: uninitialized field &#39;this-&gt;b.x&#39;</span>
<span class="w">    </span><span class="c1">// note: uninitialized field &#39;this-&gt;bptr-&gt;x&#39;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="p">;</span><span class="w"> </span><span class="c1">// note: uninitialized field &#39;this-&gt;b.y&#39;</span>
<span class="w">    </span><span class="c1">// note: uninitialized field &#39;this-&gt;bptr-&gt;y&#39;</span>
<span class="w">  </span><span class="p">};</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">iptr</span><span class="p">;</span><span class="w"> </span><span class="c1">// note: uninitialized pointer &#39;this-&gt;iptr&#39;</span>
<span class="w">  </span><span class="n">B</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">  </span><span class="n">B</span><span class="w"> </span><span class="o">*</span><span class="n">bptr</span><span class="p">;</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">cptr</span><span class="p">;</span><span class="w"> </span><span class="c1">// note: uninitialized pointee &#39;this-&gt;cptr&#39;</span>

<span class="w">  </span><span class="n">A</span><span class="w"> </span><span class="p">(</span><span class="n">B</span><span class="w"> </span><span class="o">*</span><span class="n">bptr</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">cptr</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">bptr</span><span class="p">(</span><span class="n">bptr</span><span class="p">),</span><span class="w"> </span><span class="n">cptr</span><span class="p">(</span><span class="n">cptr</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>
<span class="p">};</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">f</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">A</span><span class="o">::</span><span class="n">B</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="w">  </span><span class="n">A</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="o">&amp;</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">c</span><span class="p">);</span><span class="w"> </span><span class="c1">// warning: 6 uninitialized fields</span>
<span class="w"> </span><span class="c1">//          after the constructor call</span>
<span class="p">}</span>

<span class="c1">// With Pedantic set to false and</span>
<span class="c1">// CheckPointeeInitialization set to true</span>
<span class="c1">// (every field is uninitialized)</span>

<span class="k">struct</span><span class="w"> </span><span class="nc">A</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">struct</span><span class="w"> </span><span class="nc">B</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">iptr</span><span class="p">;</span>
<span class="w">  </span><span class="n">B</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">  </span><span class="n">B</span><span class="w"> </span><span class="o">*</span><span class="n">bptr</span><span class="p">;</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">cptr</span><span class="p">;</span>

<span class="w">  </span><span class="n">A</span><span class="w"> </span><span class="p">(</span><span class="n">B</span><span class="w"> </span><span class="o">*</span><span class="n">bptr</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">cptr</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">bptr</span><span class="p">(</span><span class="n">bptr</span><span class="p">),</span><span class="w"> </span><span class="n">cptr</span><span class="p">(</span><span class="n">cptr</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>
<span class="p">};</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">f</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">A</span><span class="o">::</span><span class="n">B</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="w">  </span><span class="n">A</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="o">&amp;</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">c</span><span class="p">);</span><span class="w"> </span><span class="c1">// no warning</span>
<span class="p">}</span>

<span class="c1">// With Pedantic set to true and</span>
<span class="c1">// CheckPointeeInitialization set to false</span>
<span class="c1">// (pointees are regarded as initialized)</span>

<span class="k">struct</span><span class="w"> </span><span class="nc">A</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">struct</span><span class="w"> </span><span class="nc">B</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">;</span><span class="w"> </span><span class="c1">// note: uninitialized field &#39;this-&gt;b.x&#39;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="p">;</span><span class="w"> </span><span class="c1">// note: uninitialized field &#39;this-&gt;b.y&#39;</span>
<span class="w">  </span><span class="p">};</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">iptr</span><span class="p">;</span><span class="w"> </span><span class="c1">// note: uninitialized pointer &#39;this-&gt;iptr&#39;</span>
<span class="w">  </span><span class="n">B</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">  </span><span class="n">B</span><span class="w"> </span><span class="o">*</span><span class="n">bptr</span><span class="p">;</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">cptr</span><span class="p">;</span>

<span class="w">  </span><span class="n">A</span><span class="w"> </span><span class="p">(</span><span class="n">B</span><span class="w"> </span><span class="o">*</span><span class="n">bptr</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">cptr</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">bptr</span><span class="p">(</span><span class="n">bptr</span><span class="p">),</span><span class="w"> </span><span class="n">cptr</span><span class="p">(</span><span class="n">cptr</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>
<span class="p">};</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">f</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">A</span><span class="o">::</span><span class="n">B</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="w">  </span><span class="n">A</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="o">&amp;</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">c</span><span class="p">);</span><span class="w"> </span><span class="c1">// warning: 3 uninitialized fields</span>
<span class="w"> </span><span class="c1">//          after the constructor call</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Options</strong></p>
<p>This checker has several options which can be set from command line (e.g.
<code class="docutils literal notranslate"><span class="pre">-analyzer-config</span> <span class="pre">optin.cplusplus.UninitializedObject:Pedantic=true</span></code>):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Pedantic</span></code> (boolean). If to false, the checker won’t emit warnings for
objects that don’t have at least one initialized field. Defaults to false.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NotesAsWarnings</span></code>  (boolean). If set to true, the checker will emit a
warning for each uninitialized field, as opposed to emitting one warning per
constructor call, and listing the uninitialized fields that belongs to it in
notes. <em>Defaults to false</em>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CheckPointeeInitialization</span></code> (boolean). If set to false, the checker will
not analyze the pointee of pointer/reference fields, and will only check
whether the object itself is initialized. <em>Defaults to false</em>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">IgnoreRecordsWithField</span></code> (string). If supplied, the checker will not analyze
structures that have a field with a name or type name that matches  the given
pattern. <em>Defaults to “”</em>.</p></li>
</ul>
</section>
<section id="optin-cplusplus-virtualcall-c">
<span id="optin-cplusplus-virtualcall"></span><h4><a class="toc-backref" href="#id73" role="doc-backlink"><span class="section-number">1.1.5.3. </span>optin.cplusplus.VirtualCall (C++)</a><a class="headerlink" href="#optin-cplusplus-virtualcall-c" title="Link to this heading">¶</a></h4>
<p>When <a class="reference external" href="https://en.cppreference.com/w/cpp/language/virtual#During_construction_and_destruction">virtual methods are called during construction and destruction</a>
the polymorphism is restricted to the class that’s being constructed or
destructed because the more derived contexts are either not yet initialized or
already destructed.</p>
<p>Although this behavior is well-defined, it can surprise the programmer and
cause unintended behavior, so this checker reports calls that appear to be
virtual calls but can be affected by this restricted polymorphism.</p>
<p>Note that situations where this restricted polymorphism causes a call to a pure
virtual method (which is definitely invalid, triggers undefined behavior) are
<strong>reported by another checker:</strong> <a class="reference internal" href="#cplusplus-purevirtualcall"><span class="std std-ref">cplusplus.PureVirtualCall (C++)</span></a> and <strong>this
checker does not report them</strong>.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">A</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">virtual</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">getKind</span><span class="p">();</span>

<span class="w">  </span><span class="n">A</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// warn: This calls A::getKind() even if we are constructing an instance</span>
<span class="w">    </span><span class="c1">// of a different class that is derived from A.</span>
<span class="w">    </span><span class="n">log</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Constructing &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">getKind</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">virtual</span><span class="w"> </span><span class="o">~</span><span class="n">A</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">releaseResources</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">releaseResources</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// warn: This can be called within ~A() and calls A::getKind() even if</span>
<span class="w">    </span><span class="c1">// we are destructing a class that is derived from A.</span>
<span class="w">    </span><span class="n">callSomeFunction</span><span class="p">(</span><span class="n">getKind</span><span class="p">());</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
</section>
<section id="optin-mpi-mpi-checker-c">
<span id="optin-mpi-mpi-checker"></span><h4><a class="toc-backref" href="#id74" role="doc-backlink"><span class="section-number">1.1.5.4. </span>optin.mpi.MPI-Checker (C)</a><a class="headerlink" href="#optin-mpi-mpi-checker-c" title="Link to this heading">¶</a></h4>
<p>Checks MPI code.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">buf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">MPI_Request</span><span class="w"> </span><span class="n">sendReq1</span><span class="p">;</span>
<span class="w">  </span><span class="n">MPI_Ireduce</span><span class="p">(</span><span class="n">MPI_IN_PLACE</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_DOUBLE</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_SUM</span><span class="p">,</span>
<span class="w">      </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">sendReq1</span><span class="p">);</span>
<span class="p">}</span><span class="w"> </span><span class="c1">// warn: request &#39;sendReq1&#39; has no matching wait.</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">buf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">MPI_Request</span><span class="w"> </span><span class="n">sendReq</span><span class="p">;</span>
<span class="w">  </span><span class="n">MPI_Isend</span><span class="p">(</span><span class="o">&amp;</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_DOUBLE</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">sendReq</span><span class="p">);</span>
<span class="w">  </span><span class="n">MPI_Irecv</span><span class="p">(</span><span class="o">&amp;</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_DOUBLE</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">sendReq</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn</span>
<span class="w">  </span><span class="n">MPI_Isend</span><span class="p">(</span><span class="o">&amp;</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_DOUBLE</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">sendReq</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn</span>
<span class="w">  </span><span class="n">MPI_Wait</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sendReq</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_STATUS_IGNORE</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">missingNonBlocking</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">rank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">MPI_Comm_rank</span><span class="p">(</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">rank</span><span class="p">);</span>
<span class="w">  </span><span class="n">MPI_Request</span><span class="w"> </span><span class="n">sendReq1</span><span class="p">[</span><span class="mi">10</span><span class="p">][</span><span class="mi">10</span><span class="p">][</span><span class="mi">10</span><span class="p">];</span>
<span class="w">  </span><span class="n">MPI_Wait</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sendReq1</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">7</span><span class="p">][</span><span class="mi">9</span><span class="p">],</span><span class="w"> </span><span class="n">MPI_STATUS_IGNORE</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="optin-osx-cocoa-localizability-emptylocalizationcontextchecker-objc">
<span id="optin-osx-cocoa-localizability-emptylocalizationcontextchecker"></span><h4><a class="toc-backref" href="#id75" role="doc-backlink"><span class="section-number">1.1.5.5. </span>optin.osx.cocoa.localizability.EmptyLocalizationContextChecker (ObjC)</a><a class="headerlink" href="#optin-osx-cocoa-localizability-emptylocalizationcontextchecker-objc" title="Link to this heading">¶</a></h4>
<p>Check that NSLocalizedString macros include a comment for context.</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">test</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NSLocalizedString</span><span class="p">(</span><span class="s">@&quot;LocalizedString&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">nil</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn</span>
<span class="w">  </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">string2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NSLocalizedString</span><span class="p">(</span><span class="s">@&quot;LocalizedString&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">@&quot; &quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn</span>
<span class="w">  </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">string3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NSLocalizedStringWithDefaultValue</span><span class="p">(</span>
<span class="w">    </span><span class="s">@&quot;LocalizedString&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">nil</span><span class="p">,</span><span class="w"> </span><span class="p">[[</span><span class="bp">NSBundle</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">init</span><span class="p">],</span><span class="w"> </span><span class="nb">nil</span><span class="p">,</span><span class="s">@&quot;&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="optin-osx-cocoa-localizability-nonlocalizedstringchecker-objc">
<span id="optin-osx-cocoa-localizability-nonlocalizedstringchecker"></span><h4><a class="toc-backref" href="#id76" role="doc-backlink"><span class="section-number">1.1.5.6. </span>optin.osx.cocoa.localizability.NonLocalizedStringChecker (ObjC)</a><a class="headerlink" href="#optin-osx-cocoa-localizability-nonlocalizedstringchecker-objc" title="Link to this heading">¶</a></h4>
<p>Warns about uses of non-localized NSStrings passed to UI methods expecting localized NSStrings.</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">alarmText</span><span class="w"> </span><span class="o">=</span>
<span class="w">  </span><span class="n">NSLocalizedString</span><span class="p">(</span><span class="s">@&quot;Enabled&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">@&quot;Indicates alarm is turned on&quot;</span><span class="p">);</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">isEnabled</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">alarmText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">@&quot;Disabled&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="bp">UILabel</span><span class="w"> </span><span class="o">*</span><span class="n">alarmStateLabel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="bp">UILabel</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">init</span><span class="p">];</span>

<span class="c1">// Warning: User-facing text should use localized string macro</span>
<span class="p">[</span><span class="n">alarmStateLabel</span><span class="w"> </span><span class="n">setText</span><span class="o">:</span><span class="n">alarmText</span><span class="p">];</span>
</pre></div>
</div>
</section>
<section id="optin-performance-gcdantipattern">
<span id="id2"></span><h4><a class="toc-backref" href="#id77" role="doc-backlink"><span class="section-number">1.1.5.7. </span>optin.performance.GCDAntipattern</a><a class="headerlink" href="#optin-performance-gcdantipattern" title="Link to this heading">¶</a></h4>
<p>Check for performance anti-patterns when using Grand Central Dispatch.</p>
</section>
<section id="optin-performance-padding-c-c-objc">
<span id="optin-performance-padding"></span><h4><a class="toc-backref" href="#id78" role="doc-backlink"><span class="section-number">1.1.5.8. </span>optin.performance.Padding (C, C++, ObjC)</a><a class="headerlink" href="#optin-performance-padding-c-c-objc" title="Link to this heading">¶</a></h4>
<p>Check for excessively padded structs.</p>
<p>This checker detects structs with excessive padding, which can lead to wasted
memory thus decreased performance by reducing the effectiveness of the
processor cache. Padding bytes are added by compilers to align data accesses
as some processors require data to be aligned to certain boundaries. On others,
unaligned data access are possible, but impose significantly larger latencies.</p>
<p>To avoid padding bytes, the fields of a struct should be ordered by decreasing
by alignment. Usually, its easier to think of the <code class="docutils literal notranslate"><span class="pre">sizeof</span></code> of the fields, and
ordering the fields by <code class="docutils literal notranslate"><span class="pre">sizeof</span></code> would usually also lead to the same optimal
layout.</p>
<p>In rare cases, one can use the <code class="docutils literal notranslate"><span class="pre">#pragma</span> <span class="pre">pack(1)</span></code> directive to enforce a packed
layout too, but it can significantly increase the access times, so reordering the
fields is usually a better solution.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// warn: Excessive padding in &#39;struct NonOptimal&#39; (35 padding bytes, where 3 is optimal)</span>
<span class="k">struct</span><span class="w"> </span><span class="nc">NonOptimal</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">c1</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// 7 bytes of padding</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="kt">int64_t</span><span class="w"> </span><span class="n">big1</span><span class="p">;</span><span class="w"> </span><span class="c1">// 8 bytes</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">c2</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// 7 bytes of padding</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="kt">int64_t</span><span class="w"> </span><span class="n">big2</span><span class="p">;</span><span class="w"> </span><span class="c1">// 8 bytes</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">c3</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// 7 bytes of padding</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="kt">int64_t</span><span class="w"> </span><span class="n">big3</span><span class="p">;</span><span class="w"> </span><span class="c1">// 8 bytes</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">c4</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// 7 bytes of padding</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="kt">int64_t</span><span class="w"> </span><span class="n">big4</span><span class="p">;</span><span class="w"> </span><span class="c1">// 8 bytes</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">c5</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// 7 bytes of padding</span>
<span class="p">};</span>
<span class="k">static_assert</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">NonOptimal</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="o">*</span><span class="mi">8</span><span class="o">+</span><span class="mi">5</span><span class="o">+</span><span class="mi">5</span><span class="o">*</span><span class="mi">7</span><span class="p">);</span>

<span class="c1">// no-warning: The fields are nicely aligned to have the minimal amount of padding bytes.</span>
<span class="k">struct</span><span class="w"> </span><span class="nc">Optimal</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="kt">int64_t</span><span class="w"> </span><span class="n">big1</span><span class="p">;</span><span class="w"> </span><span class="c1">// 8 bytes</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="kt">int64_t</span><span class="w"> </span><span class="n">big2</span><span class="p">;</span><span class="w"> </span><span class="c1">// 8 bytes</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="kt">int64_t</span><span class="w"> </span><span class="n">big3</span><span class="p">;</span><span class="w"> </span><span class="c1">// 8 bytes</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="kt">int64_t</span><span class="w"> </span><span class="n">big4</span><span class="p">;</span><span class="w"> </span><span class="c1">// 8 bytes</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">c1</span><span class="p">;</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">c2</span><span class="p">;</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">c3</span><span class="p">;</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">c4</span><span class="p">;</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">c5</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// 3 bytes of padding</span>
<span class="p">};</span>
<span class="k">static_assert</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">Optimal</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="o">*</span><span class="mi">8</span><span class="o">+</span><span class="mi">5</span><span class="o">+</span><span class="mi">3</span><span class="p">);</span>

<span class="c1">// no-warning: Bit packing representation is also accepted by this checker, but</span>
<span class="c1">// it can significantly increase access times, so prefer reordering the fields.</span>
<span class="cp">#pragma pack(1)</span>
<span class="k">struct</span><span class="w"> </span><span class="nc">BitPacked</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">c1</span><span class="p">;</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="kt">int64_t</span><span class="w"> </span><span class="n">big1</span><span class="p">;</span><span class="w"> </span><span class="c1">// 8 bytes</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">c2</span><span class="p">;</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="kt">int64_t</span><span class="w"> </span><span class="n">big2</span><span class="p">;</span><span class="w"> </span><span class="c1">// 8 bytes</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">c3</span><span class="p">;</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="kt">int64_t</span><span class="w"> </span><span class="n">big3</span><span class="p">;</span><span class="w"> </span><span class="c1">// 8 bytes</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">c4</span><span class="p">;</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="kt">int64_t</span><span class="w"> </span><span class="n">big4</span><span class="p">;</span><span class="w"> </span><span class="c1">// 8 bytes</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">c5</span><span class="p">;</span>
<span class="p">};</span>
<span class="k">static_assert</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">BitPacked</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="o">*</span><span class="mi">8</span><span class="o">+</span><span class="mi">5</span><span class="p">);</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">AllowedPad</span></code> option can be used to specify a threshold for the number
padding bytes raising the warning. If the number of padding bytes of the struct
and the optimal number of padding bytes differ by more than the threshold value,
a warning will be raised.</p>
<p>By default, the <code class="docutils literal notranslate"><span class="pre">AllowedPad</span></code> threshold is 24 bytes.</p>
<p>To override this threshold to e.g. 4 bytes, use the
<code class="docutils literal notranslate"><span class="pre">-analyzer-config</span> <span class="pre">optin.performance.Padding:AllowedPad=4</span></code> option.</p>
</section>
<section id="optin-portability-unixapi">
<span id="id3"></span><h4><a class="toc-backref" href="#id79" role="doc-backlink"><span class="section-number">1.1.5.9. </span>optin.portability.UnixAPI</a><a class="headerlink" href="#optin-portability-unixapi" title="Link to this heading">¶</a></h4>
<p>Finds implementation-defined behavior in UNIX/Posix functions.</p>
</section>
</section>
<section id="optin-taint">
<h3><a class="toc-backref" href="#id80" role="doc-backlink"><span class="section-number">1.1.6. </span>optin.taint</a><a class="headerlink" href="#optin-taint" title="Link to this heading">¶</a></h3>
<p>Checkers implementing
<a class="reference external" href="https://en.wikipedia.org/wiki/Taint_checking">taint analysis</a>.</p>
<section id="optin-taint-generictaint-c-c">
<span id="optin-taint-generictaint"></span><h4><a class="toc-backref" href="#id81" role="doc-backlink"><span class="section-number">1.1.6.1. </span>optin.taint.GenericTaint (C, C++)</a><a class="headerlink" href="#optin-taint-generictaint-c-c" title="Link to this heading">¶</a></h4>
<p>Taint analysis identifies potential security vulnerabilities where the
attacker can inject malicious data to the program to execute an attack
(privilege escalation, command injection, SQL injection etc.).</p>
<p>The malicious data is injected at the taint source (e.g. <code class="docutils literal notranslate"><span class="pre">getenv()</span></code> call)
which is then propagated through function calls and being used as arguments of
sensitive operations, also called as taint sinks (e.g. <code class="docutils literal notranslate"><span class="pre">system()</span></code> call).</p>
<p>One can defend against this type of vulnerability by always checking and
sanitizing the potentially malicious, untrusted user input.</p>
<p>The goal of the checker is to discover and show to the user these potential
taint source-sink pairs and the propagation call chain.</p>
<p>The most notable examples of taint sources are:</p>
<blockquote>
<div><ul class="simple">
<li><p>data from network</p></li>
<li><p>files or standard input</p></li>
<li><p>environment variables</p></li>
<li><p>data from databases</p></li>
</ul>
</div></blockquote>
<p>Let us examine a practical example of a Command Injection attack.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">// Command Injection Vulnerability Example</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">**</span><span class="w"> </span><span class="n">argv</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">cmd</span><span class="p">[</span><span class="mi">2048</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;/bin/cat &quot;</span><span class="p">;</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">filename</span><span class="p">[</span><span class="mi">1024</span><span class="p">];</span>
<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Filename:&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">scanf</span><span class="w"> </span><span class="p">(</span><span class="s">&quot; %1023[^</span><span class="se">\n</span><span class="s">]&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">filename</span><span class="p">);</span><span class="w"> </span><span class="c1">// The attacker can inject a shell escape here</span>
<span class="w">  </span><span class="n">strcat</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span><span class="w"> </span><span class="n">filename</span><span class="p">);</span>
<span class="w">  </span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">);</span><span class="w"> </span><span class="c1">// Warning: Untrusted data is passed to a system call</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The program prints the content of any user specified file.
Unfortunately the attacker can execute arbitrary commands
with shell escapes. For example with the following input the <cite>ls</cite> command is also
executed after the contents of <cite>/etc/shadow</cite> is printed.
<cite>Input: /etc/shadow ; ls /</cite></p>
<p>The analysis implemented in this checker points out this problem.</p>
<p>One can protect against such attack by for example checking if the provided
input refers to a valid file and removing any invalid user input.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">// No vulnerability anymore, but we still get the warning</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">sanitizeFileName</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">filename</span><span class="p">){</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">access</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="n">F_OK</span><span class="p">)){</span><span class="c1">// Verifying user input</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;File does not exist</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">filename</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="sc">&#39;\0&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">**</span><span class="w"> </span><span class="n">argv</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">cmd</span><span class="p">[</span><span class="mi">2048</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;/bin/cat &quot;</span><span class="p">;</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">filename</span><span class="p">[</span><span class="mi">1024</span><span class="p">];</span>
<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Filename:&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">scanf</span><span class="w"> </span><span class="p">(</span><span class="s">&quot; %1023[^</span><span class="se">\n</span><span class="s">]&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">filename</span><span class="p">);</span><span class="w"> </span><span class="c1">// The attacker can inject a shell escape here</span>
<span class="w">  </span><span class="n">sanitizeFileName</span><span class="p">(</span><span class="n">filename</span><span class="p">);</span><span class="c1">// filename is safe after this point</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">filename</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<span class="w">  </span><span class="n">strcat</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span><span class="w"> </span><span class="n">filename</span><span class="p">);</span>
<span class="w">  </span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">);</span><span class="w"> </span><span class="c1">// Superfluous Warning: Untrusted data is passed to a system call</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Unfortunately, the checker cannot discover automatically that the programmer
have performed data sanitation, so it still emits the warning.</p>
<p>One can get rid of this superfluous warning by telling by specifying the
sanitation functions in the taint configuration file (see
<a class="reference internal" href="user-docs/TaintAnalysisConfiguration.html"><span class="doc">Taint Analysis Configuration</span></a>).</p>
<div class="highlight-YAML notranslate"><div class="highlight"><pre><span></span><span class="nt">Filters</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sanitizeFileName</span>
<span class="w">  </span><span class="nt">Args</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<p>The clang invocation to pass the configuration file location:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>clang<span class="w">  </span>--analyze<span class="w"> </span>-Xclang<span class="w"> </span>-analyzer-config<span class="w">  </span>-Xclang<span class="w"> </span>optin.taint.TaintPropagation:Config<span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>/taint_config.yml<span class="w"> </span>...
</pre></div>
</div>
<p>If you are validating your inputs instead of sanitizing them, or don’t want to
mention each sanitizing function in our configuration,
you can use a more generic approach.</p>
<p>Introduce a generic no-op <cite>csa_mark_sanitized(..)</cite> function to
tell the Clang Static Analyzer
that the variable is safe to be used on that analysis path.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">// Marking sanitized variables safe.</span>
<span class="c1">// No vulnerability anymore, no warning.</span>

<span class="c1">// User csa_mark_sanitize function is for the analyzer only</span>
<span class="cp">#ifdef __clang_analyzer__</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">csa_mark_sanitized</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="p">);</span>
<span class="cp">#endif</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">**</span><span class="w"> </span><span class="n">argv</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">cmd</span><span class="p">[</span><span class="mi">2048</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;/bin/cat &quot;</span><span class="p">;</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">filename</span><span class="p">[</span><span class="mi">1024</span><span class="p">];</span>
<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Filename:&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">scanf</span><span class="w"> </span><span class="p">(</span><span class="s">&quot; %1023[^</span><span class="se">\n</span><span class="s">]&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">filename</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">access</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="n">F_OK</span><span class="p">)){</span><span class="c1">// Verifying user input</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;File does not exist</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="cp">#ifdef __clang_analyzer__</span>
<span class="w">    </span><span class="n">csa_mark_sanitized</span><span class="p">(</span><span class="n">filename</span><span class="p">);</span><span class="w"> </span><span class="c1">// Indicating to CSA that filename variable is safe to be used after this point</span>
<span class="w">  </span><span class="cp">#endif</span>
<span class="w">  </span><span class="n">strcat</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span><span class="w"> </span><span class="n">filename</span><span class="p">);</span>
<span class="w">  </span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">);</span><span class="w"> </span><span class="c1">// No warning</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Similarly to the previous example, you need to
define a <cite>Filter</cite> function in a <cite>YAML</cite> configuration file
and add the <cite>csa_mark_sanitized</cite> function.</p>
<div class="highlight-YAML notranslate"><div class="highlight"><pre><span></span><span class="nt">Filters</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">Name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">csa_mark_sanitized</span>
<span class="w">  </span><span class="nt">Args</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<p>Then calling <cite>csa_mark_sanitized(X)</cite> will tell the analyzer that <cite>X</cite> is safe to
be used after this point, because its contents are verified. It is the
responsibility of the programmer to ensure that this verification was indeed
correct. Please note that <cite>csa_mark_sanitized</cite> function is only declared and
used during Clang Static Analysis and skipped in (production) builds.</p>
<p>Further examples of injection vulnerabilities this checker can find.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getchar</span><span class="p">();</span><span class="w"> </span><span class="c1">// &#39;x&#39; marked as tainted</span>
<span class="w">  </span><span class="n">system</span><span class="p">(</span><span class="o">&amp;</span><span class="n">x</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn: untrusted data is passed to a system call</span>
<span class="p">}</span>

<span class="c1">// note: compiler internally checks if the second param to</span>
<span class="c1">// sprintf is a string literal or not.</span>
<span class="c1">// Use -Wno-format-security to suppress compiler warning.</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">s</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span><span class="w"> </span><span class="n">buf</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
<span class="w">  </span><span class="n">fscanf</span><span class="p">(</span><span class="n">stdin</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">);</span><span class="w"> </span><span class="c1">// &#39;s&#39; marked as tainted</span>

<span class="w">  </span><span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn: untrusted data used as a format string</span>
<span class="p">}</span>
</pre></div>
</div>
<p>There are built-in sources, propagations and sinks even if no external taint
configuration is provided.</p>
<dl class="simple">
<dt>Default sources:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">_IO_getc</span></code>, <code class="docutils literal notranslate"><span class="pre">fdopen</span></code>, <code class="docutils literal notranslate"><span class="pre">fopen</span></code>, <code class="docutils literal notranslate"><span class="pre">freopen</span></code>, <code class="docutils literal notranslate"><span class="pre">get_current_dir_name</span></code>,
<code class="docutils literal notranslate"><span class="pre">getch</span></code>, <code class="docutils literal notranslate"><span class="pre">getchar</span></code>, <code class="docutils literal notranslate"><span class="pre">getchar_unlocked</span></code>, <code class="docutils literal notranslate"><span class="pre">getwd</span></code>, <code class="docutils literal notranslate"><span class="pre">getcwd</span></code>,
<code class="docutils literal notranslate"><span class="pre">getgroups</span></code>, <code class="docutils literal notranslate"><span class="pre">gethostname</span></code>, <code class="docutils literal notranslate"><span class="pre">getlogin</span></code>, <code class="docutils literal notranslate"><span class="pre">getlogin_r</span></code>, <code class="docutils literal notranslate"><span class="pre">getnameinfo</span></code>,
<code class="docutils literal notranslate"><span class="pre">gets</span></code>, <code class="docutils literal notranslate"><span class="pre">gets_s</span></code>, <code class="docutils literal notranslate"><span class="pre">getseuserbyname</span></code>, <code class="docutils literal notranslate"><span class="pre">readlink</span></code>, <code class="docutils literal notranslate"><span class="pre">readlinkat</span></code>,
<code class="docutils literal notranslate"><span class="pre">scanf</span></code>, <code class="docutils literal notranslate"><span class="pre">scanf_s</span></code>, <code class="docutils literal notranslate"><span class="pre">socket</span></code>, <code class="docutils literal notranslate"><span class="pre">wgetch</span></code></p>
</dd>
<dt>Default propagations rules:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">atoi</span></code>, <code class="docutils literal notranslate"><span class="pre">atol</span></code>, <code class="docutils literal notranslate"><span class="pre">atoll</span></code>, <code class="docutils literal notranslate"><span class="pre">basename</span></code>, <code class="docutils literal notranslate"><span class="pre">dirname</span></code>, <code class="docutils literal notranslate"><span class="pre">fgetc</span></code>,
<code class="docutils literal notranslate"><span class="pre">fgetln</span></code>, <code class="docutils literal notranslate"><span class="pre">fgets</span></code>, <code class="docutils literal notranslate"><span class="pre">fnmatch</span></code>, <code class="docutils literal notranslate"><span class="pre">fread</span></code>, <code class="docutils literal notranslate"><span class="pre">fscanf</span></code>, <code class="docutils literal notranslate"><span class="pre">fscanf_s</span></code>,
<code class="docutils literal notranslate"><span class="pre">index</span></code>, <code class="docutils literal notranslate"><span class="pre">inflate</span></code>, <code class="docutils literal notranslate"><span class="pre">isalnum</span></code>, <code class="docutils literal notranslate"><span class="pre">isalpha</span></code>, <code class="docutils literal notranslate"><span class="pre">isascii</span></code>, <code class="docutils literal notranslate"><span class="pre">isblank</span></code>,
<code class="docutils literal notranslate"><span class="pre">iscntrl</span></code>, <code class="docutils literal notranslate"><span class="pre">isdigit</span></code>, <code class="docutils literal notranslate"><span class="pre">isgraph</span></code>, <code class="docutils literal notranslate"><span class="pre">islower</span></code>, <code class="docutils literal notranslate"><span class="pre">isprint</span></code>, <code class="docutils literal notranslate"><span class="pre">ispunct</span></code>,
<code class="docutils literal notranslate"><span class="pre">isspace</span></code>, <code class="docutils literal notranslate"><span class="pre">isupper</span></code>, <code class="docutils literal notranslate"><span class="pre">isxdigit</span></code>, <code class="docutils literal notranslate"><span class="pre">memchr</span></code>, <code class="docutils literal notranslate"><span class="pre">memrchr</span></code>, <code class="docutils literal notranslate"><span class="pre">sscanf</span></code>,
<code class="docutils literal notranslate"><span class="pre">getc</span></code>, <code class="docutils literal notranslate"><span class="pre">getc_unlocked</span></code>, <code class="docutils literal notranslate"><span class="pre">getdelim</span></code>, <code class="docutils literal notranslate"><span class="pre">getline</span></code>, <code class="docutils literal notranslate"><span class="pre">getw</span></code>, <code class="docutils literal notranslate"><span class="pre">memcmp</span></code>,
<code class="docutils literal notranslate"><span class="pre">memcpy</span></code>, <code class="docutils literal notranslate"><span class="pre">memmem</span></code>, <code class="docutils literal notranslate"><span class="pre">memmove</span></code>, <code class="docutils literal notranslate"><span class="pre">mbtowc</span></code>, <code class="docutils literal notranslate"><span class="pre">pread</span></code>, <code class="docutils literal notranslate"><span class="pre">qsort</span></code>,
<code class="docutils literal notranslate"><span class="pre">qsort_r</span></code>, <code class="docutils literal notranslate"><span class="pre">rawmemchr</span></code>, <code class="docutils literal notranslate"><span class="pre">read</span></code>, <code class="docutils literal notranslate"><span class="pre">recv</span></code>, <code class="docutils literal notranslate"><span class="pre">recvfrom</span></code>, <code class="docutils literal notranslate"><span class="pre">rindex</span></code>,
<code class="docutils literal notranslate"><span class="pre">strcasestr</span></code>, <code class="docutils literal notranslate"><span class="pre">strchr</span></code>, <code class="docutils literal notranslate"><span class="pre">strchrnul</span></code>, <code class="docutils literal notranslate"><span class="pre">strcasecmp</span></code>, <code class="docutils literal notranslate"><span class="pre">strcmp</span></code>,
<code class="docutils literal notranslate"><span class="pre">strcspn</span></code>, <code class="docutils literal notranslate"><span class="pre">strncasecmp</span></code>, <code class="docutils literal notranslate"><span class="pre">strncmp</span></code>, <code class="docutils literal notranslate"><span class="pre">strndup</span></code>,
<code class="docutils literal notranslate"><span class="pre">strndupa</span></code>, <code class="docutils literal notranslate"><span class="pre">strpbrk</span></code>, <code class="docutils literal notranslate"><span class="pre">strrchr</span></code>, <code class="docutils literal notranslate"><span class="pre">strsep</span></code>, <code class="docutils literal notranslate"><span class="pre">strspn</span></code>,
<code class="docutils literal notranslate"><span class="pre">strstr</span></code>, <code class="docutils literal notranslate"><span class="pre">strtol</span></code>, <code class="docutils literal notranslate"><span class="pre">strtoll</span></code>, <code class="docutils literal notranslate"><span class="pre">strtoul</span></code>, <code class="docutils literal notranslate"><span class="pre">strtoull</span></code>, <code class="docutils literal notranslate"><span class="pre">tolower</span></code>,
<code class="docutils literal notranslate"><span class="pre">toupper</span></code>, <code class="docutils literal notranslate"><span class="pre">ttyname</span></code>, <code class="docutils literal notranslate"><span class="pre">ttyname_r</span></code>, <code class="docutils literal notranslate"><span class="pre">wctomb</span></code>, <code class="docutils literal notranslate"><span class="pre">wcwidth</span></code></p>
</dd>
<dt>Default sinks:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">printf</span></code>, <code class="docutils literal notranslate"><span class="pre">setproctitle</span></code>, <code class="docutils literal notranslate"><span class="pre">system</span></code>, <code class="docutils literal notranslate"><span class="pre">popen</span></code>, <code class="docutils literal notranslate"><span class="pre">execl</span></code>, <code class="docutils literal notranslate"><span class="pre">execle</span></code>,
<code class="docutils literal notranslate"><span class="pre">execlp</span></code>, <code class="docutils literal notranslate"><span class="pre">execv</span></code>, <code class="docutils literal notranslate"><span class="pre">execvp</span></code>, <code class="docutils literal notranslate"><span class="pre">execvP</span></code>, <code class="docutils literal notranslate"><span class="pre">execve</span></code>, <code class="docutils literal notranslate"><span class="pre">dlopen</span></code></p>
</dd>
</dl>
<p>Please note that there are no built-in filter functions.</p>
<p>One can configure their own taint sources, sinks, and propagation rules by
providing a configuration file via checker option
<code class="docutils literal notranslate"><span class="pre">optin.taint.TaintPropagation:Config</span></code>. The configuration file is in
<a class="reference external" href="http://llvm.org/docs/YamlIO.html#introduction-to-yaml">YAML</a> format. The
taint-related options defined in the config file extend but do not override the
built-in sources, rules, sinks. The format of the external taint configuration
file is not stable, and could change without any notice even in a non-backward
compatible way.</p>
<p>For a more detailed description of configuration options, please see the
<a class="reference internal" href="user-docs/TaintAnalysisConfiguration.html"><span class="doc">Taint Analysis Configuration</span></a>. For an example see
<a class="reference internal" href="user-docs/TaintAnalysisConfiguration.html#clangsa-taint-configuration-example"><span class="std std-ref">Example configuration file</span></a>.</p>
<p><strong>Configuration</strong></p>
<ul class="simple">
<li><p><cite>Config</cite>  Specifies the name of the YAML configuration file. The user can
define their own taint sources and sinks.</p></li>
</ul>
<p><strong>Related Guidelines</strong></p>
<ul class="simple">
<li><p><a class="reference external" href="https://cwe.mitre.org/data/definitions/137.html">CWE Data Neutralization Issues</a></p></li>
<li><p><a class="reference external" href="https://wiki.sei.cmu.edu/confluence/display/c/STR02-C.+Sanitize+data+passed+to+complex+subsystems">SEI Cert STR02-C. Sanitize data passed to complex subsystems</a></p></li>
<li><p><a class="reference external" href="https://wiki.sei.cmu.edu/confluence/pages/viewpage.action?pageId=87152177">SEI Cert ENV33-C. Do not call system()</a></p></li>
<li><p><a class="reference external" href="https://wiki.sei.cmu.edu/confluence/display/c/ENV03-C.+Sanitize+the+environment+when+invoking+external+programs">ENV03-C. Sanitize the environment when invoking external programs</a></p></li>
</ul>
<p><strong>Limitations</strong></p>
<ul class="simple">
<li><p>The taintedness property is not propagated through function calls which are
unknown (or too complex) to the analyzer, unless there is a specific
propagation rule built-in to the checker or given in the YAML configuration
file. This causes potential true positive findings to be lost.</p></li>
</ul>
</section>
<section id="optin-taint-taintedalloc-c-c">
<span id="optin-taint-taintedalloc"></span><h4><a class="toc-backref" href="#id82" role="doc-backlink"><span class="section-number">1.1.6.2. </span>optin.taint.TaintedAlloc (C, C++)</a><a class="headerlink" href="#optin-taint-taintedalloc-c-c" title="Link to this heading">¶</a></h4>
<p>This checker warns for cases when the <code class="docutils literal notranslate"><span class="pre">size</span></code> parameter of the <code class="docutils literal notranslate"><span class="pre">malloc</span></code> ,
<code class="docutils literal notranslate"><span class="pre">calloc</span></code>, <code class="docutils literal notranslate"><span class="pre">realloc</span></code>, <code class="docutils literal notranslate"><span class="pre">alloca</span></code> or the size parameter of the
array new C++ operator is tainted (potentially attacker controlled).
If an attacker can inject a large value as the size parameter, memory exhaustion
denial of service attack can be carried out.</p>
<p>The analyzer emits warning only if it cannot prove that the size parameter is
within reasonable bounds (<code class="docutils literal notranslate"><span class="pre">&lt;=</span> <span class="pre">SIZE_MAX/4</span></code>). This functionality partially
covers the SEI Cert coding standard rule <a class="reference external" href="https://wiki.sei.cmu.edu/confluence/display/c/INT04-C.+Enforce+limits+on+integer+values+originating+from+tainted+sources">INT04-C</a>.</p>
<p>You can silence this warning either by bound checking the <code class="docutils literal notranslate"><span class="pre">size</span></code> parameter, or
by explicitly marking the <code class="docutils literal notranslate"><span class="pre">size</span></code> parameter as sanitized. See the
<a class="reference internal" href="#optin-taint-generictaint"><span class="std std-ref">optin.taint.GenericTaint (C, C++)</span></a> checker for an example.</p>
<p>Custom allocation/deallocation functions can be defined using
<a class="reference internal" href="../AttributeReference.html#analyzer-ownership-attrs"><span class="std std-ref">ownership attributes</span></a>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">vulnerable</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%zu&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">size</span><span class="p">);</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="n">size</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn: malloc is called with a tainted (potentially attacker controlled) value</span>
<span class="w">  </span><span class="n">free</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">not_vulnerable</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%zu&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">size</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="mi">1024</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">size</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="n">size</span><span class="p">);</span><span class="w"> </span><span class="c1">// No warning expected as the the user input is bound</span>
<span class="w">  </span><span class="n">free</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">vulnerable_cpp</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%zu&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">size</span><span class="p">);</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="kt">int</span><span class="p">[</span><span class="n">size</span><span class="p">];</span><span class="c1">// warn: Memory allocation function is called with a tainted (potentially attacker controlled) value</span>
<span class="w">  </span><span class="n">delete</span><span class="p">[]</span><span class="w"> </span><span class="n">ptr</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="optin-taint-tainteddiv-c-c-objc">
<span id="optin-taint-tainteddiv"></span><h4><a class="toc-backref" href="#id83" role="doc-backlink"><span class="section-number">1.1.6.3. </span>optin.taint.TaintedDiv (C, C++, ObjC)</a><a class="headerlink" href="#optin-taint-tainteddiv-c-c-objc" title="Link to this heading">¶</a></h4>
<p>This checker warns when the denominator in a division
operation is a tainted (potentially attacker controlled) value.
If the attacker can set the denominator to 0, a runtime error can
be triggered. The checker warns when the denominator is a tainted
value and the analyzer cannot prove that it is not 0. This warning
is more pessimistic than the <a class="reference internal" href="#core-dividezero"><span class="std std-ref">core.DivideZero (C, C++, ObjC)</span></a> checker
which warns only when it can prove that the denominator is 0.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">vulnerable</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%zu&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">size</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">size</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn: Division by a tainted value, possibly zero</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">not_vulnerable</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%zu&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">size</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">size</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">size</span><span class="p">;</span><span class="w"> </span><span class="c1">// no warning</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="security">
<span id="security-checkers"></span><h3><a class="toc-backref" href="#id84" role="doc-backlink"><span class="section-number">1.1.7. </span>security</a><a class="headerlink" href="#security" title="Link to this heading">¶</a></h3>
<p>Security related checkers.</p>
<section id="security-arraybound-c-c">
<span id="security-arraybound"></span><h4><a class="toc-backref" href="#id85" role="doc-backlink"><span class="section-number">1.1.7.1. </span>security.ArrayBound (C, C++)</a><a class="headerlink" href="#security-arraybound-c-c" title="Link to this heading">¶</a></h4>
<p>Report out of bounds access to memory that is before the start or after the end
of the accessed region (array, heap-allocated region, string literal etc.).
This usually means incorrect indexing, but the checker also detects access via
the operators <code class="docutils literal notranslate"><span class="pre">*</span></code> and <code class="docutils literal notranslate"><span class="pre">-&gt;</span></code>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test_underflow</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">buf</span><span class="p">[</span><span class="mi">100</span><span class="p">][</span><span class="mi">100</span><span class="p">];</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="n">buf</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">x</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test_overflow</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">buf</span><span class="p">[</span><span class="mi">100</span><span class="p">];</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buf</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span>
<span class="w">  </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If checkers like <a class="reference internal" href="#unix-malloc"><span class="std std-ref">unix.Malloc (C)</span></a> or <a class="reference internal" href="#cplusplus-newdelete"><span class="std std-ref">cplusplus.NewDelete (C++)</span></a> are enabled
to model the behavior of <code class="docutils literal notranslate"><span class="pre">malloc()</span></code>, <code class="docutils literal notranslate"><span class="pre">operator</span> <span class="pre">new</span></code> and similar
allocators), then this checker can also reports out of bounds access to
dynamically allocated memory:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="nf">test_dynamic</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">mem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">int</span><span class="p">[</span><span class="mi">100</span><span class="p">];</span>
<span class="w">  </span><span class="n">mem</span><span class="p">[</span><span class="mi">-1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">42</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">mem</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In uncertain situations (when the checker can neither prove nor disprove that
overflow occurs), the checker assumes that the the index (more precisely, the
memory offeset) is within bounds.</p>
<p>However, if <a class="reference internal" href="#optin-taint-generictaint"><span class="std std-ref">optin.taint.GenericTaint (C, C++)</span></a> is enabled and the index/offset is
tainted (i.e. it is influenced by an untrusted source), then this checker
reports the potential out of bounds access:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test_with_tainted_index</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">s</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;abc&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getchar</span><span class="p">();</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">[</span><span class="n">x</span><span class="p">];</span><span class="w"> </span><span class="c1">// warn: potential out of bounds access with tainted index</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This checker is an improved and renamed version of the checker that was
previously known as <code class="docutils literal notranslate"><span class="pre">alpha.security.ArrayBoundV2</span></code>. The old checker
<code class="docutils literal notranslate"><span class="pre">alpha.security.ArrayBound</span></code> was removed when the (previously
“experimental”) V2 variant became stable enough for regular use.</p>
</div>
</section>
<section id="security-cert-env-invalidptr">
<span id="id4"></span><h4><a class="toc-backref" href="#id86" role="doc-backlink"><span class="section-number">1.1.7.2. </span>security.cert.env.InvalidPtr</a><a class="headerlink" href="#security-cert-env-invalidptr" title="Link to this heading">¶</a></h4>
<p>Corresponds to SEI CERT Rules <a class="reference external" href="https://wiki.sei.cmu.edu/confluence/display/c/ENV31-C.+Do+not+rely+on+an+environment+pointer+following+an+operation+that+may+invalidate+it">ENV31-C</a> and <a class="reference external" href="https://wiki.sei.cmu.edu/confluence/display/c/ENV34-C.+Do+not+store+pointers+returned+by+certain+functions">ENV34-C</a>.</p>
<ul class="simple">
<li><p><strong>ENV31-C</strong>:
Rule is about the possible problem with <code class="docutils literal notranslate"><span class="pre">main</span></code> function’s third argument, environment pointer,
“envp”. When environment array is modified using some modification function
such as <code class="docutils literal notranslate"><span class="pre">putenv</span></code>, <code class="docutils literal notranslate"><span class="pre">setenv</span></code> or others, It may happen that memory is reallocated,
however “envp” is not updated to reflect the changes and points to old memory
region.</p></li>
<li><p><strong>ENV34-C</strong>:
Some functions return a pointer to a statically allocated buffer.
Consequently, subsequent call of these functions will invalidate previous
pointer. These functions include: <code class="docutils literal notranslate"><span class="pre">getenv</span></code>, <code class="docutils literal notranslate"><span class="pre">localeconv</span></code>, <code class="docutils literal notranslate"><span class="pre">asctime</span></code>, <code class="docutils literal notranslate"><span class="pre">setlocale</span></code>, <code class="docutils literal notranslate"><span class="pre">strerror</span></code></p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">argv</span><span class="p">[],</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">envp</span><span class="p">[])</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">setenv</span><span class="p">(</span><span class="s">&quot;MY_NEW_VAR&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;new_value&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// setenv call may invalidate &#39;envp&#39;</span>
<span class="w">    </span><span class="cm">/* Handle error */</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">envp</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">envp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">puts</span><span class="p">(</span><span class="n">envp</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="w">      </span><span class="c1">// envp may no longer point to the current environment</span>
<span class="w">      </span><span class="c1">// this program has unanticipated behavior, since envp</span>
<span class="w">      </span><span class="c1">// does not reflect changes made by setenv function.</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">previous_call_invalidation</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">pp</span><span class="p">;</span>

<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getenv</span><span class="p">(</span><span class="s">&quot;VAR&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">setenv</span><span class="p">(</span><span class="s">&quot;SOMEVAR&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;VALUE&quot;</span><span class="p">,</span><span class="w"> </span><span class="cm">/*overwrite = */</span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="c1">// call to &#39;setenv&#39; may invalidate p</span>

<span class="w">  </span><span class="o">*</span><span class="n">p</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// dereferencing invalid pointer</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">InvalidatingGetEnv</span></code> option is available for treating <code class="docutils literal notranslate"><span class="pre">getenv</span></code> calls as
invalidating. When enabled, the checker issues a warning if <code class="docutils literal notranslate"><span class="pre">getenv</span></code> is called
multiple times and their results are used without first creating a copy.
This level of strictness might be considered overly pedantic for the commonly
used <code class="docutils literal notranslate"><span class="pre">getenv</span></code> implementations.</p>
<p>To enable this option, use:
<code class="docutils literal notranslate"><span class="pre">-analyzer-config</span> <span class="pre">security.cert.env.InvalidPtr:InvalidatingGetEnv=true</span></code>.</p>
<p>By default, this option is set to <em>false</em>.</p>
<p>When this option is enabled, warnings will be generated for scenarios like the
following:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getenv</span><span class="p">(</span><span class="s">&quot;VAR&quot;</span><span class="p">);</span>
<span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">pp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getenv</span><span class="p">(</span><span class="s">&quot;VAR2&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// assumes this call can invalidate `env`</span>
<span class="n">strlen</span><span class="p">(</span><span class="n">p</span><span class="p">);</span><span class="w"> </span><span class="c1">// warns about accessing invalid ptr</span>
</pre></div>
</div>
</section>
<section id="security-floatloopcounter-c">
<span id="security-floatloopcounter"></span><h4><a class="toc-backref" href="#id87" role="doc-backlink"><span class="section-number">1.1.7.3. </span>security.FloatLoopCounter (C)</a><a class="headerlink" href="#security-floatloopcounter-c" title="Link to this heading">¶</a></h4>
<p>Warn on using a floating point value as a loop counter (CERT: FLP30-C, FLP30-CPP).</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1f</span><span class="p">;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">1.0f</span><span class="p">;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">0.1f</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="security-insecureapi-uncheckedreturn-c">
<span id="security-insecureapi-uncheckedreturn"></span><h4><a class="toc-backref" href="#id88" role="doc-backlink"><span class="section-number">1.1.7.4. </span>security.insecureAPI.UncheckedReturn (C)</a><a class="headerlink" href="#security-insecureapi-uncheckedreturn-c" title="Link to this heading">¶</a></h4>
<p>Warn on uses of functions whose return values must be always checked.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">setuid</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="security-insecureapi-bcmp-c">
<span id="security-insecureapi-bcmp"></span><h4><a class="toc-backref" href="#id89" role="doc-backlink"><span class="section-number">1.1.7.5. </span>security.insecureAPI.bcmp (C)</a><a class="headerlink" href="#security-insecureapi-bcmp-c" title="Link to this heading">¶</a></h4>
<p>Warn on uses of the ‘bcmp’ function.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">bcmp</span><span class="p">(</span><span class="n">ptr0</span><span class="p">,</span><span class="w"> </span><span class="n">ptr1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="security-insecureapi-bcopy-c">
<span id="security-insecureapi-bcopy"></span><h4><a class="toc-backref" href="#id90" role="doc-backlink"><span class="section-number">1.1.7.6. </span>security.insecureAPI.bcopy (C)</a><a class="headerlink" href="#security-insecureapi-bcopy-c" title="Link to this heading">¶</a></h4>
<p>Warn on uses of the ‘bcopy’ function.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">bcopy</span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="security-insecureapi-bzero-c">
<span id="security-insecureapi-bzero"></span><h4><a class="toc-backref" href="#id91" role="doc-backlink"><span class="section-number">1.1.7.7. </span>security.insecureAPI.bzero (C)</a><a class="headerlink" href="#security-insecureapi-bzero-c" title="Link to this heading">¶</a></h4>
<p>Warn on uses of the ‘bzero’ function.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">bzero</span><span class="p">(</span><span class="n">ptr</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="security-insecureapi-getpw-c">
<span id="security-insecureapi-getpw"></span><h4><a class="toc-backref" href="#id92" role="doc-backlink"><span class="section-number">1.1.7.8. </span>security.insecureAPI.getpw (C)</a><a class="headerlink" href="#security-insecureapi-getpw-c" title="Link to this heading">¶</a></h4>
<p>Warn on uses of the ‘getpw’ function.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">buff</span><span class="p">[</span><span class="mi">1024</span><span class="p">];</span>
<span class="w">  </span><span class="n">getpw</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">buff</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="security-insecureapi-gets-c">
<span id="security-insecureapi-gets"></span><h4><a class="toc-backref" href="#id93" role="doc-backlink"><span class="section-number">1.1.7.9. </span>security.insecureAPI.gets (C)</a><a class="headerlink" href="#security-insecureapi-gets-c" title="Link to this heading">¶</a></h4>
<p>Warn on uses of the ‘gets’ function.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">buff</span><span class="p">[</span><span class="mi">1024</span><span class="p">];</span>
<span class="w">  </span><span class="n">gets</span><span class="p">(</span><span class="n">buff</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="security-insecureapi-mkstemp-c">
<span id="security-insecureapi-mkstemp"></span><h4><a class="toc-backref" href="#id94" role="doc-backlink"><span class="section-number">1.1.7.10. </span>security.insecureAPI.mkstemp (C)</a><a class="headerlink" href="#security-insecureapi-mkstemp-c" title="Link to this heading">¶</a></h4>
<p>Warn when ‘mkstemp’ is passed fewer than 6 X’s in the format string.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">mkstemp</span><span class="p">(</span><span class="s">&quot;XX&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="security-insecureapi-mktemp-c">
<span id="security-insecureapi-mktemp"></span><h4><a class="toc-backref" href="#id95" role="doc-backlink"><span class="section-number">1.1.7.11. </span>security.insecureAPI.mktemp (C)</a><a class="headerlink" href="#security-insecureapi-mktemp-c" title="Link to this heading">¶</a></h4>
<p>Warn on uses of the <code class="docutils literal notranslate"><span class="pre">mktemp</span></code> function.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mktemp</span><span class="p">(</span><span class="s">&quot;/tmp/zxcv&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn: insecure, use mkstemp</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="security-insecureapi-rand-c">
<span id="security-insecureapi-rand"></span><h4><a class="toc-backref" href="#id96" role="doc-backlink"><span class="section-number">1.1.7.12. </span>security.insecureAPI.rand (C)</a><a class="headerlink" href="#security-insecureapi-rand-c" title="Link to this heading">¶</a></h4>
<p>Warn on uses of inferior random number generating functions (only if arc4random function is available):
<code class="docutils literal notranslate"><span class="pre">drand48,</span> <span class="pre">erand48,</span> <span class="pre">jrand48,</span> <span class="pre">lcong48,</span> <span class="pre">lrand48,</span> <span class="pre">mrand48,</span> <span class="pre">nrand48,</span> <span class="pre">random,</span> <span class="pre">rand_r</span></code>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">random</span><span class="p">();</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="security-insecureapi-strcpy-c">
<span id="security-insecureapi-strcpy"></span><h4><a class="toc-backref" href="#id97" role="doc-backlink"><span class="section-number">1.1.7.13. </span>security.insecureAPI.strcpy (C)</a><a class="headerlink" href="#security-insecureapi-strcpy-c" title="Link to this heading">¶</a></h4>
<p>Warn on uses of the <code class="docutils literal notranslate"><span class="pre">strcpy</span></code> and <code class="docutils literal notranslate"><span class="pre">strcat</span></code> functions.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;abcd&quot;</span><span class="p">;</span>

<span class="w">  </span><span class="n">strcpy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="security-insecureapi-vfork-c">
<span id="security-insecureapi-vfork"></span><h4><a class="toc-backref" href="#id98" role="doc-backlink"><span class="section-number">1.1.7.14. </span>security.insecureAPI.vfork (C)</a><a class="headerlink" href="#security-insecureapi-vfork-c" title="Link to this heading">¶</a></h4>
<blockquote>
<div><p>Warn on uses of the ‘vfork’ function.</p>
</div></blockquote>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">vfork</span><span class="p">();</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="security-insecureapi-deprecatedorunsafebufferhandling-c">
<span id="security-insecureapi-deprecatedorunsafebufferhandling"></span><h4><a class="toc-backref" href="#id99" role="doc-backlink"><span class="section-number">1.1.7.15. </span>security.insecureAPI.DeprecatedOrUnsafeBufferHandling (C)</a><a class="headerlink" href="#security-insecureapi-deprecatedorunsafebufferhandling-c" title="Link to this heading">¶</a></h4>
<blockquote>
<div><p>Warn on occurrences of unsafe or deprecated buffer handling functions, which now have a secure variant: <code class="docutils literal notranslate"><span class="pre">sprintf,</span> <span class="pre">fprintf,</span> <span class="pre">vsprintf,</span> <span class="pre">scanf,</span> <span class="pre">wscanf,</span> <span class="pre">fscanf,</span> <span class="pre">fwscanf,</span> <span class="pre">vscanf,</span> <span class="pre">vwscanf,</span> <span class="pre">vfscanf,</span> <span class="pre">vfwscanf,</span> <span class="pre">sscanf,</span> <span class="pre">swscanf,</span> <span class="pre">vsscanf,</span> <span class="pre">vswscanf,</span> <span class="pre">swprintf,</span> <span class="pre">snprintf,</span> <span class="pre">vswprintf,</span> <span class="pre">vsnprintf,</span> <span class="pre">memcpy,</span> <span class="pre">memmove,</span> <span class="pre">strncpy,</span> <span class="pre">strncat,</span> <span class="pre">memset</span></code></p>
</div></blockquote>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">buf</span><span class="w"> </span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
<span class="w">  </span><span class="n">strncpy</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="security-mmapwriteexec-c">
<span id="security-mmapwriteexec"></span><h4><a class="toc-backref" href="#id100" role="doc-backlink"><span class="section-number">1.1.7.16. </span>security.MmapWriteExec (C)</a><a class="headerlink" href="#security-mmapwriteexec-c" title="Link to this heading">¶</a></h4>
<p>Warn on <code class="docutils literal notranslate"><span class="pre">mmap()</span></code> calls with both writable and executable access.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mmap</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p">,</span><span class="w"> </span><span class="n">PROT_READ</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">PROT_WRITE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">PROT_EXEC</span><span class="p">,</span>
<span class="w">                 </span><span class="n">MAP_PRIVATE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">MAP_ANON</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">  </span><span class="c1">// warn: Both PROT_WRITE and PROT_EXEC flags are set. This can lead to</span>
<span class="w">  </span><span class="c1">//       exploitable memory regions, which could be overwritten with malicious</span>
<span class="w">  </span><span class="c1">//       code</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="security-pointersub-c">
<span id="security-pointersub"></span><h4><a class="toc-backref" href="#id101" role="doc-backlink"><span class="section-number">1.1.7.17. </span>security.PointerSub (C)</a><a class="headerlink" href="#security-pointersub-c" title="Link to this heading">¶</a></h4>
<p>Check for pointer subtractions on two pointers pointing to different memory
chunks. According to the C standard §6.5.6 only subtraction of pointers that
point into (or one past the end) the same array object is valid (for this
purpose non-array variables are like arrays of size 1). This checker only
searches for different memory objects at subtraction, but does not check if the
array index is correct. Furthermore, only cases are reported where
stack-allocated objects are involved (no warnings on pointers to memory
allocated by <cite>malloc</cite>).</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span><span class="w"> </span><span class="n">d</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">c</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">&amp;</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">d</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">&amp;</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span><span class="w"> </span><span class="c1">// warn: &#39;c&#39; and &#39;d&#39; are different arrays</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">&amp;</span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">&amp;</span><span class="n">a</span><span class="p">;</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">b</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">&amp;</span><span class="n">a</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn: &#39;a&#39; and &#39;b&#39; are different variables</span>
<span class="p">}</span>

<span class="k">struct</span><span class="w"> </span><span class="nc">S</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
<span class="p">};</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test1</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">struct</span><span class="w"> </span><span class="nc">S</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
<span class="w">  </span><span class="k">struct</span><span class="w"> </span><span class="nc">S</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">a</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">&amp;</span><span class="n">a</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
<span class="w">  </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="o">&amp;</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
<span class="w">  </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">x</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn: &#39;S.b&#39; and &#39;S.a&#39; are different objects</span>
<span class="w">  </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">b</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">b</span><span class="p">.</span><span class="n">x</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn: different members of the same object</span>
<span class="w">  </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">b</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">b</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn: object of type S is not the same array as a member of it</span>
<span class="p">}</span>
</pre></div>
</div>
<p>There may be existing applications that use code like above for calculating
offsets of members in a structure, using pointer subtractions. This is still
undefined behavior according to the standard and code like this can be replaced
with the <cite>offsetof</cite> macro.</p>
</section>
<section id="security-putenvstackarray-c">
<span id="security-putenv-stack-array"></span><h4><a class="toc-backref" href="#id102" role="doc-backlink"><span class="section-number">1.1.7.18. </span>security.PutenvStackArray (C)</a><a class="headerlink" href="#security-putenvstackarray-c" title="Link to this heading">¶</a></h4>
<p>Finds calls to the <code class="docutils literal notranslate"><span class="pre">putenv</span></code> function which pass a pointer to a stack-allocated
(automatic) array as the argument. Function <code class="docutils literal notranslate"><span class="pre">putenv</span></code> does not copy the passed
string, only a pointer to the data is stored and this data can be read even by
other threads. Content of a stack-allocated array is likely to be overwritten
after exiting from the function.</p>
<p>The problem can be solved by using a static array variable or dynamically
allocated memory. Even better is to avoid using <code class="docutils literal notranslate"><span class="pre">putenv</span></code> (it has other
problems related to memory leaks) and use <code class="docutils literal notranslate"><span class="pre">setenv</span></code> instead.</p>
<p>The check corresponds to CERT rule
<a class="reference external" href="https://wiki.sei.cmu.edu/confluence/display/c/POS34-C.+Do+not+call+putenv%28%29+with+a+pointer+to+an+automatic+variable+as+the+argument">POS34-C. Do not call putenv() with a pointer to an automatic variable as the argument</a>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">f</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">env</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;NAME=value&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">putenv</span><span class="p">(</span><span class="n">env</span><span class="p">);</span><span class="w"> </span><span class="c1">// putenv function should not be called with stack-allocated string</span>
<span class="p">}</span>
</pre></div>
</div>
<p>There is one case where the checker can report a false positive. This is when
the stack-allocated array is used at <cite>putenv</cite> in a function or code branch that
does not return (process is terminated on all execution paths).</p>
<p>Another special case is if the <cite>putenv</cite> is called from function <cite>main</cite>. Here
the stack is deallocated at the end of the program and it should be no problem
to use the stack-allocated string (a multi-threaded program may require more
attention). The checker does not warn for cases when stack space of <cite>main</cite> is
used at the <cite>putenv</cite> call.</p>
</section>
<section id="security-setgidsetuidorder-c">
<h4><a class="toc-backref" href="#id103" role="doc-backlink"><span class="section-number">1.1.7.19. </span>security.SetgidSetuidOrder (C)</a><a class="headerlink" href="#security-setgidsetuidorder-c" title="Link to this heading">¶</a></h4>
<p>When dropping user-level and group-level privileges in a program by using
<code class="docutils literal notranslate"><span class="pre">setuid</span></code> and <code class="docutils literal notranslate"><span class="pre">setgid</span></code> calls, it is important to reset the group-level
privileges (with <code class="docutils literal notranslate"><span class="pre">setgid</span></code>) first. Function <code class="docutils literal notranslate"><span class="pre">setgid</span></code> will likely fail if
the superuser privileges are already dropped.</p>
<p>The checker checks for sequences of <code class="docutils literal notranslate"><span class="pre">setuid(getuid())</span></code> and
<code class="docutils literal notranslate"><span class="pre">setgid(getgid())</span></code> calls (in this order). If such a sequence is found and
there is no other privilege-changing function call (<code class="docutils literal notranslate"><span class="pre">seteuid</span></code>, <code class="docutils literal notranslate"><span class="pre">setreuid</span></code>,
<code class="docutils literal notranslate"><span class="pre">setresuid</span></code> and the GID versions of these) in between, a warning is
generated. The checker finds only exactly <code class="docutils literal notranslate"><span class="pre">setuid(getuid())</span></code> calls (and the
GID versions), not for example if the result of <code class="docutils literal notranslate"><span class="pre">getuid()</span></code> is stored in a
variable.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test1</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// ...</span>
<span class="w">  </span><span class="c1">// end of section with elevated privileges</span>
<span class="w">  </span><span class="c1">// reset privileges (user and group) to normal user</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">setuid</span><span class="p">(</span><span class="n">getuid</span><span class="p">())</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">handle_error</span><span class="p">();</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">setgid</span><span class="p">(</span><span class="n">getgid</span><span class="p">())</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// warning: A &#39;setgid(getgid())&#39; call following a &#39;setuid(getuid())&#39; call is likely to fail</span>
<span class="w">    </span><span class="n">handle_error</span><span class="p">();</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="c1">// user-ID and group-ID are reset to normal user now</span>
<span class="w">  </span><span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the code above the problem is that <code class="docutils literal notranslate"><span class="pre">setuid(getuid())</span></code> removes superuser
privileges before <code class="docutils literal notranslate"><span class="pre">setgid(getgid())</span></code> is called. To fix the problem the
<code class="docutils literal notranslate"><span class="pre">setgid(getgid())</span></code> should be called first. Further attention is needed to
avoid code like <code class="docutils literal notranslate"><span class="pre">setgid(getuid())</span></code> (this checker does not detect bugs like
this) and always check the return value of these calls.</p>
<p>This check corresponds to SEI CERT Rule <a class="reference external" href="https://wiki.sei.cmu.edu/confluence/display/c/POS36-C.+Observe+correct+revocation+order+while+relinquishing+privileges">POS36-C</a>.</p>
</section>
</section>
<section id="unix">
<span id="unix-checkers"></span><h3><a class="toc-backref" href="#id104" role="doc-backlink"><span class="section-number">1.1.8. </span>unix</a><a class="headerlink" href="#unix" title="Link to this heading">¶</a></h3>
<p>POSIX/Unix checkers.</p>
<section id="unix-api-c">
<span id="unix-api"></span><h4><a class="toc-backref" href="#id105" role="doc-backlink"><span class="section-number">1.1.8.1. </span>unix.API (C)</a><a class="headerlink" href="#unix-api-c" title="Link to this heading">¶</a></h4>
<p>Check calls to various UNIX/Posix functions: <code class="docutils literal notranslate"><span class="pre">open,</span> <span class="pre">pthread_once,</span> <span class="pre">calloc,</span> <span class="pre">malloc,</span> <span class="pre">realloc,</span> <span class="pre">alloca</span></code>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span>
<span class="c1">// Currently the check is performed for apple targets only.</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">path</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">fd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="n">O_CREAT</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// warn: call to &#39;open&#39; requires a third argument when the</span>
<span class="w">    </span><span class="c1">// &#39;O_CREAT&#39; flag is set</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">f</span><span class="p">();</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">pthread_once_t</span><span class="w"> </span><span class="n">pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">0x30B1BCBA</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">}};</span>
<span class="w">  </span><span class="n">pthread_once</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pred</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// warn: call to &#39;pthread_once&#39; uses the local variable</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn: allocation size of 0 bytes</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">calloc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">42</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn: allocation size of 0 bytes</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">realloc</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn: allocation size of 0 bytes</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">alloca</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn: allocation size of 0 bytes</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">valloc</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn: allocation size of 0 bytes</span>
<span class="p">}</span>

</pre></div>
</div>
</section>
<section id="unix-blockincriticalsection-c-c">
<span id="unix-blockincriticalsection"></span><h4><a class="toc-backref" href="#id106" role="doc-backlink"><span class="section-number">1.1.8.2. </span>unix.BlockInCriticalSection (C, C++)</a><a class="headerlink" href="#unix-blockincriticalsection-c-c" title="Link to this heading">¶</a></h4>
<p>Check for calls to blocking functions inside a critical section.
Blocking functions detected by this checker: <code class="docutils literal notranslate"><span class="pre">sleep,</span> <span class="pre">getc,</span> <span class="pre">fgets,</span> <span class="pre">read,</span> <span class="pre">recv</span></code>.
Critical section handling functions modeled by this checker:
<code class="docutils literal notranslate"><span class="pre">lock,</span> <span class="pre">unlock,</span> <span class="pre">pthread_mutex_lock,</span> <span class="pre">pthread_mutex_trylock,</span> <span class="pre">pthread_mutex_unlock,</span> <span class="pre">mtx_lock,</span> <span class="pre">mtx_timedlock,</span> <span class="pre">mtx_trylock,</span> <span class="pre">mtx_unlock,</span> <span class="pre">lock_guard,</span> <span class="pre">unique_lock</span></code>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">pthread_lock_example</span><span class="p">(</span><span class="n">pthread_mutex_t</span><span class="w"> </span><span class="o">*</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">pthread_mutex_lock</span><span class="p">(</span><span class="n">m</span><span class="p">);</span><span class="w"> </span><span class="c1">// note: entering critical section here</span>
<span class="w">  </span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn: Call to blocking function &#39;sleep&#39; inside of critical section</span>
<span class="w">  </span><span class="n">pthread_mutex_unlock</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">overlapping_critical_sections</span><span class="p">(</span><span class="n">mtx_t</span><span class="w"> </span><span class="o">*</span><span class="n">m1</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">mutex</span><span class="w"> </span><span class="o">&amp;</span><span class="n">m2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">lock_guard</span><span class="w"> </span><span class="n">lg</span><span class="p">{</span><span class="n">m2</span><span class="p">};</span><span class="w"> </span><span class="c1">// note: entering critical section here</span>
<span class="w">  </span><span class="n">mtx_lock</span><span class="p">(</span><span class="n">m1</span><span class="p">);</span><span class="w"> </span><span class="c1">// note: entering critical section here</span>
<span class="w">  </span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn: Call to blocking function &#39;sleep&#39; inside of critical section</span>
<span class="w">  </span><span class="n">mtx_unlock</span><span class="p">(</span><span class="n">m1</span><span class="p">);</span>
<span class="w">  </span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn: Call to blocking function &#39;sleep&#39; inside of critical section</span>
<span class="w">             </span><span class="c1">// still inside of the critical section of the std::lock_guard</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Limitations</strong></p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">trylock</span></code> and <code class="docutils literal notranslate"><span class="pre">timedlock</span></code> versions of acquiring locks are currently assumed to always succeed.
This can lead to false positives.</p></li>
</ul>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">trylock_example</span><span class="p">(</span><span class="n">pthread_mutex_t</span><span class="w"> </span><span class="o">*</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pthread_mutex_trylock</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// assume trylock always succeeds</span>
<span class="w">    </span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn: Call to blocking function &#39;sleep&#39; inside of critical section</span>
<span class="w">    </span><span class="n">pthread_mutex_unlock</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span><span class="w"> </span><span class="c1">// false positive: Incorrect warning about blocking function inside critical section.</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="unix-chroot-c">
<span id="unix-chroot"></span><h4><a class="toc-backref" href="#id107" role="doc-backlink"><span class="section-number">1.1.8.3. </span>unix.Chroot (C)</a><a class="headerlink" href="#unix-chroot-c" title="Link to this heading">¶</a></h4>
<p>Check improper use of chroot described by SEI Cert C recommendation <a class="reference external" href="https://wiki.sei.cmu.edu/confluence/display/c/POS05-C.+Limit+access+to+files+by+creating+a+jail">POS05-C.
Limit access to files by creating a jail</a>.
The checker finds usage patterns where <code class="docutils literal notranslate"><span class="pre">chdir(&quot;/&quot;)</span></code> is not called immediately
after a call to <code class="docutils literal notranslate"><span class="pre">chroot(path)</span></code>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">f</span><span class="p">();</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test_bad</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">chroot</span><span class="p">(</span><span class="s">&quot;/usr/local&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">f</span><span class="p">();</span><span class="w"> </span><span class="c1">// warn: no call of chdir(&quot;/&quot;) immediately after chroot</span>
<span class="p">}</span>

<span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">test_bad_path</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">chroot</span><span class="p">(</span><span class="s">&quot;/usr/local&quot;</span><span class="p">);</span>
<span class="w">   </span><span class="n">chdir</span><span class="p">(</span><span class="s">&quot;/usr&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn: no call of chdir(&quot;/&quot;) immediately after chroot</span>
<span class="w">   </span><span class="n">f</span><span class="p">();</span>
<span class="w"> </span><span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test_good</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">chroot</span><span class="p">(</span><span class="s">&quot;/usr/local&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">chdir</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// no warning</span>
<span class="w">  </span><span class="n">f</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="unix-errno-c">
<span id="unix-errno"></span><h4><a class="toc-backref" href="#id108" role="doc-backlink"><span class="section-number">1.1.8.4. </span>unix.Errno (C)</a><a class="headerlink" href="#unix-errno-c" title="Link to this heading">¶</a></h4>
<p>Check for improper use of <code class="docutils literal notranslate"><span class="pre">errno</span></code>.
This checker implements partially CERT rule
<a class="reference external" href="https://wiki.sei.cmu.edu/confluence/pages/viewpage.action?pageId=87152351">ERR30-C. Set errno to zero before calling a library function known to set errno,
and check errno only after the function returns a value indicating failure</a>.
The checker can find the first read of <code class="docutils literal notranslate"><span class="pre">errno</span></code> after successful standard
function calls.</p>
<p>The C and POSIX standards often do not define if a standard library function
may change value of <code class="docutils literal notranslate"><span class="pre">errno</span></code> if the call does not fail.
Therefore, <code class="docutils literal notranslate"><span class="pre">errno</span></code> should only be used if it is known from the return value
of a function that the call has failed.
There are exceptions to this rule (for example <code class="docutils literal notranslate"><span class="pre">strtol</span></code>) but the affected
functions are not yet supported by the checker.
The return values for the failure cases are documented in the standard Linux man
pages of the functions and in the <a class="reference external" href="https://pubs.opengroup.org/onlinepubs/9699919799/">POSIX standard</a>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">unsafe_errno_read</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">sock</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">data_size</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">send</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">data_size</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">data_size</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// &#39;send&#39; can be successful even if not all data was sent</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">errno</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// An undefined value may be read from &#39;errno&#39;</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The checker <a class="reference internal" href="#unix-stdclibraryfunctions"><span class="std std-ref">unix.StdCLibraryFunctions (C)</span></a> must be turned on to get the
warnings from this checker. The supported functions are the same as by
<a class="reference internal" href="#unix-stdclibraryfunctions"><span class="std std-ref">unix.StdCLibraryFunctions (C)</span></a>. The <code class="docutils literal notranslate"><span class="pre">ModelPOSIX</span></code> option of that
checker affects the set of checked functions.</p>
<p><strong>Parameters</strong></p>
<p>The <code class="docutils literal notranslate"><span class="pre">AllowErrnoReadOutsideConditionExpressions</span></code> option allows read of the
errno value if the value is not used in a condition (in <code class="docutils literal notranslate"><span class="pre">if</span></code> statements,
loops, conditional expressions, <code class="docutils literal notranslate"><span class="pre">switch</span></code> statements). For example <code class="docutils literal notranslate"><span class="pre">errno</span></code>
can be stored into a variable without getting a warning by the checker.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">unsafe_errno_read</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">sock</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">data_size</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">send</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">data_size</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">data_size</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">errno</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// warning if &#39;AllowErrnoReadOutsideConditionExpressions&#39; is false</span>
<span class="w">    </span><span class="c1">// no warning if &#39;AllowErrnoReadOutsideConditionExpressions&#39; is true</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Default value of this option is <code class="docutils literal notranslate"><span class="pre">true</span></code>. This allows save of the errno value
for possible later error handling.</p>
<p><strong>Limitations</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>Only the very first usage of <code class="docutils literal notranslate"><span class="pre">errno</span></code> is checked after an affected function
call. Value of <code class="docutils literal notranslate"><span class="pre">errno</span></code> is not followed when it is stored into a variable
or returned from a function.</p></li>
<li><p>Documentation of function <code class="docutils literal notranslate"><span class="pre">lseek</span></code> is not clear about what happens if the
function returns different value than the expected file position but not -1.
To avoid possible false-positives <code class="docutils literal notranslate"><span class="pre">errno</span></code> is allowed to be used in this
case.</p></li>
</ul>
</div></blockquote>
</section>
<section id="unix-malloc-c">
<span id="unix-malloc"></span><h4><a class="toc-backref" href="#id109" role="doc-backlink"><span class="section-number">1.1.8.5. </span>unix.Malloc (C)</a><a class="headerlink" href="#unix-malloc-c" title="Link to this heading">¶</a></h4>
<p>Check for memory leaks, double free, and use-after-free problems. Traces memory managed by malloc()/free().</p>
<p>Custom allocation/deallocation functions can be defined using
<a class="reference internal" href="../AttributeReference.html#analyzer-ownership-attrs"><span class="std std-ref">ownership attributes</span></a>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span>
<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="n">free</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="n">free</span><span class="p">(</span><span class="n">p</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn: attempt to free released memory</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
<span class="w">  </span><span class="n">free</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn: use after free</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn: memory is never released</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">};</span>
<span class="w">  </span><span class="n">free</span><span class="p">(</span><span class="n">a</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn: argument is not allocated by malloc</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">));</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">  </span><span class="n">free</span><span class="p">(</span><span class="n">p</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn: argument to free() is offset by -4 bytes</span>
<span class="p">}</span>

</pre></div>
</div>
</section>
<section id="unix-mallocsizeof-c">
<span id="unix-mallocsizeof"></span><h4><a class="toc-backref" href="#id110" role="doc-backlink"><span class="section-number">1.1.8.6. </span>unix.MallocSizeof (C)</a><a class="headerlink" href="#unix-mallocsizeof-c" title="Link to this heading">¶</a></h4>
<p>Check for dubious <code class="docutils literal notranslate"><span class="pre">malloc</span></code> arguments involving <code class="docutils literal notranslate"><span class="pre">sizeof</span></code>.</p>
<p>Custom allocation/deallocation functions can be defined using
<a class="reference internal" href="../AttributeReference.html#analyzer-ownership-attrs"><span class="std std-ref">ownership attributes</span></a>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">long</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">short</span><span class="p">));</span>
<span class="w">    </span><span class="c1">// warn: result is converted to &#39;long *&#39;, which is</span>
<span class="w">    </span><span class="c1">// incompatible with operand type &#39;short&#39;</span>
<span class="w">  </span><span class="n">free</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="unix-mismatcheddeallocator-c-c">
<span id="unix-mismatcheddeallocator"></span><h4><a class="toc-backref" href="#id111" role="doc-backlink"><span class="section-number">1.1.8.7. </span>unix.MismatchedDeallocator (C, C++)</a><a class="headerlink" href="#unix-mismatcheddeallocator-c-c" title="Link to this heading">¶</a></h4>
<p>Check for mismatched deallocators.</p>
<p>Custom allocation/deallocation functions can be defined using
<a class="reference internal" href="../AttributeReference.html#analyzer-ownership-attrs"><span class="std std-ref">ownership attributes</span></a>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">// C, C++</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
<span class="w">  </span><span class="n">delete</span><span class="w"> </span><span class="n">p</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>

<span class="c1">// C, C++</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">__attribute</span><span class="p">((</span><span class="n">ownership_returns</span><span class="p">(</span><span class="n">malloc</span><span class="p">)))</span><span class="w"> </span><span class="o">*</span><span class="n">user_malloc</span><span class="p">(</span><span class="kt">size_t</span><span class="p">);</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">__attribute</span><span class="p">((</span><span class="n">ownership_takes</span><span class="p">(</span><span class="n">malloc</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)))</span><span class="w"> </span><span class="o">*</span><span class="n">user_free</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="p">);</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">__attribute</span><span class="p">((</span><span class="n">ownership_returns</span><span class="p">(</span><span class="n">malloc1</span><span class="p">)))</span><span class="w"> </span><span class="o">*</span><span class="n">user_malloc1</span><span class="p">(</span><span class="kt">size_t</span><span class="p">);</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">__attribute</span><span class="p">((</span><span class="n">ownership_takes</span><span class="p">(</span><span class="n">malloc1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)))</span><span class="w"> </span><span class="o">*</span><span class="n">user_free1</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="p">);</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">user_malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
<span class="w">  </span><span class="n">delete</span><span class="w"> </span><span class="n">p</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>

<span class="c1">// C, C++</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="kt">int</span><span class="p">;</span>
<span class="w">  </span><span class="n">free</span><span class="p">(</span><span class="n">p</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>

<span class="c1">// C, C++</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="kt">int</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
<span class="w">  </span><span class="n">realloc</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">long</span><span class="p">));</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>

<span class="c1">// C, C++</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">user_malloc</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="w">  </span><span class="n">user_free1</span><span class="p">(</span><span class="n">p</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>

<span class="c1">// C, C++</span>
<span class="n">template</span><span class="w"> </span><span class="o">&lt;</span><span class="n">typename</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span>
<span class="k">struct</span><span class="w"> </span><span class="nc">SimpleSmartPointer</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">ptr</span><span class="p">;</span>

<span class="w">  </span><span class="n">explicit</span><span class="w"> </span><span class="nf">SimpleSmartPointer</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">ptr</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>
<span class="w">  </span><span class="o">~</span><span class="n">SimpleSmartPointer</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">delete</span><span class="w"> </span><span class="n">ptr</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">};</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">SimpleSmartPointer</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">a</span><span class="p">((</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="mi">4</span><span class="p">));</span>
<span class="p">}</span>

<span class="c1">// C++</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">operator</span><span class="w"> </span><span class="n">new</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">  </span><span class="n">delete</span><span class="p">[]</span><span class="w"> </span><span class="n">p</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>

<span class="c1">// Objective-C, C++</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">(</span><span class="n">NSUInteger</span><span class="w"> </span><span class="n">dataLength</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="kt">int</span><span class="p">;</span>
<span class="w">  </span><span class="n">NSData</span><span class="w"> </span><span class="o">*</span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">NSData</span><span class="w"> </span><span class="n">dataWithBytesNoCopy</span><span class="o">:</span><span class="n">p</span>
<span class="w">               </span><span class="nl">length</span><span class="p">:</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="n">freeWhenDone</span><span class="o">:</span><span class="mi">1</span><span class="p">];</span>
<span class="w">    </span><span class="c1">// warn +dataWithBytesNoCopy:length:freeWhenDone: cannot take</span>
<span class="w">    </span><span class="c1">// ownership of memory allocated by &#39;new&#39;</span>
<span class="p">}</span>

</pre></div>
</div>
</section>
<section id="unix-vfork-c">
<span id="unix-vfork"></span><h4><a class="toc-backref" href="#id112" role="doc-backlink"><span class="section-number">1.1.8.8. </span>unix.Vfork (C)</a><a class="headerlink" href="#unix-vfork-c" title="Link to this heading">¶</a></h4>
<p>Check for proper usage of <code class="docutils literal notranslate"><span class="pre">vfork</span></code>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">test</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">pid_t</span><span class="w"> </span><span class="n">pid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vfork</span><span class="p">();</span><span class="w"> </span><span class="c1">// warn</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pid</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">  </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>
<span class="w">    </span><span class="n">pid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="n">execl</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">_exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="k">break</span><span class="p">;</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn: this assignment is prohibited</span>
<span class="w">    </span><span class="k">break</span><span class="p">;</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span>
<span class="w">    </span><span class="n">foo</span><span class="p">();</span><span class="w"> </span><span class="c1">// warn: this function call is prohibited</span>
<span class="w">    </span><span class="k">break</span><span class="p">;</span>
<span class="w">  </span><span class="k">default</span><span class="o">:</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn: return is prohibited</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="unix-cstring-badsizearg-c">
<span id="unix-cstring-badsizearg"></span><h4><a class="toc-backref" href="#id113" role="doc-backlink"><span class="section-number">1.1.8.9. </span>unix.cstring.BadSizeArg (C)</a><a class="headerlink" href="#unix-cstring-badsizearg-c" title="Link to this heading">¶</a></h4>
<p>Check the size argument passed into C string functions for common erroneous patterns. Use <code class="docutils literal notranslate"><span class="pre">-Wno-strncat-size</span></code> compiler option to mute other <code class="docutils literal notranslate"><span class="pre">strncat</span></code>-related compiler warnings.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">dest</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<span class="w">  </span><span class="n">strncat</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;*&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">dest</span><span class="p">));</span>
<span class="w">    </span><span class="c1">// warn: potential buffer overflow</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="unix-cstring-notnullterminated-c">
<span id="unix-cstring-notnullterminated"></span><h4><a class="toc-backref" href="#id114" role="doc-backlink"><span class="section-number">1.1.8.10. </span>unix.cstring.NotNullTerminated (C)</a><a class="headerlink" href="#unix-cstring-notnullterminated-c" title="Link to this heading">¶</a></h4>
<p>Check for arguments which are not null-terminated strings;
applies to the <code class="docutils literal notranslate"><span class="pre">strlen</span></code>, <code class="docutils literal notranslate"><span class="pre">strcpy</span></code>, <code class="docutils literal notranslate"><span class="pre">strcat</span></code>, <code class="docutils literal notranslate"><span class="pre">strcmp</span></code> family of functions.</p>
<p>Only very fundamental cases are detected where the passed memory block is
absolutely different from a null-terminated string. This checker does not
find if a memory buffer is passed where the terminating zero character
is missing.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test1</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strlen</span><span class="p">((</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">test1</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test2</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="nl">label</span><span class="p">:</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strlen</span><span class="p">((</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="n">label</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="unix-cstring-nullarg-c">
<span id="unix-cstring-nullarg"></span><h4><a class="toc-backref" href="#id115" role="doc-backlink"><span class="section-number">1.1.8.11. </span>unix.cstring.NullArg (C)</a><a class="headerlink" href="#unix-cstring-nullarg-c" title="Link to this heading">¶</a></h4>
<p>Check for null pointers being passed as arguments to C string functions:
<code class="docutils literal notranslate"><span class="pre">strlen,</span> <span class="pre">strnlen,</span> <span class="pre">strcpy,</span> <span class="pre">strncpy,</span> <span class="pre">strcat,</span> <span class="pre">strncat,</span> <span class="pre">strcmp,</span> <span class="pre">strncmp,</span> <span class="pre">strcasecmp,</span> <span class="pre">strncasecmp,</span> <span class="pre">wcslen,</span> <span class="pre">wcsnlen</span></code>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">strlen</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="unix-stdclibraryfunctions-c">
<span id="unix-stdclibraryfunctions"></span><h4><a class="toc-backref" href="#id116" role="doc-backlink"><span class="section-number">1.1.8.12. </span>unix.StdCLibraryFunctions (C)</a><a class="headerlink" href="#unix-stdclibraryfunctions-c" title="Link to this heading">¶</a></h4>
<p>Check for calls of standard library functions that violate predefined argument
constraints. For example, according to the C standard the behavior of function
<code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">isalnum(int</span> <span class="pre">ch)</span></code> is undefined if the value of <code class="docutils literal notranslate"><span class="pre">ch</span></code> is not representable
as <code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">char</span></code> and is not equal to <code class="docutils literal notranslate"><span class="pre">EOF</span></code>.</p>
<p>You can think of this checker as defining restrictions (pre- and postconditions)
on standard library functions. Preconditions are checked, and when they are
violated, a warning is emitted. Postconditions are added to the analysis, e.g.
that the return value of a function is not greater than 255. Preconditions are
added to the analysis too, in the case when the affected values are not known
before the call.</p>
<p>For example, if an argument to a function must be in between 0 and 255, but the
value of the argument is unknown, the analyzer will assume that it is in this
interval. Similarly, if a function mustn’t be called with a null pointer and the
analyzer cannot prove that it is null, then it will assume that it is non-null.</p>
<dl class="simple">
<dt>These are the possible checks on the values passed as function arguments:</dt><dd><ul class="simple">
<li><p>The argument has an allowed range (or multiple ranges) of values. The checker
can detect if a passed value is outside of the allowed range and show the
actual and allowed values.</p></li>
<li><p>The argument has pointer type and is not allowed to be null pointer. Many
(but not all) standard functions can produce undefined behavior if a null
pointer is passed, these cases can be detected by the checker.</p></li>
<li><p>The argument is a pointer to a memory block and the minimal size of this
buffer is determined by another argument to the function, or by
multiplication of two arguments (like at function <code class="docutils literal notranslate"><span class="pre">fread</span></code>), or is a fixed
value (for example <code class="docutils literal notranslate"><span class="pre">asctime_r</span></code> requires at least a buffer of size 26). The
checker can detect if the buffer size is too small and in optimal case show
the size of the buffer and the values of the corresponding arguments.</p></li>
</ul>
</dd>
</dl>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#define EOF -1</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">test_alnum_concrete</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isalnum</span><span class="p">(</span><span class="mi">256</span><span class="p">);</span><span class="w"> </span><span class="c1">// \</span>
<span class="c1">  // warning: Function argument outside of allowed range</span>
<span class="w">  </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">buffer_size_violation</span><span class="p">(</span><span class="kt">FILE</span><span class="w"> </span><span class="o">*</span><span class="n">file</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">enum</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">BUFFER_SIZE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="p">};</span>
<span class="w">  </span><span class="kt">wchar_t</span><span class="w"> </span><span class="n">wbuf</span><span class="p">[</span><span class="n">BUFFER_SIZE</span><span class="p">];</span>

<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">wbuf</span><span class="p">);</span><span class="w">   </span><span class="c1">// 4</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">nitems</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">wbuf</span><span class="p">);</span><span class="w">  </span><span class="c1">// 4096</span>

<span class="w">  </span><span class="c1">// Below we receive a warning because the 3rd parameter should be the</span>
<span class="w">  </span><span class="c1">// number of elements to read, not the size in bytes. This case is a known</span>
<span class="w">  </span><span class="c1">// vulnerability described by the ARR38-C SEI-CERT rule.</span>
<span class="w">  </span><span class="n">fread</span><span class="p">(</span><span class="n">wbuf</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">nitems</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">test_alnum_symbolic</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isalnum</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
<span class="w">  </span><span class="c1">// after the call, ret is assumed to be in the range [-1, 255]</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">255</span><span class="p">)</span><span class="w">      </span><span class="c1">// impossible (infeasible branch)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">x</span><span class="p">;</span><span class="w"> </span><span class="c1">// division by zero is not reported</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Additionally to the argument and return value conditions, this checker also adds
state of the value <code class="docutils literal notranslate"><span class="pre">errno</span></code> if applicable to the analysis. Many system
functions set the <code class="docutils literal notranslate"><span class="pre">errno</span></code> value only if an error occurs (together with a
specific return value of the function), otherwise it becomes undefined. This
checker changes the analysis state to contain such information. This data is
used by other checkers, for example <a class="reference internal" href="#unix-errno"><span class="std std-ref">unix.Errno (C)</span></a>.</p>
<p><strong>Limitations</strong></p>
<p>The checker can not always provide notes about the values of the arguments.
Without this information it is hard to confirm if the constraint is indeed
violated. The argument values are shown if they are known constants or the value
is determined by previous (not too complicated) assumptions.</p>
<p>The checker can produce false positives in cases such as if the program has
invariants not known to the analyzer engine or the bug report path contains
calls to unknown functions. In these cases the analyzer fails to detect the real
range of the argument.</p>
<p><strong>Parameters</strong></p>
<p>The <code class="docutils literal notranslate"><span class="pre">ModelPOSIX</span></code> option controls if functions from the POSIX standard are
recognized by the checker.</p>
<p>With <code class="docutils literal notranslate"><span class="pre">ModelPOSIX=true</span></code>, many POSIX functions are modeled according to the
<a class="reference external" href="https://pubs.opengroup.org/onlinepubs/9699919799/">POSIX standard</a>. This includes ranges of parameters and possible return
values. Furthermore the behavior related to <code class="docutils literal notranslate"><span class="pre">errno</span></code> in the POSIX case is
often that <code class="docutils literal notranslate"><span class="pre">errno</span></code> is set only if a function call fails, and it becomes
undefined after a successful function call.</p>
<p>With <code class="docutils literal notranslate"><span class="pre">ModelPOSIX=false</span></code>, this checker follows the C99 language standard and
only models the functions that are described there. It is possible that the
same functions are modeled differently in the two cases because differences in
the standards. The C standard specifies less aspects of the functions, for
example exact <code class="docutils literal notranslate"><span class="pre">errno</span></code> behavior is often unspecified (and not modeled by the
checker).</p>
<p>Default value of the option is <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
</section>
<section id="unix-stream-c">
<span id="unix-stream"></span><h4><a class="toc-backref" href="#id117" role="doc-backlink"><span class="section-number">1.1.8.13. </span>unix.Stream (C)</a><a class="headerlink" href="#unix-stream-c" title="Link to this heading">¶</a></h4>
<p>Check C stream handling functions:
<code class="docutils literal notranslate"><span class="pre">fopen,</span> <span class="pre">fdopen,</span> <span class="pre">freopen,</span> <span class="pre">tmpfile,</span> <span class="pre">fclose,</span> <span class="pre">fread,</span> <span class="pre">fwrite,</span> <span class="pre">fgetc,</span> <span class="pre">fgets,</span> <span class="pre">fputc,</span> <span class="pre">fputs,</span> <span class="pre">fprintf,</span> <span class="pre">fscanf,</span> <span class="pre">ungetc,</span> <span class="pre">getdelim,</span> <span class="pre">getline,</span> <span class="pre">fseek,</span> <span class="pre">fseeko,</span> <span class="pre">ftell,</span> <span class="pre">ftello,</span> <span class="pre">fflush,</span> <span class="pre">rewind,</span> <span class="pre">fgetpos,</span> <span class="pre">fsetpos,</span> <span class="pre">clearerr,</span> <span class="pre">feof,</span> <span class="pre">ferror,</span> <span class="pre">fileno</span></code>.</p>
<p>The checker maintains information about the C stream objects (<code class="docutils literal notranslate"><span class="pre">FILE</span> <span class="pre">*</span></code>) and
can detect error conditions related to use of streams. The following conditions
are detected:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">FILE</span> <span class="pre">*</span></code> pointer passed to the function is NULL (the single exception is
<code class="docutils literal notranslate"><span class="pre">fflush</span></code> where NULL is allowed).</p></li>
<li><p>Use of stream after close.</p></li>
<li><p>Opened stream is not closed.</p></li>
<li><p>Read from a stream after end-of-file. (This is not a fatal error but reported
by the checker. Stream remains in EOF state and the read operation fails.)</p></li>
<li><p>Use of stream when the file position is indeterminate after a previous failed
operation. Some functions (like <code class="docutils literal notranslate"><span class="pre">ferror</span></code>, <code class="docutils literal notranslate"><span class="pre">clearerr</span></code>, <code class="docutils literal notranslate"><span class="pre">fseek</span></code>) are
allowed in this state.</p></li>
<li><p>Invalid 3rd (”<code class="docutils literal notranslate"><span class="pre">whence</span></code>”) argument to <code class="docutils literal notranslate"><span class="pre">fseek</span></code>.</p></li>
</ul>
<p>The stream operations are by this checker usually split into two cases, a success
and a failure case.
On the success case it also assumes that the current value of <code class="docutils literal notranslate"><span class="pre">stdout</span></code>,
<code class="docutils literal notranslate"><span class="pre">stderr</span></code>, or <code class="docutils literal notranslate"><span class="pre">stdin</span></code> can’t be equal to the file pointer returned by <code class="docutils literal notranslate"><span class="pre">fopen</span></code>.
Operations performed on <code class="docutils literal notranslate"><span class="pre">stdout</span></code>, <code class="docutils literal notranslate"><span class="pre">stderr</span></code>, or <code class="docutils literal notranslate"><span class="pre">stdin</span></code> are not checked by
this checker in contrast to the streams opened by <code class="docutils literal notranslate"><span class="pre">fopen</span></code>.</p>
<p>In the case of write operations (like <code class="docutils literal notranslate"><span class="pre">fwrite</span></code>,
<code class="docutils literal notranslate"><span class="pre">fprintf</span></code> and even <code class="docutils literal notranslate"><span class="pre">fsetpos</span></code>) this behavior could produce a large amount of
unwanted reports on projects that don’t have error checks around the write
operations, so by default the checker assumes that write operations always succeed.
This behavior can be controlled by the <code class="docutils literal notranslate"><span class="pre">Pedantic</span></code> flag: With
<code class="docutils literal notranslate"><span class="pre">-analyzer-config</span> <span class="pre">unix.Stream:Pedantic=true</span></code> the checker will model the
cases where a write operation fails and report situations where this leads to
erroneous behavior. (The default is <code class="docutils literal notranslate"><span class="pre">Pedantic=false</span></code>, where write operations
are assumed to succeed.)</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test1</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">FILE</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fopen</span><span class="p">(</span><span class="s">&quot;foo&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;r&quot;</span><span class="p">);</span>
<span class="p">}</span><span class="w"> </span><span class="c1">// warn: opened file is never closed</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test2</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">FILE</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fopen</span><span class="p">(</span><span class="s">&quot;foo&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;r&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">fseek</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">SEEK_SET</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn: stream pointer might be NULL</span>
<span class="w">  </span><span class="n">fclose</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test3</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">FILE</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fopen</span><span class="p">(</span><span class="s">&quot;foo&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;r&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">fseek</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn: third arg should be SEEK_SET, SEEK_END, or SEEK_CUR</span>
<span class="w">    </span><span class="n">fclose</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test4</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">FILE</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fopen</span><span class="p">(</span><span class="s">&quot;foo&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;r&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">p</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span>

<span class="w">  </span><span class="n">fclose</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="n">fclose</span><span class="p">(</span><span class="n">p</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn: stream already closed</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test5</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">FILE</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fopen</span><span class="p">(</span><span class="s">&quot;foo&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;r&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">p</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span>

<span class="w">  </span><span class="n">fgetc</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">ferror</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
<span class="w">    </span><span class="n">fgetc</span><span class="p">(</span><span class="n">p</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn: possible read after end-of-file</span>

<span class="w">  </span><span class="n">fclose</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test6</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">FILE</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fopen</span><span class="p">(</span><span class="s">&quot;foo&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;r&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">p</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span>

<span class="w">  </span><span class="n">fgetc</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">feof</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
<span class="w">    </span><span class="n">fgetc</span><span class="p">(</span><span class="n">p</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn: file position may be indeterminate after I/O error</span>

<span class="w">  </span><span class="n">fclose</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Limitations</strong></p>
<p>The checker does not track the correspondence between integer file descriptors
and <code class="docutils literal notranslate"><span class="pre">FILE</span> <span class="pre">*</span></code> pointers.</p>
</section>
</section>
<section id="osx">
<span id="osx-checkers"></span><h3><a class="toc-backref" href="#id118" role="doc-backlink"><span class="section-number">1.1.9. </span>osx</a><a class="headerlink" href="#osx" title="Link to this heading">¶</a></h3>
<p>macOS checkers.</p>
<section id="osx-api-c">
<span id="osx-api"></span><h4><a class="toc-backref" href="#id119" role="doc-backlink"><span class="section-number">1.1.9.1. </span>osx.API (C)</a><a class="headerlink" href="#osx-api-c" title="Link to this heading">¶</a></h4>
<p>Check for proper uses of various Apple APIs.</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">dispatch_once_t</span><span class="w"> </span><span class="n">pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">dispatch_once</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pred</span><span class="p">,</span><span class="w"> </span><span class="o">^</span><span class="p">(){});</span><span class="w"> </span><span class="c1">// warn: dispatch_once uses local</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="osx-numberobjectconversion-c-c-objc">
<span id="osx-numberobjectconversion"></span><h4><a class="toc-backref" href="#id120" role="doc-backlink"><span class="section-number">1.1.9.2. </span>osx.NumberObjectConversion (C, C++, ObjC)</a><a class="headerlink" href="#osx-numberobjectconversion-c-c-objc" title="Link to this heading">¶</a></h4>
<p>Check for erroneous conversions of objects representing numbers into numbers.</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="bp">NSNumber</span><span class="w"> </span><span class="o">*</span><span class="n">photoCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">albumDescriptor</span><span class="w"> </span><span class="n">objectForKey</span><span class="o">:</span><span class="s">@&quot;PhotoCount&quot;</span><span class="p">];</span>
<span class="c1">// Warning: Comparing a pointer value of type &#39;NSNumber *&#39;</span>
<span class="c1">// to a scalar integer value</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">photoCount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">displayPhotos</span><span class="p">];</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="osx-objcproperty-objc">
<span id="osx-objcproperty"></span><h4><a class="toc-backref" href="#id121" role="doc-backlink"><span class="section-number">1.1.9.3. </span>osx.ObjCProperty (ObjC)</a><a class="headerlink" href="#osx-objcproperty-objc" title="Link to this heading">¶</a></h4>
<p>Check for proper uses of Objective-C properties.</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="bp">NSNumber</span><span class="w"> </span><span class="o">*</span><span class="n">photoCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">albumDescriptor</span><span class="w"> </span><span class="n">objectForKey</span><span class="o">:</span><span class="s">@&quot;PhotoCount&quot;</span><span class="p">];</span>
<span class="c1">// Warning: Comparing a pointer value of type &#39;NSNumber *&#39;</span>
<span class="c1">// to a scalar integer value</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">photoCount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="p">[</span><span class="nb">self</span><span class="w"> </span><span class="n">displayPhotos</span><span class="p">];</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="osx-seckeychainapi-c">
<span id="osx-seckeychainapi"></span><h4><a class="toc-backref" href="#id122" role="doc-backlink"><span class="section-number">1.1.9.4. </span>osx.SecKeychainAPI (C)</a><a class="headerlink" href="#osx-seckeychainapi-c" title="Link to this heading">¶</a></h4>
<p>Check for proper uses of Secure Keychain APIs.</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="kt">UInt32</span><span class="w"> </span><span class="n">length</span><span class="p">;</span>

<span class="w">  </span><span class="n">SecKeychainItemFreeContent</span><span class="p">(</span><span class="n">ptr</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">length</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// warn: trying to free data which has not been allocated</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="kt">UInt32</span><span class="w"> </span><span class="o">*</span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">outData</span><span class="p">;</span>

<span class="w">  </span><span class="n">OSStatus</span><span class="w"> </span><span class="n">st</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="n">SecKeychainItemCopyContent</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">ptr</span><span class="p">,</span><span class="w"> </span><span class="n">ptr</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"> </span><span class="n">outData</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// warn: data is not released</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="kt">UInt32</span><span class="w"> </span><span class="o">*</span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">outData</span><span class="p">;</span>

<span class="w">  </span><span class="n">OSStatus</span><span class="w"> </span><span class="n">st</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="n">SecKeychainItemCopyContent</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">ptr</span><span class="p">,</span><span class="w"> </span><span class="n">ptr</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">outData</span><span class="p">);</span>

<span class="w">  </span><span class="n">SecKeychainItemFreeContent</span><span class="p">(</span><span class="n">ptr</span><span class="p">,</span><span class="w"> </span><span class="n">outData</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// warn: only call free if a non-NULL buffer was returned</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="kt">UInt32</span><span class="w"> </span><span class="o">*</span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">outData</span><span class="p">;</span>

<span class="w">  </span><span class="n">OSStatus</span><span class="w"> </span><span class="n">st</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="n">SecKeychainItemCopyContent</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">ptr</span><span class="p">,</span><span class="w"> </span><span class="n">ptr</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">outData</span><span class="p">);</span>

<span class="w">  </span><span class="n">st</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SecKeychainItemCopyContent</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">ptr</span><span class="p">,</span><span class="w"> </span><span class="n">ptr</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">outData</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// warn: release data before another call to the allocator</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">st</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">noErr</span><span class="p">)</span>
<span class="w">    </span><span class="n">SecKeychainItemFreeContent</span><span class="p">(</span><span class="n">ptr</span><span class="p">,</span><span class="w"> </span><span class="n">outData</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">SecKeychainItemRef</span><span class="w"> </span><span class="n">itemRef</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="bp">SecKeychainAttributeInfo</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">SecItemClass</span><span class="w"> </span><span class="o">*</span><span class="n">itemClass</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="bp">SecKeychainAttributeList</span><span class="w"> </span><span class="o">*</span><span class="n">attrList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="kt">UInt32</span><span class="w"> </span><span class="o">*</span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">outData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">  </span><span class="n">OSStatus</span><span class="w"> </span><span class="n">st</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="n">SecKeychainItemCopyAttributesAndData</span><span class="p">(</span><span class="n">itemRef</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="p">,</span>
<span class="w">                                         </span><span class="n">itemClass</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">attrList</span><span class="p">,</span>
<span class="w">                                         </span><span class="n">length</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">outData</span><span class="p">);</span>

<span class="w">  </span><span class="n">SecKeychainItemFreeContent</span><span class="p">(</span><span class="n">attrList</span><span class="p">,</span><span class="w"> </span><span class="n">outData</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// warn: deallocator doesn&#39;t match the allocator</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="osx-cocoa-atsync-objc">
<span id="osx-cocoa-atsync"></span><h4><a class="toc-backref" href="#id123" role="doc-backlink"><span class="section-number">1.1.9.5. </span>osx.cocoa.AtSync (ObjC)</a><a class="headerlink" href="#osx-cocoa-atsync-objc" title="Link to this heading">¶</a></h4>
<p>Check for nil pointers used as mutexes for &#64;synchronized.</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">(</span><span class="kt">id</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="k">@synchronized</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="c1">// warn: nil value used as mutex</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">id</span><span class="w"> </span><span class="n">y</span><span class="p">;</span>
<span class="w">  </span><span class="k">@synchronized</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="c1">// warn: uninitialized value used as mutex</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="osx-cocoa-autoreleasewrite">
<span id="id5"></span><h4><a class="toc-backref" href="#id124" role="doc-backlink"><span class="section-number">1.1.9.6. </span>osx.cocoa.AutoreleaseWrite</a><a class="headerlink" href="#osx-cocoa-autoreleasewrite" title="Link to this heading">¶</a></h4>
<p>Warn about potentially crashing writes to autoreleasing objects from different autoreleasing pools in Objective-C.</p>
</section>
<section id="osx-cocoa-classrelease-objc">
<span id="osx-cocoa-classrelease"></span><h4><a class="toc-backref" href="#id125" role="doc-backlink"><span class="section-number">1.1.9.7. </span>osx.cocoa.ClassRelease (ObjC)</a><a class="headerlink" href="#osx-cocoa-classrelease-objc" title="Link to this heading">¶</a></h4>
<p>Check for sending ‘retain’, ‘release’, or ‘autorelease’ directly to a Class.</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="k">@interface</span> <span class="bp">MyClass</span> : <span class="bp">NSObject</span>
<span class="k">@end</span>

<span class="kt">void</span><span class="w"> </span><span class="n">test</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="p">[</span><span class="bp">MyClass</span><span class="w"> </span><span class="k">release</span><span class="p">];</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="osx-cocoa-dealloc-objc">
<span id="osx-cocoa-dealloc"></span><h4><a class="toc-backref" href="#id126" role="doc-backlink"><span class="section-number">1.1.9.8. </span>osx.cocoa.Dealloc (ObjC)</a><a class="headerlink" href="#osx-cocoa-dealloc-objc" title="Link to this heading">¶</a></h4>
<p>Warn about Objective-C classes that lack a correct implementation of -dealloc</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="k">@interface</span> <span class="nc">MyObject</span> : <span class="bp">NSObject</span> <span class="p">{</span>
<span class="w">  </span><span class="kt">id</span><span class="w"> </span><span class="n">_myproperty</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">MyObject</span><span class="w"> </span><span class="c1">// warn: lacks &#39;dealloc&#39;</span>
<span class="k">@end</span>

<span class="k">@interface</span> <span class="nc">MyObject</span> : <span class="bp">NSObject</span> <span class="p">{}</span>
<span class="k">@property</span><span class="p">(</span><span class="k">assign</span><span class="p">)</span><span class="w"> </span><span class="kt">id</span><span class="w"> </span><span class="n">myproperty</span><span class="p">;</span>
<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">MyObject</span><span class="w"> </span><span class="c1">// warn: does not send &#39;dealloc&#39; to super</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">dealloc</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nb">self</span><span class="p">.</span><span class="n">myproperty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">@end</span>

<span class="k">@interface</span> <span class="nc">MyObject</span> : <span class="bp">NSObject</span> <span class="p">{</span>
<span class="w">  </span><span class="kt">id</span><span class="w"> </span><span class="n">_myproperty</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">@property</span><span class="p">(</span><span class="k">retain</span><span class="p">)</span><span class="w"> </span><span class="kt">id</span><span class="w"> </span><span class="n">myproperty</span><span class="p">;</span>
<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">MyObject</span>
<span class="k">@synthesize</span><span class="w"> </span><span class="n">myproperty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_myproperty</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// warn: var was retained but wasn&#39;t released</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">dealloc</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="p">[</span><span class="nb">super</span><span class="w"> </span><span class="n">dealloc</span><span class="p">];</span>
<span class="p">}</span>
<span class="k">@end</span>

<span class="k">@interface</span> <span class="nc">MyObject</span> : <span class="bp">NSObject</span> <span class="p">{</span>
<span class="w">  </span><span class="kt">id</span><span class="w"> </span><span class="n">_myproperty</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">@property</span><span class="p">(</span><span class="k">assign</span><span class="p">)</span><span class="w"> </span><span class="kt">id</span><span class="w"> </span><span class="n">myproperty</span><span class="p">;</span>
<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">MyObject</span>
<span class="k">@synthesize</span><span class="w"> </span><span class="n">myproperty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_myproperty</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// warn: var wasn&#39;t retained but was released</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">dealloc</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="p">[</span><span class="n">_myproperty</span><span class="w"> </span><span class="k">release</span><span class="p">];</span>
<span class="w">  </span><span class="p">[</span><span class="nb">super</span><span class="w"> </span><span class="n">dealloc</span><span class="p">];</span>
<span class="p">}</span>
<span class="k">@end</span>
</pre></div>
</div>
</section>
<section id="osx-cocoa-incompatiblemethodtypes-objc">
<span id="osx-cocoa-incompatiblemethodtypes"></span><h4><a class="toc-backref" href="#id127" role="doc-backlink"><span class="section-number">1.1.9.9. </span>osx.cocoa.IncompatibleMethodTypes (ObjC)</a><a class="headerlink" href="#osx-cocoa-incompatiblemethodtypes-objc" title="Link to this heading">¶</a></h4>
<p>Warn about Objective-C method signatures with type incompatibilities.</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="k">@interface</span> <span class="nc">MyClass1</span> : <span class="bp">NSObject</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="nf">foo</span><span class="p">;</span>
<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">MyClass1</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="nf">foo</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="k">@end</span>

<span class="k">@interface</span> <span class="nc">MyClass2</span> : <span class="nc">MyClass1</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="nf">foo</span><span class="p">;</span>
<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">MyClass2</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="nf">foo</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="c1">// warn</span>
<span class="k">@end</span>
</pre></div>
</div>
</section>
<section id="osx-cocoa-loops">
<span id="id6"></span><h4><a class="toc-backref" href="#id128" role="doc-backlink"><span class="section-number">1.1.9.10. </span>osx.cocoa.Loops</a><a class="headerlink" href="#osx-cocoa-loops" title="Link to this heading">¶</a></h4>
<p>Improved modeling of loops using Cocoa collection types.</p>
</section>
<section id="osx-cocoa-missingsupercall-objc">
<span id="osx-cocoa-missingsupercall"></span><h4><a class="toc-backref" href="#id129" role="doc-backlink"><span class="section-number">1.1.9.11. </span>osx.cocoa.MissingSuperCall (ObjC)</a><a class="headerlink" href="#osx-cocoa-missingsupercall-objc" title="Link to this heading">¶</a></h4>
<p>Warn about Objective-C methods that lack a necessary call to super.</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="k">@interface</span> <span class="nc">Test</span> : <span class="bp">UIViewController</span>
<span class="k">@end</span>
<span class="k">@implementation</span> <span class="nc">test</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">viewDidLoad</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="c1">// warn</span>
<span class="k">@end</span>
</pre></div>
</div>
</section>
<section id="osx-cocoa-nsautoreleasepool-objc">
<span id="osx-cocoa-nsautoreleasepool"></span><h4><a class="toc-backref" href="#id130" role="doc-backlink"><span class="section-number">1.1.9.12. </span>osx.cocoa.NSAutoreleasePool (ObjC)</a><a class="headerlink" href="#osx-cocoa-nsautoreleasepool-objc" title="Link to this heading">¶</a></h4>
<p>Warn for suboptimal uses of NSAutoreleasePool in Objective-C GC mode.</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="bp">NSAutoreleasePool</span><span class="w"> </span><span class="o">*</span><span class="n">pool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="bp">NSAutoreleasePool</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">init</span><span class="p">];</span>
<span class="w">  </span><span class="p">[</span><span class="n">pool</span><span class="w"> </span><span class="k">release</span><span class="p">];</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="osx-cocoa-nserror-objc">
<span id="osx-cocoa-nserror"></span><h4><a class="toc-backref" href="#id131" role="doc-backlink"><span class="section-number">1.1.9.13. </span>osx.cocoa.NSError (ObjC)</a><a class="headerlink" href="#osx-cocoa-nserror-objc" title="Link to this heading">¶</a></h4>
<p>Check usage of NSError parameters.</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="k">@interface</span> <span class="nc">A</span> : <span class="bp">NSObject</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">foo:</span><span class="p">(</span><span class="bp">NSError</span><span class="w"> </span><span class="s">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</span><span class="p">)</span><span class="nv">error</span><span class="p">;</span>
<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">A</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">foo:</span><span class="p">(</span><span class="bp">NSError</span><span class="w"> </span><span class="s">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</span><span class="p">)</span><span class="nv">error</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// warn: method accepting NSError&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot; should have a non-void</span>
<span class="w">  </span><span class="c1">// return value</span>
<span class="p">}</span>
<span class="k">@end</span>

<span class="k">@interface</span> <span class="nc">A</span> : <span class="bp">NSObject</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nf">foo:</span><span class="p">(</span><span class="bp">NSError</span><span class="w"> </span><span class="s">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</span><span class="p">)</span><span class="nv">error</span><span class="p">;</span>
<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">A</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nf">foo:</span><span class="p">(</span><span class="bp">NSError</span><span class="w"> </span><span class="s">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</span><span class="p">)</span><span class="nv">error</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="o">*</span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn: potential null dereference</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">@end</span>
</pre></div>
</div>
</section>
<section id="osx-cocoa-nilarg-objc">
<span id="osx-cocoa-nilarg"></span><h4><a class="toc-backref" href="#id132" role="doc-backlink"><span class="section-number">1.1.9.14. </span>osx.cocoa.NilArg (ObjC)</a><a class="headerlink" href="#osx-cocoa-nilarg-objc" title="Link to this heading">¶</a></h4>
<p>Check for prohibited nil arguments to ObjC method calls.</p>
<blockquote>
<div><ul class="simple">
<li><p>caseInsensitiveCompare:</p></li>
<li><p>compare:</p></li>
<li><p>compare:options:</p></li>
<li><p>compare:options:range:</p></li>
<li><p>compare:options:range:locale:</p></li>
<li><p>componentsSeparatedByCharactersInSet:</p></li>
<li><p>initWithFormat:</p></li>
</ul>
</div></blockquote>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="n">NSComparisonResult</span><span class="w"> </span><span class="nf">test</span><span class="p">(</span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">aString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nil</span><span class="p">;</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">[</span><span class="n">s</span><span class="w"> </span><span class="n">caseInsensitiveCompare</span><span class="o">:</span><span class="n">aString</span><span class="p">];</span>
<span class="w">    </span><span class="c1">// warn: argument to &#39;NSString&#39; method</span>
<span class="w">    </span><span class="c1">// &#39;caseInsensitiveCompare:&#39; cannot be nil</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="osx-cocoa-nonnilreturnvalue">
<span id="id7"></span><h4><a class="toc-backref" href="#id133" role="doc-backlink"><span class="section-number">1.1.9.15. </span>osx.cocoa.NonNilReturnValue</a><a class="headerlink" href="#osx-cocoa-nonnilreturnvalue" title="Link to this heading">¶</a></h4>
<p>Models the APIs that are guaranteed to return a non-nil value.</p>
</section>
<section id="osx-cocoa-objcgenerics-objc">
<span id="osx-cocoa-objcgenerics"></span><h4><a class="toc-backref" href="#id134" role="doc-backlink"><span class="section-number">1.1.9.16. </span>osx.cocoa.ObjCGenerics (ObjC)</a><a class="headerlink" href="#osx-cocoa-objcgenerics-objc" title="Link to this heading">¶</a></h4>
<p>Check for type errors when using Objective-C generics.</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="bp">NSMutableArray</span><span class="w"> </span><span class="o">*</span><span class="n">names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">NSMutableArray</span><span class="w"> </span><span class="n">array</span><span class="p">];</span>
<span class="bp">NSMutableArray</span><span class="w"> </span><span class="o">*</span><span class="n">birthDates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">names</span><span class="p">;</span>

<span class="c1">// Warning: Conversion from value of type &#39;NSDate *&#39;</span>
<span class="c1">// to incompatible type &#39;NSString *&#39;</span>
<span class="p">[</span><span class="n">birthDates</span><span class="w"> </span><span class="n">addObject</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="bp">NSDate</span><span class="w"> </span><span class="n">date</span><span class="p">]];</span>
</pre></div>
</div>
</section>
<section id="osx-cocoa-retaincount-objc">
<span id="osx-cocoa-retaincount"></span><h4><a class="toc-backref" href="#id135" role="doc-backlink"><span class="section-number">1.1.9.17. </span>osx.cocoa.RetainCount (ObjC)</a><a class="headerlink" href="#osx-cocoa-retaincount-objc" title="Link to this heading">¶</a></h4>
<p>Check for leaks and improper reference count management</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="bp">NSString</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">init</span><span class="p">];</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>

<span class="n">CFStringRef</span><span class="w"> </span><span class="nf">test</span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">bytes</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">CFStringCreateWithCStringNoCopy</span><span class="p">(</span>
<span class="w">           </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">bytes</span><span class="p">,</span><span class="w"> </span><span class="n">NSNEXTSTEPStringEncoding</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="osx-cocoa-runloopautoreleaseleak">
<span id="id8"></span><h4><a class="toc-backref" href="#id136" role="doc-backlink"><span class="section-number">1.1.9.18. </span>osx.cocoa.RunLoopAutoreleaseLeak</a><a class="headerlink" href="#osx-cocoa-runloopautoreleaseleak" title="Link to this heading">¶</a></h4>
<p>Check for leaked memory in autorelease pools that will never be drained.</p>
</section>
<section id="osx-cocoa-selfinit-objc">
<span id="osx-cocoa-selfinit"></span><h4><a class="toc-backref" href="#id137" role="doc-backlink"><span class="section-number">1.1.9.19. </span>osx.cocoa.SelfInit (ObjC)</a><a class="headerlink" href="#osx-cocoa-selfinit-objc" title="Link to this heading">¶</a></h4>
<p>Check that ‘self’ is properly initialized inside an initializer method.</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="k">@interface</span> <span class="nc">MyObj</span> : <span class="bp">NSObject</span> <span class="p">{</span>
<span class="w">  </span><span class="kt">id</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nf">init</span><span class="p">;</span>
<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">MyObj</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nf">init</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="p">[</span><span class="nb">super</span><span class="w"> </span><span class="n">init</span><span class="p">];</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn: instance variable used while &#39;self&#39; is not</span>
<span class="w">         </span><span class="c1">// initialized</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">@end</span>

<span class="k">@interface</span> <span class="nc">MyObj</span> : <span class="bp">NSObject</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nf">init</span><span class="p">;</span>
<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">MyObj</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nf">init</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="p">[</span><span class="nb">super</span><span class="w"> </span><span class="n">init</span><span class="p">];</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nb">self</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn: returning uninitialized &#39;self&#39;</span>
<span class="p">}</span>
<span class="k">@end</span>
</pre></div>
</div>
</section>
<section id="osx-cocoa-superdealloc-objc">
<span id="osx-cocoa-superdealloc"></span><h4><a class="toc-backref" href="#id138" role="doc-backlink"><span class="section-number">1.1.9.20. </span>osx.cocoa.SuperDealloc (ObjC)</a><a class="headerlink" href="#osx-cocoa-superdealloc-objc" title="Link to this heading">¶</a></h4>
<p>Warn about improper use of ‘[super dealloc]’ in Objective-C.</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="k">@interface</span> <span class="nc">SuperDeallocThenReleaseIvarClass</span> : <span class="bp">NSObject</span> <span class="p">{</span>
<span class="w">  </span><span class="bp">NSObject</span><span class="w"> </span><span class="o">*</span><span class="n">_ivar</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">SuperDeallocThenReleaseIvarClass</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">dealloc</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="p">[</span><span class="nb">super</span><span class="w"> </span><span class="n">dealloc</span><span class="p">];</span>
<span class="w">  </span><span class="p">[</span><span class="n">_ivar</span><span class="w"> </span><span class="k">release</span><span class="p">];</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
<span class="k">@end</span>
</pre></div>
</div>
</section>
<section id="osx-cocoa-unusedivars-objc">
<span id="osx-cocoa-unusedivars"></span><h4><a class="toc-backref" href="#id139" role="doc-backlink"><span class="section-number">1.1.9.21. </span>osx.cocoa.UnusedIvars (ObjC)</a><a class="headerlink" href="#osx-cocoa-unusedivars-objc" title="Link to this heading">¶</a></h4>
<p>Warn about private ivars that are never used.</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="k">@interface</span> <span class="nc">MyObj</span> : <span class="bp">NSObject</span> <span class="p">{</span>
<span class="k">@private</span>
<span class="w">  </span><span class="kt">id</span><span class="w"> </span><span class="n">x</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">MyObj</span>
<span class="k">@end</span>
</pre></div>
</div>
</section>
<section id="osx-cocoa-variadicmethodtypes-objc">
<span id="osx-cocoa-variadicmethodtypes"></span><h4><a class="toc-backref" href="#id140" role="doc-backlink"><span class="section-number">1.1.9.22. </span>osx.cocoa.VariadicMethodTypes (ObjC)</a><a class="headerlink" href="#osx-cocoa-variadicmethodtypes-objc" title="Link to this heading">¶</a></h4>
<p>Check for passing non-Objective-C types to variadic collection
initialization methods that expect only Objective-C types.</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="p">[</span><span class="bp">NSSet</span><span class="w"> </span><span class="n">setWithObjects</span><span class="o">:</span><span class="s">@&quot;Foo&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Bar&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">nil</span><span class="p">];</span>
<span class="w">    </span><span class="c1">// warn: argument should be an ObjC pointer type, not &#39;char *&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="osx-corefoundation-cferror-c">
<span id="osx-corefoundation-cferror"></span><h4><a class="toc-backref" href="#id141" role="doc-backlink"><span class="section-number">1.1.9.23. </span>osx.coreFoundation.CFError (C)</a><a class="headerlink" href="#osx-corefoundation-cferror-c" title="Link to this heading">¶</a></h4>
<p>Check usage of CFErrorRef* parameters</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">(</span><span class="n">CFErrorRef</span><span class="w"> </span><span class="o">*</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// warn: function accepting CFErrorRef* should have a</span>
<span class="w">  </span><span class="c1">// non-void return</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">foo</span><span class="p">(</span><span class="n">CFErrorRef</span><span class="w"> </span><span class="o">*</span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="o">*</span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn: potential null dereference</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="osx-corefoundation-cfnumber-c">
<span id="osx-corefoundation-cfnumber"></span><h4><a class="toc-backref" href="#id142" role="doc-backlink"><span class="section-number">1.1.9.24. </span>osx.coreFoundation.CFNumber (C)</a><a class="headerlink" href="#osx-corefoundation-cfnumber-c" title="Link to this heading">¶</a></h4>
<p>Check for proper uses of CFNumber APIs.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">CFNumberRef</span><span class="w"> </span><span class="nf">test</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">CFNumberCreate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">kCFNumberSInt16Type</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">x</span><span class="p">);</span>
<span class="w">   </span><span class="c1">// warn: 8-bit integer is used to initialize a 16-bit integer</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="osx-corefoundation-cfretainrelease-c">
<span id="osx-corefoundation-cfretainrelease"></span><h4><a class="toc-backref" href="#id143" role="doc-backlink"><span class="section-number">1.1.9.25. </span>osx.coreFoundation.CFRetainRelease (C)</a><a class="headerlink" href="#osx-corefoundation-cfretainrelease-c" title="Link to this heading">¶</a></h4>
<p>Check for null arguments to CFRetain/CFRelease/CFMakeCollectable.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">(</span><span class="n">CFTypeRef</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">p</span><span class="p">)</span>
<span class="w">    </span><span class="n">CFRetain</span><span class="p">(</span><span class="n">p</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">CFTypeRef</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span>

<span class="w">  </span><span class="n">CFRelease</span><span class="p">(</span><span class="n">p</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="osx-corefoundation-containers-outofbounds-c">
<span id="osx-corefoundation-containers-outofbounds"></span><h4><a class="toc-backref" href="#id144" role="doc-backlink"><span class="section-number">1.1.9.26. </span>osx.coreFoundation.containers.OutOfBounds (C)</a><a class="headerlink" href="#osx-corefoundation-containers-outofbounds-c" title="Link to this heading">¶</a></h4>
<p>Checks for index out-of-bounds when using ‘CFArray’ API.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">CFArrayRef</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CFArrayCreate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">kCFTypeArrayCallBacks</span><span class="p">);</span>
<span class="w">  </span><span class="n">CFArrayGetValueAtIndex</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="osx-corefoundation-containers-pointersizedvalues-c">
<span id="osx-corefoundation-containers-pointersizedvalues"></span><h4><a class="toc-backref" href="#id145" role="doc-backlink"><span class="section-number">1.1.9.27. </span>osx.coreFoundation.containers.PointerSizedValues (C)</a><a class="headerlink" href="#osx-corefoundation-containers-pointersizedvalues-c" title="Link to this heading">¶</a></h4>
<p>Warns if ‘CFArray’, ‘CFDictionary’, ‘CFSet’ are created with non-pointer-size values.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">};</span>
<span class="w">  </span><span class="n">CFArrayRef</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CFArrayCreate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="s">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</span><span class="p">)</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">                               </span><span class="o">&amp;</span><span class="n">kCFTypeArrayCallBacks</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="fuchsia">
<h3><a class="toc-backref" href="#id146" role="doc-backlink"><span class="section-number">1.1.10. </span>Fuchsia</a><a class="headerlink" href="#fuchsia" title="Link to this heading">¶</a></h3>
<p>Fuchsia is an open source capability-based operating system currently being
developed by Google. This section describes checkers that can find various
misuses of Fuchsia APIs.</p>
<section id="fuchsia-handlechecker">
<span id="id9"></span><h4><a class="toc-backref" href="#id147" role="doc-backlink"><span class="section-number">1.1.10.1. </span>fuchsia.HandleChecker</a><a class="headerlink" href="#fuchsia-handlechecker" title="Link to this heading">¶</a></h4>
<p>Handles identify resources. Similar to pointers they can be leaked,
double freed, or use after freed. This check attempts to find such problems.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">checkLeak08</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">tag</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">zx_handle_t</span><span class="w"> </span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="n">sb</span><span class="p">;</span>
<span class="w">  </span><span class="n">zx_channel_create</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">sa</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">sb</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>
<span class="w">    </span><span class="n">zx_handle_close</span><span class="p">(</span><span class="n">sa</span><span class="p">);</span>
<span class="w">  </span><span class="n">use</span><span class="p">(</span><span class="n">sb</span><span class="p">);</span><span class="w"> </span><span class="c1">// Warn: Potential leak of handle</span>
<span class="w">  </span><span class="n">zx_handle_close</span><span class="p">(</span><span class="n">sb</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="webkit">
<h3><a class="toc-backref" href="#id148" role="doc-backlink"><span class="section-number">1.1.11. </span>WebKit</a><a class="headerlink" href="#webkit" title="Link to this heading">¶</a></h3>
<p>WebKit is an open-source web browser engine available for macOS, iOS and Linux.
This section describes checkers that can find issues in WebKit codebase.</p>
<p>Most of the checkers focus on memory management for which WebKit uses custom implementation of reference counted smartpointers.</p>
<dl class="simple">
<dt>Checkers are formulated in terms related to ref-counting:</dt><dd><ul class="simple">
<li><p><em>Ref-counted type</em> is either <code class="docutils literal notranslate"><span class="pre">Ref&lt;T&gt;</span></code> or <code class="docutils literal notranslate"><span class="pre">RefPtr&lt;T&gt;</span></code>.</p></li>
<li><p><em>Ref-countable type</em> is any type that implements <code class="docutils literal notranslate"><span class="pre">ref()</span></code> and <code class="docutils literal notranslate"><span class="pre">deref()</span></code> methods as <code class="docutils literal notranslate"><span class="pre">RefPtr&lt;&gt;</span></code> is a template (i. e. relies on duck typing).</p></li>
<li><p><em>Uncounted type</em> is ref-countable but not ref-counted type.</p></li>
</ul>
</dd>
</dl>
<section id="webkit-refcntblbasevirtualdtor">
<span id="id10"></span><h4><a class="toc-backref" href="#id149" role="doc-backlink"><span class="section-number">1.1.11.1. </span>webkit.RefCntblBaseVirtualDtor</a><a class="headerlink" href="#webkit-refcntblbasevirtualdtor" title="Link to this heading">¶</a></h4>
<p>All uncounted types used as base classes must have a virtual destructor.</p>
<p>Ref-counted types hold their ref-countable data by a raw pointer and allow implicit upcasting from ref-counted pointer to derived type to ref-counted pointer to base type. This might lead to an object of (dynamic) derived type being deleted via pointer to the base class type which C++ standard defines as UB in case the base class doesn’t have virtual destructor <code class="docutils literal notranslate"><span class="pre">[expr.delete]</span></code>.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">RefCntblBase</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">ref</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">deref</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span>
<span class="p">};</span>

<span class="k">struct</span><span class="w"> </span><span class="nc">Derived</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">RefCntblBase</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="c1">// warn</span>
</pre></div>
</div>
</section>
<section id="webkit-nouncountedmemberchecker">
<span id="id11"></span><h4><a class="toc-backref" href="#id150" role="doc-backlink"><span class="section-number">1.1.11.2. </span>webkit.NoUncountedMemberChecker</a><a class="headerlink" href="#webkit-nouncountedmemberchecker" title="Link to this heading">¶</a></h4>
<p>Raw pointers and references to uncounted types can’t be used as class members. Only ref-counted types are allowed.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">RefCntbl</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">ref</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">deref</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span>
<span class="p">};</span>

<span class="k">struct</span><span class="w"> </span><span class="nc">Foo</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">RefCntbl</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ptr</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="w">  </span><span class="n">RefCntbl</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">ptr</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="w">  </span><span class="c1">// ...</span>
<span class="p">};</span>
</pre></div>
</div>
</section>
<section id="webkit-uncountedlambdacaptureschecker">
<span id="id12"></span><h4><a class="toc-backref" href="#id151" role="doc-backlink"><span class="section-number">1.1.11.3. </span>webkit.UncountedLambdaCapturesChecker</a><a class="headerlink" href="#webkit-uncountedlambdacaptureschecker" title="Link to this heading">¶</a></h4>
<p>Raw pointers and references to uncounted types can’t be captured in lambdas. Only ref-counted types are allowed.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">RefCntbl</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">ref</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">deref</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span>
<span class="p">};</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">foo</span><span class="p">(</span><span class="n">RefCntbl</span><span class="o">*</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">RefCntbl</span><span class="o">&amp;</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="p">[</span><span class="o">&amp;</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">](){</span><span class="w"> </span><span class="c1">// warn about &#39;a&#39;</span>
<span class="w">    </span><span class="n">do_something</span><span class="p">(</span><span class="n">b</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn about &#39;b&#39;</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">};</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="experimental-checkers">
<span id="alpha-checkers"></span><h2><a class="toc-backref" href="#id152" role="doc-backlink"><span class="section-number">1.2. </span>Experimental Checkers</a><a class="headerlink" href="#experimental-checkers" title="Link to this heading">¶</a></h2>
<p><em>These are checkers with known issues or limitations that keep them from being on by default. They are likely to have false positives. Bug reports and especially patches are welcome.</em></p>
<section id="alpha-clone">
<h3><a class="toc-backref" href="#id153" role="doc-backlink"><span class="section-number">1.2.1. </span>alpha.clone</a><a class="headerlink" href="#alpha-clone" title="Link to this heading">¶</a></h3>
<section id="alpha-clone-clonechecker-c-c-objc">
<span id="alpha-clone-clonechecker"></span><h4><a class="toc-backref" href="#id154" role="doc-backlink"><span class="section-number">1.2.1.1. </span>alpha.clone.CloneChecker (C, C++, ObjC)</a><a class="headerlink" href="#alpha-clone-clonechecker-c-c-objc" title="Link to this heading">¶</a></h4>
<p>Reports similar pieces of code.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">log</span><span class="p">();</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// warn</span>
<span class="w">  </span><span class="n">log</span><span class="p">();</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">b</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">maxClone</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// similar code here</span>
<span class="w">  </span><span class="n">log</span><span class="p">();</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">y</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">y</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="alpha-core">
<h3><a class="toc-backref" href="#id155" role="doc-backlink"><span class="section-number">1.2.2. </span>alpha.core</a><a class="headerlink" href="#alpha-core" title="Link to this heading">¶</a></h3>
<section id="alpha-core-boolassignment-objc">
<span id="alpha-core-boolassignment"></span><h4><a class="toc-backref" href="#id156" role="doc-backlink"><span class="section-number">1.2.2.1. </span>alpha.core.BoolAssignment (ObjC)</a><a class="headerlink" href="#alpha-core-boolassignment-objc" title="Link to this heading">¶</a></h4>
<p>Warn about assigning non-{0,1} values to boolean variables.</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">BOOL</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="alpha-core-c11lock">
<span id="id13"></span><h4><a class="toc-backref" href="#id157" role="doc-backlink"><span class="section-number">1.2.2.2. </span>alpha.core.C11Lock</a><a class="headerlink" href="#alpha-core-c11lock" title="Link to this heading">¶</a></h4>
<p>Similarly to <a class="reference internal" href="#alpha-unix-pthreadlock"><span class="std std-ref">alpha.unix.PthreadLock</span></a>, checks for
the locking/unlocking of <code class="docutils literal notranslate"><span class="pre">mtx_t</span></code> mutexes.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">mtx_t</span><span class="w"> </span><span class="n">mtx1</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">bad1</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">mtx_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mtx1</span><span class="p">);</span>
<span class="w">  </span><span class="n">mtx_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mtx1</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn: This lock has already been acquired</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="alpha-core-castsize-c">
<span id="alpha-core-castsize"></span><h4><a class="toc-backref" href="#id158" role="doc-backlink"><span class="section-number">1.2.2.3. </span>alpha.core.CastSize (C)</a><a class="headerlink" href="#alpha-core-castsize-c" title="Link to this heading">¶</a></h4>
<p>Check when casting a malloc’ed type <code class="docutils literal notranslate"><span class="pre">T</span></code>, whether the size is a multiple of the size of <code class="docutils literal notranslate"><span class="pre">T</span></code>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="mi">11</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="alpha-core-casttostruct-c-c">
<span id="alpha-core-casttostruct"></span><h4><a class="toc-backref" href="#id159" role="doc-backlink"><span class="section-number">1.2.2.4. </span>alpha.core.CastToStruct (C, C++)</a><a class="headerlink" href="#alpha-core-casttostruct-c-c" title="Link to this heading">¶</a></h4>
<p>Check for cast from non-struct pointer to struct pointer.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// C</span>
<span class="k">struct</span><span class="w"> </span><span class="nc">s</span><span class="w"> </span><span class="p">{};</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">struct</span><span class="w"> </span><span class="nc">s</span><span class="w"> </span><span class="o">*</span><span class="n">ps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">s</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">p</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>

<span class="c1">// C++</span>
<span class="k">class</span><span class="w"> </span><span class="nc">c</span><span class="w"> </span><span class="p">{};</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">c</span><span class="w"> </span><span class="o">*</span><span class="n">pc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">p</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="alpha-core-conversion-c-c-objc">
<span id="alpha-core-conversion"></span><h4><a class="toc-backref" href="#id160" role="doc-backlink"><span class="section-number">1.2.2.5. </span>alpha.core.Conversion (C, C++, ObjC)</a><a class="headerlink" href="#alpha-core-conversion-c-c-objc" title="Link to this heading">¶</a></h4>
<p>Loss of sign/precision in implicit conversions.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="n">U</span><span class="p">,</span><span class="w"> </span><span class="kt">signed</span><span class="w"> </span><span class="n">S</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">S</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">U</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">S</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">S</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">-10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">U</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">S</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// warn (loss of sign)</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1L</span><span class="n">L</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">60</span><span class="p">;</span>
<span class="w">  </span><span class="kt">short</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn (loss of precision)</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="alpha-core-dynamictypechecker-objc">
<span id="alpha-core-dynamictypechecker"></span><h4><a class="toc-backref" href="#id161" role="doc-backlink"><span class="section-number">1.2.2.6. </span>alpha.core.DynamicTypeChecker (ObjC)</a><a class="headerlink" href="#alpha-core-dynamictypechecker-objc" title="Link to this heading">¶</a></h4>
<p>Check for cases where the dynamic and the static type of an object are unrelated.</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="kt">id</span><span class="w"> </span><span class="n">date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">NSDate</span><span class="w"> </span><span class="n">date</span><span class="p">];</span>

<span class="c1">// Warning: Object has a dynamic type &#39;NSDate *&#39; which is</span>
<span class="c1">// incompatible with static type &#39;NSNumber *&#39;&quot;</span>
<span class="bp">NSNumber</span><span class="w"> </span><span class="o">*</span><span class="n">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date</span><span class="p">;</span>
<span class="p">[</span><span class="n">number</span><span class="w"> </span><span class="n">doubleValue</span><span class="p">];</span>
</pre></div>
</div>
</section>
<section id="alpha-core-fixedaddr-c">
<span id="alpha-core-fixedaddr"></span><h4><a class="toc-backref" href="#id162" role="doc-backlink"><span class="section-number">1.2.2.7. </span>alpha.core.FixedAddr (C)</a><a class="headerlink" href="#alpha-core-fixedaddr-c" title="Link to this heading">¶</a></h4>
<p>Check for assignment of a fixed address to a pointer.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">;</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="mh">0x10000</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="alpha-core-pointerarithm-c">
<span id="alpha-core-pointerarithm"></span><h4><a class="toc-backref" href="#id163" role="doc-backlink"><span class="section-number">1.2.2.8. </span>alpha.core.PointerArithm (C)</a><a class="headerlink" href="#alpha-core-pointerarithm-c" title="Link to this heading">¶</a></h4>
<p>Check for pointer arithmetic on locations other than array elements.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">;</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="alpha-core-stackaddressasyncescape-objc">
<span id="alpha-core-stackaddressasyncescape"></span><h4><a class="toc-backref" href="#id164" role="doc-backlink"><span class="section-number">1.2.2.9. </span>alpha.core.StackAddressAsyncEscape (ObjC)</a><a class="headerlink" href="#alpha-core-stackaddressasyncescape-objc" title="Link to this heading">¶</a></h4>
<p>Check that addresses to stack memory do not escape the function that involves dispatch_after or dispatch_async.
This checker is a part of <code class="docutils literal notranslate"><span class="pre">core.StackAddressEscape</span></code>, but is temporarily disabled until some false positives are fixed.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">dispatch_block_t</span><span class="w"> </span><span class="nf">test_block_inside_block_async_leak</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">123</span><span class="p">;</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="o">^</span><span class="n">inner</span><span class="p">)(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">^</span><span class="kt">void</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="w">    </span><span class="o">++</span><span class="n">y</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="o">^</span><span class="n">outer</span><span class="p">)(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">^</span><span class="kt">void</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="w">    </span><span class="o">++</span><span class="n">z</span><span class="p">;</span>
<span class="w">    </span><span class="n">inner</span><span class="p">();</span>
<span class="w">  </span><span class="p">};</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">outer</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn: address of stack-allocated block is captured by a</span>
<span class="w">                </span><span class="c1">//       returned block</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="alpha-core-stdvariant-c">
<span id="alpha-core-stdvariant"></span><h4><a class="toc-backref" href="#id165" role="doc-backlink"><span class="section-number">1.2.2.10. </span>alpha.core.StdVariant (C++)</a><a class="headerlink" href="#alpha-core-stdvariant-c" title="Link to this heading">¶</a></h4>
<p>Check if a value of active type is retrieved from an <code class="docutils literal notranslate"><span class="pre">std::variant</span></code> instance with <code class="docutils literal notranslate"><span class="pre">std::get</span></code>.
In case of bad variant type access (the accessed type differs from the active type)
a warning is emitted. Currently, this checker does not take exception handling into account.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">variant</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">25</span><span class="p">;</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stg</span><span class="o">::</span><span class="n">get</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;</span><span class="p">(</span><span class="n">v</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn: &quot;int&quot; is the active alternative</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="alpha-core-testafterdivzero-c">
<span id="alpha-core-testafterdivzero"></span><h4><a class="toc-backref" href="#id166" role="doc-backlink"><span class="section-number">1.2.2.11. </span>alpha.core.TestAfterDivZero (C)</a><a class="headerlink" href="#alpha-core-testafterdivzero-c" title="Link to this heading">¶</a></h4>
<p>Check for division by variable that is later compared against 0.
Either the comparison is useless or there is division by zero.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">var</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">77</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="alpha-cplusplus">
<h3><a class="toc-backref" href="#id167" role="doc-backlink"><span class="section-number">1.2.3. </span>alpha.cplusplus</a><a class="headerlink" href="#alpha-cplusplus" title="Link to this heading">¶</a></h3>
<section id="alpha-cplusplus-deletewithnonvirtualdtor-c">
<span id="alpha-cplusplus-deletewithnonvirtualdtor"></span><h4><a class="toc-backref" href="#id168" role="doc-backlink"><span class="section-number">1.2.3.1. </span>alpha.cplusplus.DeleteWithNonVirtualDtor (C++)</a><a class="headerlink" href="#alpha-cplusplus-deletewithnonvirtualdtor-c" title="Link to this heading">¶</a></h4>
<p>Reports destructions of polymorphic objects with a non-virtual destructor in their base class.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">NonVirtual</span><span class="w"> </span><span class="p">{};</span>
<span class="k">class</span><span class="w"> </span><span class="nc">NVDerived</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">NonVirtual</span><span class="w"> </span><span class="p">{};</span>

<span class="n">NonVirtual</span><span class="w"> </span><span class="o">*</span><span class="nf">create</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">NonVirtual</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">NVDerived</span><span class="p">();</span><span class="w"> </span><span class="c1">// note: Casting from &#39;NVDerived&#39; to</span>
<span class="w">                                   </span><span class="c1">//       &#39;NonVirtual&#39; here</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">foo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">NonVirtual</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create</span><span class="p">();</span>
<span class="w">  </span><span class="k">delete</span><span class="w"> </span><span class="n">x</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn: destruction of a polymorphic object with no virtual</span>
<span class="w">            </span><span class="c1">//       destructor</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="alpha-cplusplus-invalidatediterator-c">
<span id="alpha-cplusplus-invalidatediterator"></span><h4><a class="toc-backref" href="#id169" role="doc-backlink"><span class="section-number">1.2.3.2. </span>alpha.cplusplus.InvalidatedIterator (C++)</a><a class="headerlink" href="#alpha-cplusplus-invalidatediterator-c" title="Link to this heading">¶</a></h4>
<p>Check for use of invalidated iterators.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">bad_copy_assign_operator_list1</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">list</span><span class="w"> </span><span class="o">&amp;</span><span class="n">L1</span><span class="p">,</span>
<span class="w">                                    </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">list</span><span class="w"> </span><span class="o">&amp;</span><span class="n">L2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">i0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">L1</span><span class="p">.</span><span class="n">cbegin</span><span class="p">();</span>
<span class="w">  </span><span class="n">L1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">L2</span><span class="p">;</span>
<span class="w">  </span><span class="o">*</span><span class="n">i0</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn: invalidated iterator accessed</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="alpha-cplusplus-iteratorrange-c">
<span id="alpha-cplusplus-iteratorrange"></span><h4><a class="toc-backref" href="#id170" role="doc-backlink"><span class="section-number">1.2.3.3. </span>alpha.cplusplus.IteratorRange (C++)</a><a class="headerlink" href="#alpha-cplusplus-iteratorrange-c" title="Link to this heading">¶</a></h4>
<p>Check for iterators used outside their valid ranges.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">simple_bad_end</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="w"> </span><span class="o">&amp;</span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">end</span><span class="p">();</span>
<span class="w">  </span><span class="o">*</span><span class="n">i</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn: iterator accessed outside of its range</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="alpha-cplusplus-mismatchediterator-c">
<span id="alpha-cplusplus-mismatchediterator"></span><h4><a class="toc-backref" href="#id171" role="doc-backlink"><span class="section-number">1.2.3.4. </span>alpha.cplusplus.MismatchedIterator (C++)</a><a class="headerlink" href="#alpha-cplusplus-mismatchediterator-c" title="Link to this heading">¶</a></h4>
<p>Check for use of iterators of different containers where iterators of the same container are expected.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">bad_insert3</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="w"> </span><span class="o">&amp;</span><span class="n">v1</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="w"> </span><span class="o">&amp;</span><span class="n">v2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">v2</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">v1</span><span class="p">.</span><span class="n">cbegin</span><span class="p">(),</span><span class="w"> </span><span class="n">v2</span><span class="p">.</span><span class="n">cbegin</span><span class="p">(),</span><span class="w"> </span><span class="n">v2</span><span class="p">.</span><span class="n">cend</span><span class="p">());</span><span class="w"> </span><span class="c1">// warn: container accessed</span>
<span class="w">                                                  </span><span class="c1">//       using foreign</span>
<span class="w">                                                  </span><span class="c1">//       iterator argument</span>
<span class="w">  </span><span class="n">v1</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">v1</span><span class="p">.</span><span class="n">cbegin</span><span class="p">(),</span><span class="w"> </span><span class="n">v1</span><span class="p">.</span><span class="n">cbegin</span><span class="p">(),</span><span class="w"> </span><span class="n">v2</span><span class="p">.</span><span class="n">cend</span><span class="p">());</span><span class="w"> </span><span class="c1">// warn: iterators of</span>
<span class="w">                                                  </span><span class="c1">//       different containers</span>
<span class="w">                                                  </span><span class="c1">//       used where the same</span>
<span class="w">                                                  </span><span class="c1">//       container is</span>
<span class="w">                                                  </span><span class="c1">//       expected</span>
<span class="w">  </span><span class="n">v1</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">v1</span><span class="p">.</span><span class="n">cbegin</span><span class="p">(),</span><span class="w"> </span><span class="n">v2</span><span class="p">.</span><span class="n">cbegin</span><span class="p">(),</span><span class="w"> </span><span class="n">v1</span><span class="p">.</span><span class="n">cend</span><span class="p">());</span><span class="w"> </span><span class="c1">// warn: iterators of</span>
<span class="w">                                                  </span><span class="c1">//       different containers</span>
<span class="w">                                                  </span><span class="c1">//       used where the same</span>
<span class="w">                                                  </span><span class="c1">//       container is</span>
<span class="w">                                                  </span><span class="c1">//       expected</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="alpha-cplusplus-smartptr-c">
<span id="alpha-cplusplus-smartptr"></span><h4><a class="toc-backref" href="#id172" role="doc-backlink"><span class="section-number">1.2.3.5. </span>alpha.cplusplus.SmartPtr (C++)</a><a class="headerlink" href="#alpha-cplusplus-smartptr-c" title="Link to this heading">¶</a></h4>
<p>Check for dereference of null smart pointers.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">deref_smart_ptr</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">P</span><span class="p">;</span>
<span class="w">  </span><span class="o">*</span><span class="n">P</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn: dereference of a default constructed smart unique_ptr</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="alpha-deadcode">
<h3><a class="toc-backref" href="#id173" role="doc-backlink"><span class="section-number">1.2.4. </span>alpha.deadcode</a><a class="headerlink" href="#alpha-deadcode" title="Link to this heading">¶</a></h3>
<section id="alpha-deadcode-unreachablecode-c-c">
<span id="alpha-deadcode-unreachablecode"></span><h4><a class="toc-backref" href="#id174" role="doc-backlink"><span class="section-number">1.2.4.1. </span>alpha.deadcode.UnreachableCode (C, C++)</a><a class="headerlink" href="#alpha-deadcode-unreachablecode-c-c" title="Link to this heading">¶</a></h4>
<p>Check unreachable code.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// C</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">  </span><span class="k">while</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>

<span class="c1">// C++</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>

<span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="n">a</span><span class="o">--</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="n">a</span><span class="o">++</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>

<span class="c1">// Objective-C</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="p">;</span>
<span class="w">  </span><span class="p">[</span><span class="n">x</span><span class="w"> </span><span class="n">retain</span><span class="p">];</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="alpha-fuchsia">
<h3><a class="toc-backref" href="#id175" role="doc-backlink"><span class="section-number">1.2.5. </span>alpha.fuchsia</a><a class="headerlink" href="#alpha-fuchsia" title="Link to this heading">¶</a></h3>
<section id="alpha-fuchsia-lock">
<span id="id14"></span><h4><a class="toc-backref" href="#id176" role="doc-backlink"><span class="section-number">1.2.5.1. </span>alpha.fuchsia.Lock</a><a class="headerlink" href="#alpha-fuchsia-lock" title="Link to this heading">¶</a></h4>
<p>Similarly to <a class="reference internal" href="#alpha-unix-pthreadlock"><span class="std std-ref">alpha.unix.PthreadLock</span></a>, checks for
the locking/unlocking of fuchsia mutexes.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">spin_lock_t</span><span class="w"> </span><span class="n">mtx1</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">bad1</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">spin_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mtx1</span><span class="p">);</span>
<span class="w">  </span><span class="n">spin_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mtx1</span><span class="p">);</span><span class="w">    </span><span class="c1">// warn: This lock has already been acquired</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="alpha-llvm">
<h3><a class="toc-backref" href="#id177" role="doc-backlink"><span class="section-number">1.2.6. </span>alpha.llvm</a><a class="headerlink" href="#alpha-llvm" title="Link to this heading">¶</a></h3>
<section id="alpha-llvm-conventions">
<span id="id15"></span><h4><a class="toc-backref" href="#id178" role="doc-backlink"><span class="section-number">1.2.6.1. </span>alpha.llvm.Conventions</a><a class="headerlink" href="#alpha-llvm-conventions" title="Link to this heading">¶</a></h4>
<p>Check code for LLVM codebase conventions:</p>
<ul class="simple">
<li><p>A StringRef should not be bound to a temporary std::string whose lifetime is shorter than the StringRef’s.</p></li>
<li><p>Clang AST nodes should not have fields that can allocate memory.</p></li>
</ul>
</section>
</section>
<section id="alpha-osx">
<h3><a class="toc-backref" href="#id179" role="doc-backlink"><span class="section-number">1.2.7. </span>alpha.osx</a><a class="headerlink" href="#alpha-osx" title="Link to this heading">¶</a></h3>
<section id="alpha-osx-cocoa-directivarassignment-objc">
<span id="alpha-osx-cocoa-directivarassignment"></span><h4><a class="toc-backref" href="#id180" role="doc-backlink"><span class="section-number">1.2.7.1. </span>alpha.osx.cocoa.DirectIvarAssignment (ObjC)</a><a class="headerlink" href="#alpha-osx-cocoa-directivarassignment-objc" title="Link to this heading">¶</a></h4>
<p>Check for direct assignments to instance variables.</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="k">@interface</span> <span class="bp">MyClass</span> : <span class="bp">NSObject</span> <span class="p">{}</span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">readonly</span><span class="p">)</span><span class="w"> </span><span class="kt">id</span><span class="w"> </span><span class="n">A</span><span class="p">;</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">foo</span><span class="p">;</span>
<span class="k">@end</span>

<span class="k">@implementation</span> <span class="bp">MyClass</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">foo</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">_A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
<span class="k">@end</span>
</pre></div>
</div>
</section>
<section id="alpha-osx-cocoa-directivarassignmentforannotatedfunctions-objc">
<span id="alpha-osx-cocoa-directivarassignmentforannotatedfunctions"></span><h4><a class="toc-backref" href="#id181" role="doc-backlink"><span class="section-number">1.2.7.2. </span>alpha.osx.cocoa.DirectIvarAssignmentForAnnotatedFunctions (ObjC)</a><a class="headerlink" href="#alpha-osx-cocoa-directivarassignmentforannotatedfunctions-objc" title="Link to this heading">¶</a></h4>
<p>Check for direct assignments to instance variables in
the methods annotated with <code class="docutils literal notranslate"><span class="pre">objc_no_direct_instance_variable_assignment</span></code>.</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="k">@interface</span> <span class="bp">MyClass</span> : <span class="bp">NSObject</span> <span class="p">{}</span>
<span class="k">@property</span><span class="w"> </span><span class="p">(</span><span class="k">readonly</span><span class="p">)</span><span class="w"> </span><span class="kt">id</span><span class="w"> </span><span class="n">A</span><span class="p">;</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">fAnnotated</span><span class="w"> </span><span class="bp">__attribute__</span><span class="p">((</span>
<span class="w">    </span><span class="n">annotate</span><span class="p">(</span><span class="s">&quot;objc_no_direct_instance_variable_assignment&quot;</span><span class="p">)));</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">fNotAnnotated</span><span class="p">;</span>
<span class="k">@end</span>

<span class="k">@implementation</span> <span class="bp">MyClass</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">fAnnotated</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">_A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">fNotAnnotated</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">_A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c1">// no warn</span>
<span class="p">}</span>
<span class="k">@end</span>
</pre></div>
</div>
</section>
<section id="alpha-osx-cocoa-instancevariableinvalidation-objc">
<span id="alpha-osx-cocoa-instancevariableinvalidation"></span><h4><a class="toc-backref" href="#id182" role="doc-backlink"><span class="section-number">1.2.7.3. </span>alpha.osx.cocoa.InstanceVariableInvalidation (ObjC)</a><a class="headerlink" href="#alpha-osx-cocoa-instancevariableinvalidation-objc" title="Link to this heading">¶</a></h4>
<p>Check that the invalidatable instance variables are
invalidated in the methods annotated with objc_instance_variable_invalidator.</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="k">@protocol</span> <span class="nc">Invalidation</span> <span class="o">&lt;</span><span class="bp">NSObject</span><span class="o">&gt;</span>
<span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="n">invalidate</span>
<span class="w">  </span><span class="bp">__attribute__</span><span class="p">((</span><span class="n">annotate</span><span class="p">(</span><span class="s">&quot;objc_instance_variable_invalidator&quot;</span><span class="p">)));</span>
<span class="k">@end</span>

<span class="k">@interface</span> <span class="nc">InvalidationImpObj</span> : <span class="bp">NSObject</span><span class="w"> </span><span class="o">&lt;</span><span class="n">Invalidation</span><span class="o">&gt;</span>
<span class="k">@end</span>

<span class="k">@interface</span> <span class="nc">SubclassInvalidationImpObj</span> : <span class="nc">InvalidationImpObj</span> <span class="p">{</span>
<span class="w">  </span><span class="n">InvalidationImpObj</span><span class="w"> </span><span class="o">*</span><span class="n">var</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">invalidate</span><span class="p">;</span>
<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">SubclassInvalidationImpObj</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="nf">invalidate</span><span class="w"> </span><span class="p">{}</span>
<span class="k">@end</span>
<span class="c1">// warn: var needs to be invalidated or set to nil</span>
</pre></div>
</div>
</section>
<section id="alpha-osx-cocoa-missinginvalidationmethod-objc">
<span id="alpha-osx-cocoa-missinginvalidationmethod"></span><h4><a class="toc-backref" href="#id183" role="doc-backlink"><span class="section-number">1.2.7.4. </span>alpha.osx.cocoa.MissingInvalidationMethod (ObjC)</a><a class="headerlink" href="#alpha-osx-cocoa-missinginvalidationmethod-objc" title="Link to this heading">¶</a></h4>
<p>Check that the invalidation methods are present in classes that contain invalidatable instance variables.</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="k">@protocol</span> <span class="nc">Invalidation</span> <span class="o">&lt;</span><span class="bp">NSObject</span><span class="o">&gt;</span>
<span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">invalidate</span>
<span class="w">  </span><span class="bp">__attribute__</span><span class="p">((</span><span class="n">annotate</span><span class="p">(</span><span class="s">&quot;objc_instance_variable_invalidator&quot;</span><span class="p">)));</span>
<span class="k">@end</span>

<span class="k">@interface</span> <span class="nc">NeedInvalidation</span> : <span class="bp">NSObject</span><span class="w"> </span><span class="o">&lt;</span><span class="n">Invalidation</span><span class="o">&gt;</span>
<span class="k">@end</span>

<span class="k">@interface</span> <span class="nc">MissingInvalidationMethodDecl</span> : <span class="bp">NSObject</span> <span class="p">{</span>
<span class="w">  </span><span class="n">NeedInvalidation</span><span class="w"> </span><span class="o">*</span><span class="n">Var</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">MissingInvalidationMethodDecl</span>
<span class="k">@end</span>
</pre></div>
</div>
</section>
<section id="alpha-osx-cocoa-localizability-pluralmisusechecker-objc">
<span id="alpha-osx-cocoa-localizability-pluralmisusechecker"></span><h4><a class="toc-backref" href="#id184" role="doc-backlink"><span class="section-number">1.2.7.5. </span>alpha.osx.cocoa.localizability.PluralMisuseChecker (ObjC)</a><a class="headerlink" href="#alpha-osx-cocoa-localizability-pluralmisusechecker-objc" title="Link to this heading">¶</a></h4>
<p>Warns against using one vs. many plural pattern in code when generating localized strings.</p>
<div class="highlight-objc notranslate"><div class="highlight"><pre><span></span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">reminderText</span><span class="w"> </span><span class="o">=</span>
<span class="w">  </span><span class="n">NSLocalizedString</span><span class="p">(</span><span class="s">@&quot;None&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">@&quot;Indicates no reminders&quot;</span><span class="p">);</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">reminderCount</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Warning: Plural cases are not supported across all languages.</span>
<span class="w">  </span><span class="c1">// Use a .stringsdict file instead</span>
<span class="w">  </span><span class="n">reminderText</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="n">NSLocalizedString</span><span class="p">(</span><span class="s">@&quot;1 Reminder&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">@&quot;Indicates single reminder&quot;</span><span class="p">);</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">reminderCount</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Warning: Plural cases are not supported across all languages.</span>
<span class="w">  </span><span class="c1">// Use a .stringsdict file instead</span>
<span class="w">  </span><span class="n">reminderText</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="p">[</span><span class="bp">NSString</span><span class="w"> </span><span class="n">stringWithFormat</span><span class="o">:</span>
<span class="w">      </span><span class="n">NSLocalizedString</span><span class="p">(</span><span class="s">@&quot;%@ Reminders&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">@&quot;Indicates multiple reminders&quot;</span><span class="p">),</span>
<span class="w">        </span><span class="n">reminderCount</span><span class="p">];</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="alpha-security">
<h3><a class="toc-backref" href="#id185" role="doc-backlink"><span class="section-number">1.2.8. </span>alpha.security</a><a class="headerlink" href="#alpha-security" title="Link to this heading">¶</a></h3>
<section id="alpha-security-returnptrrange-c">
<span id="alpha-security-returnptrrange"></span><h4><a class="toc-backref" href="#id186" role="doc-backlink"><span class="section-number">1.2.8.1. </span>alpha.security.ReturnPtrRange (C)</a><a class="headerlink" href="#alpha-security-returnptrrange-c" title="Link to this heading">¶</a></h4>
<p>Check for an out-of-bound pointer being returned to callers.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>

<span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">p</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">test</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn: undefined or garbage returned</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="alpha-security-cert">
<h3><a class="toc-backref" href="#id187" role="doc-backlink"><span class="section-number">1.2.9. </span>alpha.security.cert</a><a class="headerlink" href="#alpha-security-cert" title="Link to this heading">¶</a></h3>
<p>SEI CERT checkers which tries to find errors based on their <a class="reference external" href="https://wiki.sei.cmu.edu/confluence/display/c/2+Rules">C coding rules</a>.</p>
</section>
<section id="alpha-unix">
<h3><a class="toc-backref" href="#id188" role="doc-backlink"><span class="section-number">1.2.10. </span>alpha.unix</a><a class="headerlink" href="#alpha-unix" title="Link to this heading">¶</a></h3>
<section id="alpha-unix-pthreadlock-c">
<span id="alpha-unix-pthreadlock"></span><h4><a class="toc-backref" href="#id189" role="doc-backlink"><span class="section-number">1.2.10.1. </span>alpha.unix.PthreadLock (C)</a><a class="headerlink" href="#alpha-unix-pthreadlock-c" title="Link to this heading">¶</a></h4>
<p>Simple lock -&gt; unlock checker.
Applies to: <code class="docutils literal notranslate"><span class="pre">pthread_mutex_lock,</span> <span class="pre">pthread_rwlock_rdlock,</span> <span class="pre">pthread_rwlock_wrlock,</span> <span class="pre">lck_mtx_lock,</span> <span class="pre">lck_rw_lock_exclusive</span></code>
<code class="docutils literal notranslate"><span class="pre">lck_rw_lock_shared,</span> <span class="pre">pthread_mutex_trylock,</span> <span class="pre">pthread_rwlock_tryrdlock,</span> <span class="pre">pthread_rwlock_tryrwlock,</span> <span class="pre">lck_mtx_try_lock,</span>
<span class="pre">lck_rw_try_lock_exclusive,</span> <span class="pre">lck_rw_try_lock_shared,</span> <span class="pre">pthread_mutex_unlock,</span> <span class="pre">pthread_rwlock_unlock,</span> <span class="pre">lck_mtx_unlock,</span> <span class="pre">lck_rw_done</span></code>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">pthread_mutex_t</span><span class="w"> </span><span class="n">mtx</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">pthread_mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mtx</span><span class="p">);</span>
<span class="w">  </span><span class="n">pthread_mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mtx</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// warn: this lock has already been acquired</span>
<span class="p">}</span>

<span class="n">lck_mtx_t</span><span class="w"> </span><span class="n">lck1</span><span class="p">,</span><span class="w"> </span><span class="n">lck2</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">lck_mtx_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lck1</span><span class="p">);</span>
<span class="w">  </span><span class="n">lck_mtx_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lck2</span><span class="p">);</span>
<span class="w">  </span><span class="n">lck_mtx_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lck1</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// warn: this was not the most recently acquired lock</span>
<span class="p">}</span>

<span class="n">lck_mtx_t</span><span class="w"> </span><span class="n">lck1</span><span class="p">,</span><span class="w"> </span><span class="n">lck2</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lck_mtx_try_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lck1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span>

<span class="w">  </span><span class="n">lck_mtx_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lck2</span><span class="p">);</span>
<span class="w">  </span><span class="n">lck_mtx_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lck1</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// warn: this was not the most recently acquired lock</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="alpha-unix-simplestream-c">
<span id="alpha-unix-simplestream"></span><h4><a class="toc-backref" href="#id190" role="doc-backlink"><span class="section-number">1.2.10.2. </span>alpha.unix.SimpleStream (C)</a><a class="headerlink" href="#alpha-unix-simplestream-c" title="Link to this heading">¶</a></h4>
<p>Check for misuses of stream APIs. Check for misuses of stream APIs: <code class="docutils literal notranslate"><span class="pre">fopen,</span> <span class="pre">fclose</span></code>
(demo checker, the subject of the demo (<a class="reference external" href="https://llvm.org/devmtg/2012-11/Zaks-Rose-Checker24Hours.pdf">Slides</a> ,
<a class="reference external" href="https://youtu.be/kdxlsP5QVPw">Video</a>) by Anna Zaks and Jordan Rose presented at the
<a class="reference external" href="https://llvm.org/devmtg/2012-11/">2012 LLVM Developers’ Meeting</a>).</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">FILE</span><span class="w"> </span><span class="o">*</span><span class="n">F</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fopen</span><span class="p">(</span><span class="s">&quot;myfile.txt&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;w&quot;</span><span class="p">);</span>
<span class="p">}</span><span class="w"> </span><span class="c1">// warn: opened file is never closed</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">FILE</span><span class="w"> </span><span class="o">*</span><span class="n">F</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fopen</span><span class="p">(</span><span class="s">&quot;myfile.txt&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;w&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="w">    </span><span class="n">fclose</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>

<span class="w">  </span><span class="n">fclose</span><span class="p">(</span><span class="n">F</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn: closing a previously closed file stream</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="alpha-unix-cstring-bufferoverlap-c">
<span id="alpha-unix-cstring-bufferoverlap"></span><h4><a class="toc-backref" href="#id191" role="doc-backlink"><span class="section-number">1.2.10.3. </span>alpha.unix.cstring.BufferOverlap (C)</a><a class="headerlink" href="#alpha-unix-cstring-bufferoverlap-c" title="Link to this heading">¶</a></h4>
<p>Checks for overlap in two buffer arguments. Applies to:  <code class="docutils literal notranslate"><span class="pre">memcpy,</span> <span class="pre">mempcpy,</span> <span class="pre">wmemcpy,</span> <span class="pre">wmempcpy</span></code>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
<span class="w">  </span><span class="n">memcpy</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="alpha-unix-cstring-outofbounds-c">
<span id="alpha-unix-cstring-outofbounds"></span><h4><a class="toc-backref" href="#id192" role="doc-backlink"><span class="section-number">1.2.10.4. </span>alpha.unix.cstring.OutOfBounds (C)</a><a class="headerlink" href="#alpha-unix-cstring-outofbounds-c" title="Link to this heading">¶</a></h4>
<p>Check for out-of-bounds access in string functions, such as:
<code class="docutils literal notranslate"><span class="pre">memcpy,</span> <span class="pre">bcopy,</span> <span class="pre">strcpy,</span> <span class="pre">strncpy,</span> <span class="pre">strcat,</span> <span class="pre">strncat,</span> <span class="pre">memmove,</span> <span class="pre">memcmp,</span> <span class="pre">memset</span></code> and more.</p>
<p>This check also works with string literals, except there is a known bug in that
the analyzer cannot detect embedded NULL characters when determining the string length.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test1</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">str</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Hello world&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">buffer</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Hello world&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="n">memcpy</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">str</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test2</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">str</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Hello world&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">buffer</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Helloworld&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="n">memcpy</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">str</span><span class="p">));</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="alpha-unix-cstring-uninitializedread-c">
<span id="alpha-unix-cstring-uninitializedread"></span><h4><a class="toc-backref" href="#id193" role="doc-backlink"><span class="section-number">1.2.10.5. </span>alpha.unix.cstring.UninitializedRead (C)</a><a class="headerlink" href="#alpha-unix-cstring-uninitializedread-c" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>Check for uninitialized reads from common memory copy/manipulation functions such as:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">memcpy,</span> <span class="pre">mempcpy,</span> <span class="pre">memmove,</span> <span class="pre">memcmp,</span> <span class="pre">strcmp,</span> <span class="pre">strncmp,</span> <span class="pre">strcpy,</span> <span class="pre">strlen,</span> <span class="pre">strsep</span></code> and many more.</p>
</dd>
</dl>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">src</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
<span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">dst</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
<span class="w"> </span><span class="n">memcpy</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span><span class="n">src</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">dst</span><span class="p">));</span><span class="w"> </span><span class="c1">// warn: Bytes string function accesses uninitialized/garbage values</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Limitations:</p>
<blockquote>
<div><ul>
<li><p>Due to limitations of the memory modeling in the analyzer, one can likely
observe a lot of false-positive reports like this:</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">false_positive</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">src</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">};</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">dst</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
<span class="w">  </span><span class="n">memcpy</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span><span class="w"> </span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span><span class="w"> </span><span class="c1">// false-positive:</span>
<span class="w">  </span><span class="c1">// The &#39;src&#39; buffer was correctly initialized, yet we cannot conclude</span>
<span class="w">  </span><span class="c1">// that since the analyzer could not see a direct initialization of the</span>
<span class="w">  </span><span class="c1">// very last byte of the source buffer.</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>More details at the corresponding <a class="reference external" href="https://github.com/llvm/llvm-project/issues/43459">GitHub issue</a>.</p>
</li>
</ul>
</div></blockquote>
</section>
</section>
<section id="alpha-webkit">
<h3><a class="toc-backref" href="#id194" role="doc-backlink"><span class="section-number">1.2.11. </span>alpha.WebKit</a><a class="headerlink" href="#alpha-webkit" title="Link to this heading">¶</a></h3>
<section id="alpha-webkit-forwarddeclchecker">
<h4><a class="toc-backref" href="#id195" role="doc-backlink"><span class="section-number">1.2.11.1. </span>alpha.webkit.ForwardDeclChecker</a><a class="headerlink" href="#alpha-webkit-forwarddeclchecker" title="Link to this heading">¶</a></h4>
<p>Check for local variables, member variables, and function arguments that are forward declared.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">Obj</span><span class="p">;</span>
<span class="n">Obj</span><span class="o">*</span><span class="w"> </span><span class="nf">provide</span><span class="p">();</span>

<span class="k">struct</span><span class="w"> </span><span class="nc">Foo</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">Obj</span><span class="o">*</span><span class="w"> </span><span class="n">ptr</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">};</span>

<span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">foo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">Obj</span><span class="o">*</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">provide</span><span class="p">();</span><span class="w"> </span><span class="c1">// warn</span>
<span class="w">   </span><span class="n">consume</span><span class="p">(</span><span class="n">obj</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn</span>
<span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</section>
<section id="alpha-webkit-memoryunsafecastchecker">
<span id="alpha-webkit-nouncheckedptrmemberchecker"></span><h4><a class="toc-backref" href="#id196" role="doc-backlink"><span class="section-number">1.2.11.2. </span>alpha.webkit.MemoryUnsafeCastChecker</a><a class="headerlink" href="#alpha-webkit-memoryunsafecastchecker" title="Link to this heading">¶</a></h4>
<p>Check for all casts from a base type to its derived type as these might be memory-unsafe.</p>
<p>Example:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Base</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">};</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Derived</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">Base</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">};</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">Base</span><span class="o">*</span><span class="w"> </span><span class="n">base</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Derived</span><span class="o">*</span><span class="w"> </span><span class="n">derived</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">Derived</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">base</span><span class="p">);</span><span class="w"> </span><span class="c1">// ERROR</span>
<span class="p">}</span>
</pre></div>
</div>
<p>For all cast operations (C-style casts, static_cast, reinterpret_cast, dynamic_cast), if the source type a <cite>Base*</cite> and the destination type is <cite>Derived*</cite>, where <cite>Derived</cite> inherits from <cite>Base</cite>, the static analyzer should signal an error.</p>
<p>This applies to:</p>
<ul class="simple">
<li><p>C structs, C++ structs and classes, and Objective-C classes and protocols.</p></li>
<li><p>Pointers and references.</p></li>
<li><p>Inside template instantiations and macro expansions that are visible to the compiler.</p></li>
</ul>
<p>For types like this, instead of using built in casts, the programmer will use helper functions that internally perform the appropriate type check and disable static analysis.</p>
</section>
<section id="id16">
<h4><a class="toc-backref" href="#id197" role="doc-backlink"><span class="section-number">1.2.11.3. </span>alpha.webkit.NoUncheckedPtrMemberChecker</a><a class="headerlink" href="#id16" title="Link to this heading">¶</a></h4>
<p>Raw pointers and references to an object which supports CheckedPtr or CheckedRef can’t be used as class members. Only CheckedPtr, CheckedRef, RefPtr, or Ref are allowed.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">CheckableObj</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">incrementCheckedPtrCount</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">decrementCheckedPtrCount</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span>
<span class="p">};</span>

<span class="k">struct</span><span class="w"> </span><span class="nc">Foo</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">CheckableObj</span><span class="o">*</span><span class="w"> </span><span class="n">ptr</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="w">  </span><span class="n">CheckableObj</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ptr</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="w">  </span><span class="c1">// ...</span>
<span class="p">};</span>
</pre></div>
</div>
<p>See <a class="reference external" href="https://github.com/WebKit/WebKit/wiki/Safer-CPP-Guidelines">WebKit Guidelines for Safer C++ Programming</a> for details.</p>
</section>
<section id="alpha-webkit-nounretainedmemberchecker">
<h4><a class="toc-backref" href="#id198" role="doc-backlink"><span class="section-number">1.2.11.4. </span>alpha.webkit.NoUnretainedMemberChecker</a><a class="headerlink" href="#alpha-webkit-nounretainedmemberchecker" title="Link to this heading">¶</a></h4>
<p>Raw pointers and references to a NS or CF object can’t be used as class members or ivars. Only RetainPtr is allowed for CF types regardless of whether ARC is enabled or disabled. Only RetainPtr is allowed for NS types when ARC is disabled.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">Foo</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">NSObject</span><span class="w"> </span><span class="o">*</span><span class="n">ptr</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="w">  </span><span class="c1">// ...</span>
<span class="p">};</span>
</pre></div>
</div>
<p>See <a class="reference external" href="https://github.com/WebKit/WebKit/wiki/Safer-CPP-Guidelines">WebKit Guidelines for Safer C++ Programming</a> for details.</p>
</section>
<section id="alpha-webkit-unretainedlambdacaptureschecker">
<h4><a class="toc-backref" href="#id199" role="doc-backlink"><span class="section-number">1.2.11.5. </span>alpha.webkit.UnretainedLambdaCapturesChecker</a><a class="headerlink" href="#alpha-webkit-unretainedlambdacaptureschecker" title="Link to this heading">¶</a></h4>
<p>Raw pointers and references to NS or CF types can’t be captured in lambdas. Only RetainPtr is allowed for CF types regardless of whether ARC is enabled or disabled, and only RetainPtr is allowed for NS types when ARC is disabled.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">foo</span><span class="p">(</span><span class="n">NSObject</span><span class="w"> </span><span class="o">*</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">NSObject</span><span class="w"> </span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="p">[</span><span class="o">&amp;</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">](){</span><span class="w"> </span><span class="c1">// warn about &#39;a&#39;</span>
<span class="w">    </span><span class="n">do_something</span><span class="p">(</span><span class="n">b</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn about &#39;b&#39;</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">};</span>
</pre></div>
</div>
</section>
<section id="alpha-webkit-uncountedcallargschecker">
<span id="id18"></span><h4><a class="toc-backref" href="#id200" role="doc-backlink"><span class="section-number">1.2.11.6. </span>alpha.webkit.UncountedCallArgsChecker</a><a class="headerlink" href="#alpha-webkit-uncountedcallargschecker" title="Link to this heading">¶</a></h4>
<p>The goal of this rule is to make sure that lifetime of any dynamically allocated ref-countable object passed as a call argument spans past the end of the call. This applies to call to any function, method, lambda, function pointer or functor. Ref-countable types aren’t supposed to be allocated on stack so we check arguments for parameters of raw pointers and references to uncounted types.</p>
<p>Here are some examples of situations that we warn about as they <em>might</em> be potentially unsafe. The logic is that either we’re able to guarantee that an argument is safe or it’s considered if not a bug then bug-prone.</p>
<blockquote>
<div><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">RefCountable</span><span class="o">*</span><span class="w"> </span><span class="nf">provide_uncounted</span><span class="p">();</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">consume</span><span class="p">(</span><span class="n">RefCountable</span><span class="o">*</span><span class="p">);</span>

<span class="c1">// In these cases we can&#39;t make sure callee won&#39;t directly or indirectly call `deref()` on the argument which could make it unsafe from such point until the end of the call.</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">foo1</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">consume</span><span class="p">(</span><span class="n">provide_uncounted</span><span class="p">());</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">foo2</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">RefCountable</span><span class="o">*</span><span class="w"> </span><span class="n">uncounted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">provide_uncounted</span><span class="p">();</span>
<span class="w">  </span><span class="n">consume</span><span class="p">(</span><span class="n">uncounted</span><span class="p">);</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>Although we are enforcing member variables to be ref-counted by <cite>webkit.NoUncountedMemberChecker</cite> any method of the same class still has unrestricted access to these. Since from a caller’s perspective we can’t guarantee a particular member won’t get modified by callee (directly or indirectly) we don’t consider values obtained from members safe.</p>
<p>Note: It’s likely this heuristic could be made more precise with fewer false positives - for example calls to free functions that don’t have any parameter other than the pointer should be safe as the callee won’t be able to tamper with the member unless it’s a global variable.</p>
<blockquote>
<div><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">Foo</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">RefPtr</span><span class="o">&lt;</span><span class="n">RefCountable</span><span class="o">&gt;</span><span class="w"> </span><span class="n">member</span><span class="p">;</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">consume</span><span class="p">(</span><span class="n">RefCountable</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* ... */</span><span class="w"> </span><span class="p">}</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">bugprone</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">consume</span><span class="p">(</span><span class="n">member</span><span class="p">.</span><span class="n">get</span><span class="p">());</span><span class="w"> </span><span class="c1">// warn</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
</div></blockquote>
<p>The implementation of this rule is a heuristic - we define a whitelist of kinds of values that are considered safe to be passed as arguments. If we can’t prove an argument is safe it’s considered an error.</p>
<p>Allowed kinds of arguments:</p>
<ul>
<li><p>values obtained from ref-counted objects (including temporaries as those survive the call too)</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">RefCountable</span><span class="o">*</span><span class="w"> </span><span class="nf">provide_uncounted</span><span class="p">();</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">consume</span><span class="p">(</span><span class="n">RefCountable</span><span class="o">*</span><span class="p">);</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">foo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">RefPtr</span><span class="o">&lt;</span><span class="n">RefCountable</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">makeRef</span><span class="p">(</span><span class="n">provide_uncounted</span><span class="p">());</span>
<span class="w">  </span><span class="n">consume</span><span class="p">(</span><span class="n">rc</span><span class="p">.</span><span class="n">get</span><span class="p">());</span><span class="w"> </span><span class="c1">// ok</span>
<span class="w">  </span><span class="n">consume</span><span class="p">(</span><span class="n">makeRef</span><span class="p">(</span><span class="n">provide_uncounted</span><span class="p">()).</span><span class="n">get</span><span class="p">());</span><span class="w"> </span><span class="c1">// ok</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p>forwarding uncounted arguments from caller to callee</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">foo</span><span class="p">(</span><span class="n">RefCountable</span><span class="o">&amp;</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">bar</span><span class="p">(</span><span class="n">a</span><span class="p">);</span><span class="w"> </span><span class="c1">// ok</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Caller of <code class="docutils literal notranslate"><span class="pre">foo()</span></code> is responsible for  <code class="docutils literal notranslate"><span class="pre">a</span></code>’s lifetime.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">this</span></code> pointer</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">Foo::foo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">baz</span><span class="p">(</span><span class="k">this</span><span class="p">);</span><span class="w">  </span><span class="c1">// ok</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Caller of <code class="docutils literal notranslate"><span class="pre">foo()</span></code> is responsible for keeping the memory pointed to by <code class="docutils literal notranslate"><span class="pre">this</span></code> pointer safe.</p>
</li>
<li><p>constants</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">foo</span><span class="p">(</span><span class="k">nullptr</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="c1">// ok</span>
</pre></div>
</div>
</li>
</ul>
<p>We also define a set of safe transformations which if passed a safe value as an input provide (usually it’s the return value) a safe value (or an object that provides safe values). This is also a heuristic.</p>
<ul class="simple">
<li><p>constructors of ref-counted types (including factory methods)</p></li>
<li><p>getters of ref-counted types</p></li>
<li><p>member overloaded operators</p></li>
<li><p>casts</p></li>
<li><p>unary operators like <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> or <code class="docutils literal notranslate"><span class="pre">*</span></code></p></li>
</ul>
</section>
<section id="alpha-webkit-uncheckedcallargschecker">
<h4><a class="toc-backref" href="#id201" role="doc-backlink"><span class="section-number">1.2.11.7. </span>alpha.webkit.UncheckedCallArgsChecker</a><a class="headerlink" href="#alpha-webkit-uncheckedcallargschecker" title="Link to this heading">¶</a></h4>
<p>The goal of this rule is to make sure that lifetime of any dynamically allocated CheckedPtr capable object passed as a call argument keeps its memory region past the end of the call. This applies to call to any function, method, lambda, function pointer or functor. CheckedPtr capable objects aren’t supposed to be allocated on stack so we check arguments for parameters of raw pointers and references to unchecked types.</p>
<p>The rules of when to use and not to use CheckedPtr / CheckedRef are same as alpha.webkit.UncountedCallArgsChecker for ref-counted objects.</p>
</section>
<section id="alpha-webkit-unretainedcallargschecker">
<h4><a class="toc-backref" href="#id202" role="doc-backlink"><span class="section-number">1.2.11.8. </span>alpha.webkit.UnretainedCallArgsChecker</a><a class="headerlink" href="#alpha-webkit-unretainedcallargschecker" title="Link to this heading">¶</a></h4>
<p>The goal of this rule is to make sure that lifetime of any dynamically allocated NS or CF objects passed as a call argument keeps its memory region past the end of the call. This applies to call to any function, method, lambda, function pointer or functor. NS or CF objects aren’t supposed to be allocated on stack so we check arguments for parameters of raw pointers and references to unretained types.</p>
<p>The rules of when to use and not to use RetainPtr are same as alpha.webkit.UncountedCallArgsChecker for ref-counted objects.</p>
</section>
<section id="alpha-webkit-uncountedlocalvarschecker">
<h4><a class="toc-backref" href="#id203" role="doc-backlink"><span class="section-number">1.2.11.9. </span>alpha.webkit.UncountedLocalVarsChecker</a><a class="headerlink" href="#alpha-webkit-uncountedlocalvarschecker" title="Link to this heading">¶</a></h4>
<p>The goal of this rule is to make sure that any uncounted local variable is backed by a ref-counted object with lifetime that is strictly larger than the scope of the uncounted local variable. To be on the safe side we require the scope of an uncounted variable to be embedded in the scope of ref-counted object that backs it.</p>
<p>These are examples of cases that we consider safe:</p>
<blockquote>
<div><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">foo1</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">RefPtr</span><span class="o">&lt;</span><span class="n">RefCountable</span><span class="o">&gt;</span><span class="w"> </span><span class="n">counted</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// The scope of uncounted is EMBEDDED in the scope of counted.</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">RefCountable</span><span class="o">*</span><span class="w"> </span><span class="n">uncounted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">counted</span><span class="p">.</span><span class="n">get</span><span class="p">();</span><span class="w"> </span><span class="c1">// ok</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">foo2</span><span class="p">(</span><span class="n">RefPtr</span><span class="o">&lt;</span><span class="n">RefCountable</span><span class="o">&gt;</span><span class="w"> </span><span class="n">counted_param</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">RefCountable</span><span class="o">*</span><span class="w"> </span><span class="n">uncounted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">counted_param</span><span class="p">.</span><span class="n">get</span><span class="p">();</span><span class="w"> </span><span class="c1">// ok</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">FooClass::foo_method</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">RefCountable</span><span class="o">*</span><span class="w"> </span><span class="n">uncounted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">;</span><span class="w"> </span><span class="c1">// ok</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>Here are some examples of situations that we warn about as they <em>might</em> be potentially unsafe. The logic is that either we’re able to guarantee that a local variable is safe or it’s considered unsafe.</p>
<blockquote>
<div><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">foo1</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">RefCountable</span><span class="o">*</span><span class="w"> </span><span class="n">uncounted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RefCountable</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>

<span class="n">RefCountable</span><span class="o">*</span><span class="w"> </span><span class="n">global_uncounted</span><span class="p">;</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">foo2</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">RefCountable</span><span class="o">*</span><span class="w"> </span><span class="n">uncounted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">global_uncounted</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">foo3</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">RefPtr</span><span class="o">&lt;</span><span class="n">RefCountable</span><span class="o">&gt;</span><span class="w"> </span><span class="n">counted</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// The scope of uncounted is not EMBEDDED in the scope of counted.</span>
<span class="w">  </span><span class="n">RefCountable</span><span class="o">*</span><span class="w"> </span><span class="n">uncounted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">counted</span><span class="p">.</span><span class="n">get</span><span class="p">();</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="alpha-webkit-uncheckedlocalvarschecker">
<h4><a class="toc-backref" href="#id204" role="doc-backlink"><span class="section-number">1.2.11.10. </span>alpha.webkit.UncheckedLocalVarsChecker</a><a class="headerlink" href="#alpha-webkit-uncheckedlocalvarschecker" title="Link to this heading">¶</a></h4>
<p>The goal of this rule is to make sure that any unchecked local variable is backed by a CheckedPtr or CheckedRef with lifetime that is strictly larger than the scope of the unchecked local variable. To be on the safe side we require the scope of an unchecked variable to be embedded in the scope of CheckedPtr/CheckRef object that backs it.</p>
<p>These are examples of cases that we consider safe:</p>
<blockquote>
<div><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">foo1</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">CheckedPtr</span><span class="o">&lt;</span><span class="n">RefCountable</span><span class="o">&gt;</span><span class="w"> </span><span class="n">counted</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// The scope of uncounted is EMBEDDED in the scope of counted.</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">RefCountable</span><span class="o">*</span><span class="w"> </span><span class="n">uncounted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">counted</span><span class="p">.</span><span class="n">get</span><span class="p">();</span><span class="w"> </span><span class="c1">// ok</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">foo2</span><span class="p">(</span><span class="n">CheckedPtr</span><span class="o">&lt;</span><span class="n">RefCountable</span><span class="o">&gt;</span><span class="w"> </span><span class="n">counted_param</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">RefCountable</span><span class="o">*</span><span class="w"> </span><span class="n">uncounted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">counted_param</span><span class="p">.</span><span class="n">get</span><span class="p">();</span><span class="w"> </span><span class="c1">// ok</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">FooClass::foo_method</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">RefCountable</span><span class="o">*</span><span class="w"> </span><span class="n">uncounted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">;</span><span class="w"> </span><span class="c1">// ok</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>Here are some examples of situations that we warn about as they <em>might</em> be potentially unsafe. The logic is that either we’re able to guarantee that a local variable is safe or it’s considered unsafe.</p>
<blockquote>
<div><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">foo1</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">RefCountable</span><span class="o">*</span><span class="w"> </span><span class="n">uncounted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RefCountable</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>

<span class="n">RefCountable</span><span class="o">*</span><span class="w"> </span><span class="n">global_uncounted</span><span class="p">;</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">foo2</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">RefCountable</span><span class="o">*</span><span class="w"> </span><span class="n">uncounted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">global_uncounted</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">foo3</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">RefPtr</span><span class="o">&lt;</span><span class="n">RefCountable</span><span class="o">&gt;</span><span class="w"> </span><span class="n">counted</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// The scope of uncounted is not EMBEDDED in the scope of counted.</span>
<span class="w">  </span><span class="n">RefCountable</span><span class="o">*</span><span class="w"> </span><span class="n">uncounted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">counted</span><span class="p">.</span><span class="n">get</span><span class="p">();</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="alpha-webkit-unretainedlocalvarschecker">
<h4><a class="toc-backref" href="#id205" role="doc-backlink"><span class="section-number">1.2.11.11. </span>alpha.webkit.UnretainedLocalVarsChecker</a><a class="headerlink" href="#alpha-webkit-unretainedlocalvarschecker" title="Link to this heading">¶</a></h4>
<p>The goal of this rule is to make sure that any NS or CF local variable is backed by a RetainPtr with lifetime that is strictly larger than the scope of the unretained local variable. To be on the safe side we require the scope of an unretained variable to be embedded in the scope of Retainptr object that backs it.</p>
<p>The rules of when to use and not to use RetainPtr are same as alpha.webkit.UncountedCallArgsChecker for ref-counted objects.</p>
<p>These are examples of cases that we consider safe:</p>
<blockquote>
<div><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">foo1</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">RetainPtr</span><span class="o">&lt;</span><span class="n">NSObject</span><span class="o">&gt;</span><span class="w"> </span><span class="n">retained</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// The scope of unretained is EMBEDDED in the scope of retained.</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">NSObject</span><span class="o">*</span><span class="w"> </span><span class="n">unretained</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">retained</span><span class="p">.</span><span class="n">get</span><span class="p">();</span><span class="w"> </span><span class="c1">// ok</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">foo2</span><span class="p">(</span><span class="n">RetainPtr</span><span class="o">&lt;</span><span class="n">NSObject</span><span class="o">&gt;</span><span class="w"> </span><span class="n">retained_param</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">NSObject</span><span class="o">*</span><span class="w"> </span><span class="n">unretained</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">retained_param</span><span class="p">.</span><span class="n">get</span><span class="p">();</span><span class="w"> </span><span class="c1">// ok</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">FooClass::foo_method</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">NSObject</span><span class="o">*</span><span class="w"> </span><span class="n">unretained</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">;</span><span class="w"> </span><span class="c1">// ok</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>Here are some examples of situations that we warn about as they <em>might</em> be potentially unsafe. The logic is that either we’re able to guarantee that a local variable is safe or it’s considered unsafe.</p>
<blockquote>
<div><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">foo1</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">NSObject</span><span class="o">*</span><span class="w"> </span><span class="n">unretained</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">NSObject</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">init</span><span class="p">];</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>

<span class="n">NSObject</span><span class="o">*</span><span class="w"> </span><span class="n">global_unretained</span><span class="p">;</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">foo2</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">NSObject</span><span class="o">*</span><span class="w"> </span><span class="n">unretained</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">global_unretained</span><span class="p">;</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">foo3</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">RetainPtr</span><span class="o">&lt;</span><span class="n">NSObject</span><span class="o">&gt;</span><span class="w"> </span><span class="n">retained</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// The scope of unretained is not EMBEDDED in the scope of retained.</span>
<span class="w">  </span><span class="n">NSObject</span><span class="o">*</span><span class="w"> </span><span class="n">unretained</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">retained</span><span class="p">.</span><span class="n">get</span><span class="p">();</span><span class="w"> </span><span class="c1">// warn</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="webkit-retainptrctoradoptchecker">
<h4><a class="toc-backref" href="#id206" role="doc-backlink"><span class="section-number">1.2.11.12. </span>webkit.RetainPtrCtorAdoptChecker</a><a class="headerlink" href="#webkit-retainptrctoradoptchecker" title="Link to this heading">¶</a></h4>
<p>The goal of this rule is to make sure the constructor of RetainPtr as well as adoptNS and adoptCF are used correctly.
When creating a RetainPtr with +1 semantics, adoptNS or adoptCF should be used, and in +0 semantics, RetainPtr constructor should be used.
Warn otherwise.</p>
<p>These are examples of cases that we consider correct:</p>
<blockquote>
<div><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">RetainPtr</span><span class="w"> </span><span class="n">ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">adoptNS</span><span class="p">([[</span><span class="n">NSObject</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">init</span><span class="p">]);</span><span class="w"> </span><span class="c1">// ok</span>
<span class="n">RetainPtr</span><span class="w"> </span><span class="n">ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CGImageGetColorSpace</span><span class="p">(</span><span class="n">image</span><span class="p">);</span><span class="w"> </span><span class="c1">// ok</span>
</pre></div>
</div>
</div></blockquote>
<p>Here are some examples of cases that we consider incorrect use of RetainPtr constructor and adoptCF</p>
<blockquote>
<div><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">RetainPtr</span><span class="w"> </span><span class="n">ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">NSObject</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">init</span><span class="p">];</span><span class="w"> </span><span class="c1">// warn</span>
<span class="k">auto</span><span class="w"> </span><span class="n">ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">adoptCF</span><span class="p">(</span><span class="n">CGImageGetColorSpace</span><span class="p">(</span><span class="n">image</span><span class="p">));</span><span class="w"> </span><span class="c1">// warn</span>
</pre></div>
</div>
</div></blockquote>
</section>
</section>
</section>
<section id="debug-checkers">
<h2><a class="toc-backref" href="#id207" role="doc-backlink"><span class="section-number">1.3. </span>Debug Checkers</a><a class="headerlink" href="#debug-checkers" title="Link to this heading">¶</a></h2>
<section id="debug">
<span id="id19"></span><h3><a class="toc-backref" href="#id208" role="doc-backlink"><span class="section-number">1.3.1. </span>debug</a><a class="headerlink" href="#debug" title="Link to this heading">¶</a></h3>
<p>Checkers used for debugging the analyzer.
<a class="reference internal" href="developer-docs/DebugChecks.html"><span class="doc">Debug Checks</span></a> page contains a detailed description.</p>
<section id="debug-analysisorder">
<span id="id20"></span><h4><a class="toc-backref" href="#id209" role="doc-backlink"><span class="section-number">1.3.1.1. </span>debug.AnalysisOrder</a><a class="headerlink" href="#debug-analysisorder" title="Link to this heading">¶</a></h4>
<p>Print callbacks that are called during analysis in order.</p>
</section>
<section id="debug-configdumper">
<span id="id21"></span><h4><a class="toc-backref" href="#id210" role="doc-backlink"><span class="section-number">1.3.1.2. </span>debug.ConfigDumper</a><a class="headerlink" href="#debug-configdumper" title="Link to this heading">¶</a></h4>
<p>Dump config table.</p>
</section>
<section id="debug-dumpcfg-display">
<span id="id22"></span><h4><a class="toc-backref" href="#id211" role="doc-backlink"><span class="section-number">1.3.1.3. </span>debug.DumpCFG Display</a><a class="headerlink" href="#debug-dumpcfg-display" title="Link to this heading">¶</a></h4>
<p>Control-Flow Graphs.</p>
</section>
<section id="debug-dumpcallgraph">
<span id="id23"></span><h4><a class="toc-backref" href="#id212" role="doc-backlink"><span class="section-number">1.3.1.4. </span>debug.DumpCallGraph</a><a class="headerlink" href="#debug-dumpcallgraph" title="Link to this heading">¶</a></h4>
<p>Display Call Graph.</p>
</section>
<section id="debug-dumpcalls">
<span id="id24"></span><h4><a class="toc-backref" href="#id213" role="doc-backlink"><span class="section-number">1.3.1.5. </span>debug.DumpCalls</a><a class="headerlink" href="#debug-dumpcalls" title="Link to this heading">¶</a></h4>
<p>Print calls as they are traversed by the engine.</p>
</section>
<section id="debug-dumpdominators">
<span id="id25"></span><h4><a class="toc-backref" href="#id214" role="doc-backlink"><span class="section-number">1.3.1.6. </span>debug.DumpDominators</a><a class="headerlink" href="#debug-dumpdominators" title="Link to this heading">¶</a></h4>
<p>Print the dominance tree for a given CFG.</p>
</section>
<section id="debug-dumplivevars">
<span id="id26"></span><h4><a class="toc-backref" href="#id215" role="doc-backlink"><span class="section-number">1.3.1.7. </span>debug.DumpLiveVars</a><a class="headerlink" href="#debug-dumplivevars" title="Link to this heading">¶</a></h4>
<p>Print results of live variable analysis.</p>
</section>
<section id="debug-dumptraversal">
<span id="id27"></span><h4><a class="toc-backref" href="#id216" role="doc-backlink"><span class="section-number">1.3.1.8. </span>debug.DumpTraversal</a><a class="headerlink" href="#debug-dumptraversal" title="Link to this heading">¶</a></h4>
<p>Print branch conditions as they are traversed by the engine.</p>
</section>
<section id="debug-exprinspection">
<span id="id28"></span><h4><a class="toc-backref" href="#id217" role="doc-backlink"><span class="section-number">1.3.1.9. </span>debug.ExprInspection</a><a class="headerlink" href="#debug-exprinspection" title="Link to this heading">¶</a></h4>
<p>Check the analyzer’s understanding of expressions.</p>
</section>
<section id="debug-stats">
<span id="id29"></span><h4><a class="toc-backref" href="#id218" role="doc-backlink"><span class="section-number">1.3.1.10. </span>debug.Stats</a><a class="headerlink" href="#debug-stats" title="Link to this heading">¶</a></h4>
<p>Emit warnings with analyzer statistics.</p>
</section>
<section id="debug-tainttest">
<span id="id30"></span><h4><a class="toc-backref" href="#id219" role="doc-backlink"><span class="section-number">1.3.1.11. </span>debug.TaintTest</a><a class="headerlink" href="#debug-tainttest" title="Link to this heading">¶</a></h4>
<p>Mark tainted symbols as such.</p>
</section>
<section id="debug-viewcfg">
<span id="id31"></span><h4><a class="toc-backref" href="#id220" role="doc-backlink"><span class="section-number">1.3.1.12. </span>debug.ViewCFG</a><a class="headerlink" href="#debug-viewcfg" title="Link to this heading">¶</a></h4>
<p>View Control-Flow Graphs using GraphViz.</p>
</section>
<section id="debug-viewcallgraph">
<span id="id32"></span><h4><a class="toc-backref" href="#id221" role="doc-backlink"><span class="section-number">1.3.1.13. </span>debug.ViewCallGraph</a><a class="headerlink" href="#debug-viewcallgraph" title="Link to this heading">¶</a></h4>
<p>View Call Graph using GraphViz.</p>
</section>
<section id="debug-viewexplodedgraph">
<span id="id33"></span><h4><a class="toc-backref" href="#id222" role="doc-backlink"><span class="section-number">1.3.1.14. </span>debug.ViewExplodedGraph</a><a class="headerlink" href="#debug-viewexplodedgraph" title="Link to this heading">¶</a></h4>
<p>View Exploded Graphs using GraphViz.</p>
</section>
</section>
</section>
</section>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="../ClangStaticAnalyzer.html">Clang Static Analyzer</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="user-docs.html"><span class="section-number">2. </span>User Docs</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer" role="contentinfo">
    &#169; Copyright 2007-2025, The Clang Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>