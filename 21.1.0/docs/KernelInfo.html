
<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>KernelInfo &#8212; LLVM 21.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=649a27d8" />
    <link rel="stylesheet" type="text/css" href="_static/llvm-theme.css?v=96924833" />
    <script src="_static/documentation_options.js?v=c54a4614"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="LLVM CoC Incident Reporting Guide" href="ReportingGuide.html" />
    <link rel="prev" title="LLVM’s Analysis and Transform Passes" href="Passes.html" />
<style type="text/css">
  table.right { float: right; margin-left: 20px; }
  table.right td { border: 1px solid #ccc; }
</style>

  </head><body>
<div class="logo">
  <a href="index.html">
    <img src="_static/logo.png"
         alt="LLVM Logo" width="250" height="88"/></a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="ReportingGuide.html" title="LLVM CoC Incident Reporting Guide"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="Passes.html" title="LLVM’s Analysis and Transform Passes"
             accesskey="P">previous</a> |</li>
  <li><a href="https://llvm.org/">LLVM Home</a>&nbsp;|&nbsp;</li>
  <li><a href="index.html">Documentation</a>&raquo;</li>

          <li class="nav-item nav-item-1"><a href="UserGuides.html" >User Guides</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="Passes.html" accesskey="U">LLVM’s Analysis and Transform Passes</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">KernelInfo</a></li> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">

<h3>Documentation</h3>

<ul class="want-points">
    <li><a href="https://llvm.org/docs/GettingStartedTutorials.html">Getting Started/Tutorials</a></li>
    <li><a href="https://llvm.org/docs/UserGuides.html">User Guides</a></li>
    <li><a href="https://llvm.org/docs/Reference.html">Reference</a></li>
</ul>

<h3>Getting Involved</h3>

<ul class="want-points">
    <li><a href="https://llvm.org/docs/Contributing.html">Contributing to LLVM</a></li>
    <li><a href="https://llvm.org/docs/HowToSubmitABug.html">Submitting Bug Reports</a></li>
    <li><a href="https://llvm.org/docs/GettingInvolved.html#mailing-lists">Mailing Lists</a></li>
    <li><a href="https://llvm.org/docs/GettingInvolved.html#discord">Discord</a></li>
    <li><a href="https://llvm.org/docs/GettingInvolved.html#meetups-and-social-events">Meetups and Social Events</a></li>
</ul>

<h3>Additional Links</h3>

<ul class="want-points">
    <li><a href="https://llvm.org/docs/FAQ.html">FAQ</a></li>
    <li><a href="https://llvm.org/docs/Lexicon.html">Glossary</a></li>
    <li><a href="https://llvm.org/pubs">Publications</a></li>
    <li><a href="https://github.com/llvm/llvm-project/">Github Repository</a></li>
</ul>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/KernelInfo.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="kernelinfo">
<h1>KernelInfo<a class="headerlink" href="#kernelinfo" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id1">Introduction</a></p></li>
<li><p><a class="reference internal" href="#example-command-lines" id="id2">Example Command Lines</a></p></li>
</ul>
</nav>
<section id="introduction">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>This LLVM IR pass reports various statistics for codes compiled for GPUs.  The
goal of these statistics is to help identify bad code patterns and ways to
mitigate them.  The pass operates at the LLVM IR level so that it can, in
theory, support any LLVM-based compiler for programming languages supporting
GPUs.</p>
<p>By default, the pass runs at the end of LTO, and options like
<code class="docutils literal notranslate"><span class="pre">-Rpass=kernel-info</span></code> enable its remarks.  Example <code class="docutils literal notranslate"><span class="pre">opt</span></code> and <code class="docutils literal notranslate"><span class="pre">clang</span></code>
command lines appear in the next section.</p>
<p>Remarks include summary statistics (e.g., total size of static allocas) and
individual occurrences (e.g., source location of each alloca).  Examples of the
output appear in tests in <cite>llvm/test/Analysis/KernelInfo</cite>.</p>
</section>
<section id="example-command-lines">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Example Command Lines</a><a class="headerlink" href="#example-command-lines" title="Link to this heading">¶</a></h2>
<p>To analyze a C program as it appears to an LLVM GPU backend at the end of LTO:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>clang<span class="w"> </span>-O2<span class="w"> </span>-g<span class="w"> </span>-fopenmp<span class="w"> </span>--offload-arch<span class="o">=</span>native<span class="w"> </span>test.c<span class="w"> </span>-foffload-lto<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-Rpass<span class="o">=</span>kernel-info
</pre></div>
</div>
<p>To analyze specified LLVM IR, perhaps previously generated by something like
<code class="docutils literal notranslate"><span class="pre">clang</span> <span class="pre">-save-temps</span> <span class="pre">-g</span> <span class="pre">-fopenmp</span> <span class="pre">--offload-arch=native</span> <span class="pre">test.c</span></code>:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>opt<span class="w"> </span>-disable-output<span class="w"> </span>test-openmp-nvptx64-nvidia-cuda-sm_70.bc<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-pass-remarks<span class="o">=</span>kernel-info<span class="w"> </span>-passes<span class="o">=</span>kernel-info
</pre></div>
</div>
<p>When specifying an LLVM pass pipeline on the command line, <code class="docutils literal notranslate"><span class="pre">kernel-info</span></code> still
runs at the end of LTO by default.  <code class="docutils literal notranslate"><span class="pre">-no-kernel-info-end-lto</span></code> disables that
behavior so you can position <code class="docutils literal notranslate"><span class="pre">kernel-info</span></code> explicitly:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>clang<span class="w"> </span>-O2<span class="w"> </span>-g<span class="w"> </span>-fopenmp<span class="w"> </span>--offload-arch<span class="o">=</span>native<span class="w"> </span>test.c<span class="w"> </span>-foffload-lto<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-Rpass<span class="o">=</span>kernel-info<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-Xoffload-linker<span class="w"> </span>--lto-newpm-passes<span class="o">=</span><span class="s1">&#39;lto&lt;O2&gt;&#39;</span>

$<span class="w"> </span>clang<span class="w"> </span>-O2<span class="w"> </span>-g<span class="w"> </span>-fopenmp<span class="w"> </span>--offload-arch<span class="o">=</span>native<span class="w"> </span>test.c<span class="w"> </span>-foffload-lto<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-Rpass<span class="o">=</span>kernel-info<span class="w"> </span>-mllvm<span class="w"> </span>-no-kernel-info-end-lto<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-Xoffload-linker<span class="w"> </span>--lto-newpm-passes<span class="o">=</span><span class="s1">&#39;module(kernel-info),lto&lt;O2&gt;&#39;</span>

$<span class="w"> </span>opt<span class="w"> </span>-disable-output<span class="w"> </span>test-openmp-nvptx64-nvidia-cuda-sm_70.bc<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-pass-remarks<span class="o">=</span>kernel-info<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-passes<span class="o">=</span><span class="s1">&#39;lto&lt;O2&gt;&#39;</span>

$<span class="w"> </span>opt<span class="w"> </span>-disable-output<span class="w"> </span>test-openmp-nvptx64-nvidia-cuda-sm_70.bc<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-pass-remarks<span class="o">=</span>kernel-info<span class="w"> </span>-no-kernel-info-end-lto<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-passes<span class="o">=</span><span class="s1">&#39;module(kernel-info),lto&lt;O2&gt;&#39;</span>
</pre></div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="ReportingGuide.html" title="LLVM CoC Incident Reporting Guide"
             >next</a> |</li>
        <li class="right" >
          <a href="Passes.html" title="LLVM’s Analysis and Transform Passes"
             >previous</a> |</li>
  <li><a href="https://llvm.org/">LLVM Home</a>&nbsp;|&nbsp;</li>
  <li><a href="index.html">Documentation</a>&raquo;</li>

          <li class="nav-item nav-item-1"><a href="UserGuides.html" >User Guides</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="Passes.html" >LLVM’s Analysis and Transform Passes</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">KernelInfo</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2003-2025, LLVM Project.
      Last updated on 2025-08-26.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>