
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Clang 12.0.0 (In-Progress) Release Notes &#8212; Clang 12 documentation</title>
    <link rel="stylesheet" href="_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Clang Compiler User’s Manual" href="UsersManual.html" />
    <link rel="prev" title="Using Clang as a Compiler" href="index.html" /> 
  </head><body>
      <div class="header" role="banner"><h1 class="heading"><a href="index.html">
          <span>Clang 12 documentation</span></a></h1>
        <h2 class="heading"><span>Clang 12.0.0 (In-Progress) Release Notes</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="index.html">Using Clang as a Compiler</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="UsersManual.html">Clang Compiler User’s Manual</a>&#160;&#160;»
        </p>

      </div>
      <div class="content" role="main">
        
        
  <div class="section" id="clang-12-0-0-in-progress-release-notes">
<h1>Clang 12.0.0 (In-Progress) Release Notes<a class="headerlink" href="#clang-12-0-0-in-progress-release-notes" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id2">Introduction</a></p></li>
<li><p><a class="reference internal" href="#what-s-new-in-clang-12-0-0" id="id3">What’s New in Clang 12.0.0?</a></p>
<ul>
<li><p><a class="reference internal" href="#major-new-features" id="id4">Major New Features</a></p></li>
<li><p><a class="reference internal" href="#non-comprehensive-list-of-changes-in-this-release" id="id5">Non-comprehensive list of changes in this release</a></p></li>
<li><p><a class="reference internal" href="#new-compiler-flags" id="id6">New Compiler Flags</a></p></li>
<li><p><a class="reference internal" href="#deprecated-compiler-flags" id="id7">Deprecated Compiler Flags</a></p></li>
<li><p><a class="reference internal" href="#modified-compiler-flags" id="id8">Modified Compiler Flags</a></p></li>
<li><p><a class="reference internal" href="#removed-compiler-flags" id="id9">Removed Compiler Flags</a></p></li>
<li><p><a class="reference internal" href="#new-pragmas-in-clang" id="id10">New Pragmas in Clang</a></p></li>
<li><p><a class="reference internal" href="#modified-pragmas-in-clang" id="id11">Modified Pragmas in Clang</a></p></li>
<li><p><a class="reference internal" href="#attribute-changes-in-clang" id="id12">Attribute Changes in Clang</a></p></li>
<li><p><a class="reference internal" href="#windows-support" id="id13">Windows Support</a></p></li>
<li><p><a class="reference internal" href="#c-language-changes-in-clang" id="id14">C Language Changes in Clang</a></p></li>
<li><p><a class="reference internal" href="#id1" id="id15">C++ Language Changes in Clang</a></p></li>
<li><p><a class="reference internal" href="#objective-c-language-changes-in-clang" id="id16">Objective-C Language Changes in Clang</a></p></li>
<li><p><a class="reference internal" href="#opencl-kernel-language-changes-in-clang" id="id17">OpenCL Kernel Language Changes in Clang</a></p></li>
<li><p><a class="reference internal" href="#abi-changes-in-clang" id="id18">ABI Changes in Clang</a></p></li>
<li><p><a class="reference internal" href="#openmp-support-in-clang" id="id19">OpenMP Support in Clang</a></p></li>
<li><p><a class="reference internal" href="#cuda-support-in-clang" id="id20">CUDA Support in Clang</a></p></li>
<li><p><a class="reference internal" href="#x86-support-in-clang" id="id21">X86 Support in Clang</a></p></li>
<li><p><a class="reference internal" href="#internal-api-changes" id="id22">Internal API Changes</a></p></li>
<li><p><a class="reference internal" href="#build-system-changes" id="id23">Build System Changes</a></p></li>
<li><p><a class="reference internal" href="#ast-matchers" id="id24">AST Matchers</a></p></li>
<li><p><a class="reference internal" href="#clang-format" id="id25">clang-format</a></p></li>
<li><p><a class="reference internal" href="#libclang" id="id26">libclang</a></p></li>
<li><p><a class="reference internal" href="#static-analyzer" id="id27">Static Analyzer</a></p></li>
<li><p><a class="reference internal" href="#undefined-behavior-sanitizer-ubsan" id="id28">Undefined Behavior Sanitizer (UBSan)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#core-analysis-improvements" id="id29">Core Analysis Improvements</a></p></li>
<li><p><a class="reference internal" href="#new-issues-found" id="id30">New Issues Found</a></p>
<ul>
<li><p><a class="reference internal" href="#python-binding-changes" id="id31">Python Binding Changes</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#significant-known-problems" id="id32">Significant Known Problems</a></p></li>
<li><p><a class="reference internal" href="#additional-information" id="id33">Additional Information</a></p></li>
</ul>
</div>
<p>Written by the <a class="reference external" href="https://llvm.org/">LLVM Team</a></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>These are in-progress notes for the upcoming Clang 12 release.
Release notes for previous releases can be found on
<a class="reference external" href="https://releases.llvm.org/download.html">the Download Page</a>.</p>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id2">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>This document contains the release notes for the Clang C/C++/Objective-C
frontend, part of the LLVM Compiler Infrastructure, release 12.0.0. Here we
describe the status of Clang in some detail, including major
improvements from the previous release and new feature work. For the
general LLVM release notes, see <a class="reference external" href="https://llvm.org/docs/ReleaseNotes.html">the LLVM
documentation</a>. All LLVM
releases may be downloaded from the <a class="reference external" href="https://llvm.org/releases/">LLVM releases web
site</a>.</p>
<p>For more information about Clang or LLVM, including information about the
latest release, please see the <a class="reference external" href="https://clang.llvm.org">Clang Web Site</a> or the
<a class="reference external" href="https://llvm.org">LLVM Web Site</a>.</p>
<p>Note that if you are reading this file from a Git checkout or the
main Clang web page, this document applies to the <em>next</em> release, not
the current one. To see the release notes for a specific release, please
see the <a class="reference external" href="https://llvm.org/releases/">releases page</a>.</p>
</div>
<div class="section" id="what-s-new-in-clang-12-0-0">
<h2><a class="toc-backref" href="#id3">What’s New in Clang 12.0.0?</a><a class="headerlink" href="#what-s-new-in-clang-12-0-0" title="Permalink to this headline">¶</a></h2>
<p>Some of the major new features and improvements to Clang are listed
here. Generic improvements to Clang as a whole or to its underlying
infrastructure are described first, followed by language-specific
sections with improvements to Clang’s support for those languages.</p>
<div class="section" id="major-new-features">
<h3><a class="toc-backref" href="#id4">Major New Features</a><a class="headerlink" href="#major-new-features" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>…</p></li>
</ul>
<div class="section" id="improvements-to-clang-s-diagnostics">
<h4>Improvements to Clang’s diagnostics<a class="headerlink" href="#improvements-to-clang-s-diagnostics" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>…</p></li>
</ul>
</div>
</div>
<div class="section" id="non-comprehensive-list-of-changes-in-this-release">
<h3><a class="toc-backref" href="#id5">Non-comprehensive list of changes in this release</a><a class="headerlink" href="#non-comprehensive-list-of-changes-in-this-release" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>The builtin intrinsics <code class="docutils literal notranslate"><span class="pre">__builtin_bitreverse8</span></code>, <code class="docutils literal notranslate"><span class="pre">__builtin_bitreverse16</span></code>,
<code class="docutils literal notranslate"><span class="pre">__builtin_bitreverse32</span></code> and <code class="docutils literal notranslate"><span class="pre">__builtin_bitreverse64</span></code> may now be used
within constant expressions.</p></li>
<li><p>The builtin intrinsics <code class="docutils literal notranslate"><span class="pre">__builtin_rotateleft8</span></code>, <code class="docutils literal notranslate"><span class="pre">__builtin_rotateleft16</span></code>,
<code class="docutils literal notranslate"><span class="pre">__builtin_rotateleft32</span></code> and <code class="docutils literal notranslate"><span class="pre">__builtin_rotateleft64</span></code> may now be used
within constant expressions.</p></li>
<li><p>The builtin intrinsics <code class="docutils literal notranslate"><span class="pre">__builtin_rotateright8</span></code>, <code class="docutils literal notranslate"><span class="pre">__builtin_rotateright16</span></code>,
<code class="docutils literal notranslate"><span class="pre">__builtin_rotateright32</span></code> and <code class="docutils literal notranslate"><span class="pre">__builtin_rotateright64</span></code> may now be used
within constant expressions.</p></li>
</ul>
</div>
<div class="section" id="new-compiler-flags">
<h3><a class="toc-backref" href="#id6">New Compiler Flags</a><a class="headerlink" href="#new-compiler-flags" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>…</p></li>
<li><p>AArch64 options <code class="docutils literal notranslate"><span class="pre">-moutline-atomics</span></code>, <code class="docutils literal notranslate"><span class="pre">-mno-outline-atomics</span></code> to enable
and disable calls to helper functions implementing atomic operations. These
out-of-line helpers like ‘__aarch64_cas8_relax’ will detect at runtime
AArch64 Large System Extensions (LSE) availability and either use their
atomic instructions, or falls back to LL/SC loop. These options do not apply
if the compilation target supports LSE. Atomic instructions are used directly
in that case. The option’s behaviour mirrors GCC, the helpers are implemented
both in compiler-rt and libgcc.</p></li>
<li><p>New option <code class="docutils literal notranslate"><span class="pre">-fbinutils-version=</span></code> specifies the targeted binutils version.
For example, <code class="docutils literal notranslate"><span class="pre">-fbinutils-version=2.35</span></code> means compatibility with GNU as/ld
before 2.35 is not needed: new features can be used and there is no need to
work around old GNU as/ld bugs.</p></li>
</ul>
</div>
<div class="section" id="deprecated-compiler-flags">
<h3><a class="toc-backref" href="#id7">Deprecated Compiler Flags</a><a class="headerlink" href="#deprecated-compiler-flags" title="Permalink to this headline">¶</a></h3>
<p>The following options are deprecated and ignored. They will be removed in
future versions of Clang.</p>
<ul class="simple">
<li><p>The clang-cl <code class="docutils literal notranslate"><span class="pre">/fallback</span></code> flag, which made clang-cl invoke Microsoft Visual
C++ on files it couldn’t compile itself, has been deprecated. It will be
removed in Clang 13.</p></li>
<li><p>…</p></li>
</ul>
</div>
<div class="section" id="modified-compiler-flags">
<h3><a class="toc-backref" href="#id8">Modified Compiler Flags</a><a class="headerlink" href="#modified-compiler-flags" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>On ELF, <code class="docutils literal notranslate"><span class="pre">-gz</span></code> now defaults to <code class="docutils literal notranslate"><span class="pre">-gz=zlib</span></code> with the integrated assembler.
It produces <code class="docutils literal notranslate"><span class="pre">SHF_COMPRESSED</span></code> style compression of debug information. GNU
binutils 2.26 or newer, or lld is required to link produced object files. Use
<code class="docutils literal notranslate"><span class="pre">-gz=zlib-gnu</span></code> to get the old behavior.</p></li>
<li><p>Now that <cite>this</cite> pointers are tagged with <cite>nonnull</cite> and <cite>dereferenceable(N)</cite>,
<cite>-fno-delete-null-pointer-checks</cite> has gained the power to remove the
<cite>nonnull</cite> attribute on <cite>this</cite> for configurations that need it to be nullable.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-gsplit-dwarf</span></code> no longer implies <code class="docutils literal notranslate"><span class="pre">-g2</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-fasynchronous-unwind-tables</span></code> is now the default on Linux AArch64/PowerPC.
This behavior matches newer GCC.
(<a class="reference external" href="https://reviews.llvm.org/D91760">D91760</a>)
(<a class="reference external" href="https://reviews.llvm.org/D92054">D92054</a>)</p></li>
<li><p>Support has been added for the following processors (command-line identifiers
in parentheses):</p>
<ul class="simple">
<li><p>Arm Cortex-A78C (cortex-a78c).</p></li>
<li><p>Arm Cortex-R82 (cortex-r82).</p></li>
<li><p>Arm Neoverse V1 (neoverse-v1).</p></li>
<li><p>Arm Neoverse N2 (neoverse-n2).</p></li>
<li><p>Fujitsu A64FX (a64fx).</p></li>
</ul>
<p>For example, to select architecture support and tuning for Neoverse-V1 based
systems, use <code class="docutils literal notranslate"><span class="pre">-mcpu=neoverse-v1</span></code>.</p>
</li>
</ul>
</div>
<div class="section" id="removed-compiler-flags">
<h3><a class="toc-backref" href="#id9">Removed Compiler Flags</a><a class="headerlink" href="#removed-compiler-flags" title="Permalink to this headline">¶</a></h3>
<p>The following options no longer exist.</p>
<ul class="simple">
<li><p>clang-cl’s <code class="docutils literal notranslate"><span class="pre">/Zd</span></code> flag no longer exist. But <code class="docutils literal notranslate"><span class="pre">-gline-tables-only</span></code> still
exists and does the same thing.</p></li>
</ul>
</div>
<div class="section" id="new-pragmas-in-clang">
<h3><a class="toc-backref" href="#id10">New Pragmas in Clang</a><a class="headerlink" href="#new-pragmas-in-clang" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>…</p></li>
</ul>
</div>
<div class="section" id="modified-pragmas-in-clang">
<h3><a class="toc-backref" href="#id11">Modified Pragmas in Clang</a><a class="headerlink" href="#modified-pragmas-in-clang" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>The “#pragma clang loop vectorize_width” has been extended to support an
optional ‘fixed|scalable’ argument, which can be used to indicate that the
compiler should use fixed-width or scalable vectorization.  Fixed-width is
assumed by default.</p>
<p>Scalable or vector length agnostic vectorization is an experimental feature
for targets that support scalable vectors. For more information please refer
to the Clang Language Extensions documentation.</p>
</li>
</ul>
</div>
<div class="section" id="attribute-changes-in-clang">
<h3><a class="toc-backref" href="#id12">Attribute Changes in Clang</a><a class="headerlink" href="#attribute-changes-in-clang" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Added support for the C++20 likelihood attributes <code class="docutils literal notranslate"><span class="pre">[[likely]]</span></code> and
<code class="docutils literal notranslate"><span class="pre">[[unlikely]]</span></code>. As an extension they can be used in C++11 and newer.
This extension is enabled by default.</p></li>
</ul>
</div>
<div class="section" id="windows-support">
<h3><a class="toc-backref" href="#id13">Windows Support</a><a class="headerlink" href="#windows-support" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Implicitly add <code class="docutils literal notranslate"><span class="pre">.exe</span></code> suffix for MinGW targets, even when cross compiling.
(This matches a change from GCC 8.)</p></li>
<li><p>Windows on Arm64: programs using the C standard library’s setjmp and longjmp
functions may crash with a “Security check failure or stack buffer overrun”
exception. To workaround (with reduced security), compile with
/guard:cf,nolongjmp.</p></li>
<li><p>Windows on Arm64: LLVM 12 adds official binary release hosted on
Windows on Arm64.  The binary is built and tested by Linaro alongside
AArch64 and ARM 32-bit Linux binary releases.  This first WoA release
includes Clang compiler, LLD Linker, and compiler-rt runtime libraries.
Work on LLDB, sanitizer support, OpenMP, and other features is in progress
and will be included in future Windows on Arm64 LLVM releases.</p></li>
</ul>
</div>
<div class="section" id="c-language-changes-in-clang">
<h3><a class="toc-backref" href="#id14">C Language Changes in Clang</a><a class="headerlink" href="#c-language-changes-in-clang" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>…</p></li>
</ul>
</div>
<div class="section" id="id1">
<h3><a class="toc-backref" href="#id15">C++ Language Changes in Clang</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>…</p></li>
</ul>
<div class="section" id="c-1z-feature-support">
<h4>C++1z Feature Support<a class="headerlink" href="#c-1z-feature-support" title="Permalink to this headline">¶</a></h4>
<p>…</p>
</div>
</div>
<div class="section" id="objective-c-language-changes-in-clang">
<h3><a class="toc-backref" href="#id16">Objective-C Language Changes in Clang</a><a class="headerlink" href="#objective-c-language-changes-in-clang" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="opencl-kernel-language-changes-in-clang">
<h3><a class="toc-backref" href="#id17">OpenCL Kernel Language Changes in Clang</a><a class="headerlink" href="#opencl-kernel-language-changes-in-clang" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Improved online documentation: <a class="reference internal" href="UsersManual.html"><span class="doc">Clang Compiler User’s Manual</span></a> and <a class="reference internal" href="OpenCLSupport.html"><span class="doc">OpenCL Support</span></a>
pages.</p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">-cl-std=CL3.0</span></code> and predefined version macro for OpenCL 3.0.</p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">-cl-std=CL1.0</span></code> and mapped to the existing OpenCL 1.0 functionality.</p></li>
<li><p>Improved OpenCL extension handling per target.</p></li>
<li><p>Added clang extension for function pointers <code class="docutils literal notranslate"><span class="pre">__cl_clang_function_pointers</span></code>
and variadic functions <code class="docutils literal notranslate"><span class="pre">__cl_clang_variadic_functions</span></code>, more details can be
found in <a class="reference internal" href="LanguageExtensions.html"><span class="doc">Clang Language Extensions</span></a>.</p></li>
<li><p>Removed extensions without kernel language changes:
<code class="docutils literal notranslate"><span class="pre">cl_khr_select_fprounding_mode</span></code>, <code class="docutils literal notranslate"><span class="pre">cl_khr_gl_sharing</span></code>, <code class="docutils literal notranslate"><span class="pre">cl_khr_icd</span></code>,
<code class="docutils literal notranslate"><span class="pre">cl_khr_gl_event</span></code>, <code class="docutils literal notranslate"><span class="pre">cl_khr_d3d10_sharing</span></code>, <code class="docutils literal notranslate"><span class="pre">cl_khr_context_abort</span></code>,
<code class="docutils literal notranslate"><span class="pre">cl_khr_d3d11_sharing</span></code>, <code class="docutils literal notranslate"><span class="pre">cl_khr_dx9_media_sharing</span></code>,
<code class="docutils literal notranslate"><span class="pre">cl_khr_image2d_from_buffer</span></code>, <code class="docutils literal notranslate"><span class="pre">cl_khr_initialize_memory</span></code>,
<code class="docutils literal notranslate"><span class="pre">cl_khr_gl_depth_images</span></code>, <code class="docutils literal notranslate"><span class="pre">cl_khr_spir</span></code>, <code class="docutils literal notranslate"><span class="pre">cl_khr_egl_event</span></code>,
<code class="docutils literal notranslate"><span class="pre">cl_khr_egl_image</span></code>, <code class="docutils literal notranslate"><span class="pre">cl_khr_terminate_context</span></code>.</p></li>
<li><p>Improved diagnostics for  unevaluated <code class="docutils literal notranslate"><span class="pre">vec_step</span></code> expression.</p></li>
<li><p>Allow nested pointers (e.g. pointer-to-pointer) kernel arguments beyond OpenCL
1.2.</p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">global_device</span></code> and <code class="docutils literal notranslate"><span class="pre">global_host</span></code> address spaces for USM
allocations.</p></li>
</ul>
<p>Miscellaneous improvements in C++ for OpenCL support:</p>
<ul class="simple">
<li><p>Added diagnostics for pointers to member functions and references to
functions.</p></li>
<li><p>Added support of <code class="docutils literal notranslate"><span class="pre">vec_step</span></code> builtin.</p></li>
<li><p>Fixed ICE on address spaces with forwarding references and templated copy
constructors.</p></li>
<li><p>Removed warning for variadic macro use.</p></li>
</ul>
</div>
<div class="section" id="abi-changes-in-clang">
<h3><a class="toc-backref" href="#id18">ABI Changes in Clang</a><a class="headerlink" href="#abi-changes-in-clang" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="openmp-support-in-clang">
<h3><a class="toc-backref" href="#id19">OpenMP Support in Clang</a><a class="headerlink" href="#openmp-support-in-clang" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>…</p></li>
</ul>
</div>
<div class="section" id="cuda-support-in-clang">
<h3><a class="toc-backref" href="#id20">CUDA Support in Clang</a><a class="headerlink" href="#cuda-support-in-clang" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>…</p></li>
</ul>
</div>
<div class="section" id="x86-support-in-clang">
<h3><a class="toc-backref" href="#id21">X86 Support in Clang</a><a class="headerlink" href="#x86-support-in-clang" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>The x86 intrinsics <code class="docutils literal notranslate"><span class="pre">_mm_popcnt_u32</span></code>, <code class="docutils literal notranslate"><span class="pre">_mm_popcnt_u64</span></code>, <code class="docutils literal notranslate"><span class="pre">_popcnt32</span></code>,
<code class="docutils literal notranslate"><span class="pre">_popcnt64</span></code>, <code class="docutils literal notranslate"><span class="pre">__popcntd</span></code> and <code class="docutils literal notranslate"><span class="pre">__popcntq</span></code>  may now be used within
constant expressions.</p></li>
<li><p>The x86 intrinsics <code class="docutils literal notranslate"><span class="pre">_bit_scan_forward</span></code>, <code class="docutils literal notranslate"><span class="pre">__bsfd</span></code> and <code class="docutils literal notranslate"><span class="pre">__bsfq</span></code> may now
be used within constant expressions.</p></li>
<li><p>The x86 intrinsics <code class="docutils literal notranslate"><span class="pre">_bit_scan_reverse</span></code>, <code class="docutils literal notranslate"><span class="pre">__bsrd</span></code> and <code class="docutils literal notranslate"><span class="pre">__bsrq</span></code> may now
be used within constant expressions.</p></li>
<li><p>The x86 intrinsics <code class="docutils literal notranslate"><span class="pre">__bswap</span></code>, <code class="docutils literal notranslate"><span class="pre">__bswapd</span></code>, <code class="docutils literal notranslate"><span class="pre">__bswap64</span></code> and <code class="docutils literal notranslate"><span class="pre">__bswapq</span></code>
may now be used within constant expressions.</p></li>
<li><p>The x86 intrinsics <code class="docutils literal notranslate"><span class="pre">_castf32_u32</span></code>, <code class="docutils literal notranslate"><span class="pre">_castf64_u64</span></code>, <code class="docutils literal notranslate"><span class="pre">_castu32_f32</span></code> and
<code class="docutils literal notranslate"><span class="pre">_castu64_f64</span></code> may now be used within constant expressions.</p></li>
<li><p>The x86 intrinsics <code class="docutils literal notranslate"><span class="pre">__rolb</span></code>, <code class="docutils literal notranslate"><span class="pre">__rolw</span></code>, <code class="docutils literal notranslate"><span class="pre">__rold</span></code>, <code class="docutils literal notranslate"><span class="pre">__rolq`,</span> <span class="pre">``_rotl</span></code>,
<code class="docutils literal notranslate"><span class="pre">_rotwl</span></code> and <code class="docutils literal notranslate"><span class="pre">_lrotl</span></code> may now be used within constant expressions.</p></li>
<li><p>The x86 intrinsics <code class="docutils literal notranslate"><span class="pre">__rorb</span></code>, <code class="docutils literal notranslate"><span class="pre">__rorw</span></code>, <code class="docutils literal notranslate"><span class="pre">__rord</span></code>, <code class="docutils literal notranslate"><span class="pre">__rorq`,</span> <span class="pre">``_rotr</span></code>,
<code class="docutils literal notranslate"><span class="pre">_rotwr</span></code> and <code class="docutils literal notranslate"><span class="pre">_lrotr</span></code> may now be used within constant expressions.</p></li>
<li><p>Support for <code class="docutils literal notranslate"><span class="pre">-march=alderlake</span></code>, <code class="docutils literal notranslate"><span class="pre">-march=sapphirerapids</span></code> and
<code class="docutils literal notranslate"><span class="pre">-march=znver3</span></code> was added.</p></li>
<li><p>Support for <code class="docutils literal notranslate"><span class="pre">-march=x86-64-v[234]</span></code> has been added.
See <a class="reference internal" href="UsersManual.html"><span class="doc">Clang Compiler User’s Manual</span></a> for details about these micro-architecture levels.</p></li>
<li><p>The -mtune command line option is no longer ignored for X86. This can be used
to request microarchitectural optimizations independent on -march. -march=&lt;cpu&gt;
implies -mtune=&lt;cpu&gt;. -mtune=generic is the default with no -march or -mtune
specified.</p></li>
<li><p>Support for <code class="docutils literal notranslate"><span class="pre">HRESET</span></code> instructions has been added.</p></li>
<li><p>Support for <code class="docutils literal notranslate"><span class="pre">UINTR</span></code> instructions has been added.</p></li>
<li><p>Support for <code class="docutils literal notranslate"><span class="pre">AVXVNNI</span></code> instructions has been added.</p></li>
</ul>
</div>
<div class="section" id="internal-api-changes">
<h3><a class="toc-backref" href="#id22">Internal API Changes</a><a class="headerlink" href="#internal-api-changes" title="Permalink to this headline">¶</a></h3>
<p>These are major API changes that have happened since the 11.0.0 release of
Clang. If upgrading an external codebase that uses Clang as a library,
this section should help get you past the largest hurdles of upgrading.</p>
<ul class="simple">
<li><p>…</p></li>
</ul>
</div>
<div class="section" id="build-system-changes">
<h3><a class="toc-backref" href="#id23">Build System Changes</a><a class="headerlink" href="#build-system-changes" title="Permalink to this headline">¶</a></h3>
<p>These are major changes to the build system that have happened since the 11.0.0
release of Clang. Users of the build system should adjust accordingly.</p>
<ul class="simple">
<li><p>…</p></li>
</ul>
</div>
<div class="section" id="ast-matchers">
<h3><a class="toc-backref" href="#id24">AST Matchers</a><a class="headerlink" href="#ast-matchers" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">mapAnyOf()</span></code> matcher was added. This allows convenient matching of
different AST nodes which have a compatible matcher API. For example,
<code class="docutils literal notranslate"><span class="pre">mapAnyOf(ifStmt,</span> <span class="pre">forStmt).with(hasCondition(integerLiteral()))</span></code>
matches any <code class="docutils literal notranslate"><span class="pre">IfStmt</span></code> or <code class="docutils literal notranslate"><span class="pre">ForStmt</span></code> with a integer literal as the
condition.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">binaryOperation()</span></code> matcher allows matching expressions which
appear like binary operators in the code, even if they are really
<code class="docutils literal notranslate"><span class="pre">CXXOperatorCallExpr</span></code> for example. It is based on the <code class="docutils literal notranslate"><span class="pre">mapAnyOf()</span></code>
matcher functionality. The matcher API for the latter node has been
extended with <code class="docutils literal notranslate"><span class="pre">hasLHS()</span></code> etc to facilitate the abstraction.</p></li>
<li><p>Matcher API for <code class="docutils literal notranslate"><span class="pre">CXXRewrittenBinaryOperator</span></code> has been added. In addition
to explicit matching with the <code class="docutils literal notranslate"><span class="pre">cxxRewrittenBinaryOperator()</span></code> matcher, the
<code class="docutils literal notranslate"><span class="pre">binaryOperation()</span></code> matches on nodes of this type.</p></li>
<li><p>The behavior of <code class="docutils literal notranslate"><span class="pre">TK_IgnoreUnlessSpelledInSource</span></code> with the <code class="docutils literal notranslate"><span class="pre">traverse()</span></code>
matcher has been changed to no longer match on template instantiations or on
implicit nodes which are not spelled in the source.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">TK_IgnoreImplicitCastsAndParentheses</span></code> traversal kind was removed. It
is recommended to use <code class="docutils literal notranslate"><span class="pre">TK_IgnoreUnlessSpelledInSource</span></code> instead.</p></li>
<li><p>The behavior of the <code class="docutils literal notranslate"><span class="pre">forEach()</span></code> matcher was changed to not internally
ignore implicit and parenthesis nodes.  This makes it consistent with
the <code class="docutils literal notranslate"><span class="pre">has()</span></code> matcher.  Uses of <code class="docutils literal notranslate"><span class="pre">forEach()</span></code> relying on the old behavior
can now use the  <code class="docutils literal notranslate"><span class="pre">traverse()</span></code> matcher or <code class="docutils literal notranslate"><span class="pre">ignoringParenCasts()</span></code>.</p></li>
<li><p>Several AST Matchers have been changed to match based on the active
traversal mode.  For example, <code class="docutils literal notranslate"><span class="pre">argumentCountIs()</span></code> matches the number of
arguments written in the source, ignoring default arguments represented
by <code class="docutils literal notranslate"><span class="pre">CXXDefaultArgExpr</span></code> nodes.</p></li>
<li><p>Improvements in AST Matchers allow more matching of template declarations,
independent of their template instantations.</p></li>
</ul>
</div>
<div class="section" id="clang-format">
<h3><a class="toc-backref" href="#id25">clang-format</a><a class="headerlink" href="#clang-format" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>Option <code class="docutils literal notranslate"><span class="pre">BitFieldColonSpacing</span></code> has been added that decides how
space should be added around identifier, colon and bit-width in
bitfield definitions.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="c1">// Both (default)</span>
<span class="k">struct</span> <span class="n">F</span> <span class="p">{</span>
  <span class="kt">unsigned</span> <span class="nl">dscp</span> <span class="p">:</span> <span class="mi">6</span><span class="p">;</span>
  <span class="kt">unsigned</span> <span class="nl">ecn</span>  <span class="p">:</span> <span class="mi">2</span><span class="p">;</span> <span class="c1">// AlignConsecutiveBitFields=true</span>
<span class="p">};</span>
<span class="c1">// None</span>
<span class="k">struct</span> <span class="n">F</span> <span class="p">{</span>
  <span class="kt">unsigned</span> <span class="nl">dscp</span><span class="p">:</span><span class="mi">6</span><span class="p">;</span>
  <span class="kt">unsigned</span> <span class="nl">ecn</span> <span class="p">:</span><span class="mi">2</span><span class="p">;</span>
<span class="p">};</span>
<span class="c1">// Before</span>
<span class="k">struct</span> <span class="n">F</span> <span class="p">{</span>
  <span class="kt">unsigned</span> <span class="nl">dscp</span> <span class="p">:</span><span class="mi">6</span><span class="p">;</span>
  <span class="kt">unsigned</span> <span class="nl">ecn</span>  <span class="p">:</span><span class="mi">2</span><span class="p">;</span>
<span class="p">};</span>
<span class="c1">// After</span>
<span class="k">struct</span> <span class="n">F</span> <span class="p">{</span>
  <span class="kt">unsigned</span> <span class="nl">dscp</span><span class="p">:</span> <span class="mi">6</span><span class="p">;</span>
  <span class="kt">unsigned</span> <span class="nl">ecn</span> <span class="p">:</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
</li>
<li><p>Experimental Support in clang-format for concepts has been improved, to
aid this the follow options have been added</p></li>
<li><p>Option <code class="docutils literal notranslate"><span class="pre">IndentRequires</span></code> has been added to indent the <code class="docutils literal notranslate"><span class="pre">requires</span></code> keyword
in templates.</p></li>
<li><p>Option <code class="docutils literal notranslate"><span class="pre">BreakBeforeConceptDeclarations</span></code> has been added to aid the formatting of concepts.</p></li>
<li><p>Option <code class="docutils literal notranslate"><span class="pre">IndentPragmas</span></code> has been added to allow #pragma to indented with the current scope
level. This is especially useful when using #pragma to mark OpenMP sections of code.</p></li>
<li><p>Option <code class="docutils literal notranslate"><span class="pre">SpaceBeforeCaseColon</span></code> has been added to add a space before the
colon in a case or default statement.</p></li>
<li><p>Option <code class="docutils literal notranslate"><span class="pre">StatementAttributeLikeMacros</span></code> has been added to declare
macros which are not parsed as a type in front of a statement. See
the documentation for an example.</p></li>
<li><p>Options <code class="docutils literal notranslate"><span class="pre">AlignConsecutiveAssignments</span></code>, <code class="docutils literal notranslate"><span class="pre">AlignConsecutiveBitFields</span></code>,
<code class="docutils literal notranslate"><span class="pre">AlignConsecutiveDeclarations</span></code> and <code class="docutils literal notranslate"><span class="pre">AlignConsecutiveMacros</span></code> have been modified to allow
alignment across empty lines and/or comments.</p></li>
</ul>
</div>
<div class="section" id="libclang">
<h3><a class="toc-backref" href="#id26">libclang</a><a class="headerlink" href="#libclang" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>…</p></li>
</ul>
</div>
<div class="section" id="static-analyzer">
<h3><a class="toc-backref" href="#id27">Static Analyzer</a><a class="headerlink" href="#static-analyzer" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Improve the analyzer’s understanding of several POSIX functions.</p></li>
</ul>
<ul class="simple">
<li><p>Greatly improved the analyzer’s constraint solver by better understanding
when constraints are imposed on multiple symbolic values that are known to be
equal or known to be non-equal. It will now also efficiently reject impossible
if-branches between known comparison expressions. (Incorrectly stated as a
11.0.0 feature in the previous release notes)</p></li>
</ul>
<ul class="simple">
<li><p>New checker: <a class="reference internal" href="analyzer/checkers.html#webkit-uncountedlambdacaptureschecker"><span class="std std-ref">webkit.UncountedLambdaCapturesChecker</span></a>
is a WebKit coding convention checker that flags raw pointers to
reference-counted objects captured by lambdas and suggests using intrusive
reference-counting smart pointers instead.</p></li>
</ul>
<ul class="simple">
<li><p>New checker: <a class="reference internal" href="analyzer/checkers.html#alpha-webkit-uncountedlocalvarschecker"><span class="std std-ref">alpha.webkit.UncountedLocalVarsChecker</span></a>
is a WebKit coding convention checker that intends to make sure that any
uncounted local variable is backed by a ref-counted object with lifetime that
is strictly larger than the scope of the uncounted local variable.</p></li>
</ul>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">fuchia.HandleChecker</span></code> now recognizes handles in structs; All the handles
referenced by the structure (direct value or ptr) would be treated as
containing the release/use/acquire annotations directly.</p></li>
</ul>
<ul class="simple">
<li><p>Fuchsia checkers can detect the release of an unowned handle.</p></li>
<li><p>Numerous fixes and improvements to bug report generation.</p></li>
</ul>
</div>
<div class="section" id="undefined-behavior-sanitizer-ubsan">
<span id="release-notes-ubsan"></span><h3><a class="toc-backref" href="#id28">Undefined Behavior Sanitizer (UBSan)</a><a class="headerlink" href="#undefined-behavior-sanitizer-ubsan" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="core-analysis-improvements">
<h2><a class="toc-backref" href="#id29">Core Analysis Improvements</a><a class="headerlink" href="#core-analysis-improvements" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>…</p></li>
</ul>
</div>
<div class="section" id="new-issues-found">
<h2><a class="toc-backref" href="#id30">New Issues Found</a><a class="headerlink" href="#new-issues-found" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>…</p></li>
</ul>
<div class="section" id="python-binding-changes">
<h3><a class="toc-backref" href="#id31">Python Binding Changes</a><a class="headerlink" href="#python-binding-changes" title="Permalink to this headline">¶</a></h3>
<p>The following methods have been added:</p>
<ul class="simple">
<li><p>…</p></li>
</ul>
</div>
</div>
<div class="section" id="significant-known-problems">
<h2><a class="toc-backref" href="#id32">Significant Known Problems</a><a class="headerlink" href="#significant-known-problems" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="additional-information">
<h2><a class="toc-backref" href="#id33">Additional Information</a><a class="headerlink" href="#additional-information" title="Permalink to this headline">¶</a></h2>
<p>A wide variety of additional information is available on the <a class="reference external" href="https://clang.llvm.org/">Clang web
page</a>. The web page contains versions of the
API documentation which are up-to-date with the Git version of
the source code. You can access versions of these documents specific to
this release by going into the “<code class="docutils literal notranslate"><span class="pre">clang/docs/</span></code>” directory in the Clang
tree.</p>
<p>If you have any questions or comments about Clang, please feel free to
contact us via the <a class="reference external" href="https://lists.llvm.org/mailman/listinfo/cfe-dev">mailing
list</a>.</p>
</div>
</div>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="index.html">Using Clang as a Compiler</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="UsersManual.html">Clang Compiler User’s Manual</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2007-2021, The Clang Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.2.
    </div>
  </body>
</html>