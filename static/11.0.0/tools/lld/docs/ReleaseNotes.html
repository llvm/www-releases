

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>lld 11.0.0 Release Notes &#8212; lld 11 documentation</title>
    <link rel="stylesheet" href="_static/llvm.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Linker Script implementation notes and policy" href="ELF/linker_script.html" />
    <link rel="prev" title="Partitions" href="Partitions.html" />
<style type="text/css">
  table.right { float: right; margin-left: 20px; }
  table.right td { border: 1px solid #ccc; }
</style>

  </head><body>
<div class="logo">
<a href="index.html"><img src="_static/logo.png" alt="LLVM Documentation"/></a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="ELF/linker_script.html" title="Linker Script implementation notes and policy"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="Partitions.html" title="Partitions"
             accesskey="P">previous</a> |</li>
  <li><a href="index.html">lld Home</a>&nbsp;|&nbsp;</li>
 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">lld 11.0.0 Release Notes</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#non-comprehensive-list-of-changes-in-this-release">Non-comprehensive list of changes in this release</a><ul>
<li><a class="reference internal" href="#elf-improvements">ELF Improvements</a></li>
<li><a class="reference internal" href="#breaking-changes">Breaking changes</a></li>
<li><a class="reference internal" href="#coff-improvements">COFF Improvements</a></li>
<li><a class="reference internal" href="#mingw-improvements">MinGW Improvements</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="Partitions.html"
                        title="previous chapter">Partitions</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="ELF/linker_script.html"
                        title="next chapter">Linker Script implementation notes and policy</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/ReleaseNotes.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="lld-11-0-0-release-notes">
<h1>lld 11.0.0 Release Notes<a class="headerlink" href="#lld-11-0-0-release-notes" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id3">Introduction</a></p></li>
<li><p><a class="reference internal" href="#non-comprehensive-list-of-changes-in-this-release" id="id4">Non-comprehensive list of changes in this release</a></p>
<ul>
<li><p><a class="reference internal" href="#elf-improvements" id="id5">ELF Improvements</a></p></li>
<li><p><a class="reference internal" href="#breaking-changes" id="id6">Breaking changes</a></p></li>
<li><p><a class="reference internal" href="#coff-improvements" id="id7">COFF Improvements</a></p></li>
<li><p><a class="reference internal" href="#mingw-improvements" id="id8">MinGW Improvements</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id3">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>This document contains the release notes for the lld linker, release 11.0.0.
Here we describe the status of lld, including major improvements
from the previous release. All lld releases may be downloaded
from the <a class="reference external" href="https://llvm.org/releases/">LLVM releases web site</a>.</p>
</div>
<div class="section" id="non-comprehensive-list-of-changes-in-this-release">
<h2><a class="toc-backref" href="#id4">Non-comprehensive list of changes in this release</a><a class="headerlink" href="#non-comprehensive-list-of-changes-in-this-release" title="Permalink to this headline">¶</a></h2>
<div class="section" id="elf-improvements">
<h3><a class="toc-backref" href="#id5">ELF Improvements</a><a class="headerlink" href="#elf-improvements" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--lto-emit-asm</span></code> is added to emit assembly output for debugging purposes.
(<a class="reference external" href="https://reviews.llvm.org/D77231">D77231</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--lto-whole-program-visibility</span></code> is added to specify that classes have hidden LTO visibility in LTO and ThinLTO links of source files compiled with <code class="docutils literal notranslate"><span class="pre">-fwhole-program-vtables</span></code>. See <a class="reference external" href="https://clang.llvm.org/docs/LTOVisibility.html">LTOVisibility</a> for details.
(<a class="reference external" href="https://reviews.llvm.org/D71913">D71913</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--print-archive-stats=</span></code> is added to print the number of members and the number of fetched members for each archive.
The feature is similar to GNU gold’s <code class="docutils literal notranslate"><span class="pre">--print-symbol-counts=</span></code>.
(<a class="reference external" href="https://reviews.llvm.org/D78983">D78983</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--shuffle-sections=</span></code> is added to introduce randomization in the output to help reduce measurement bias and detect static initialization order fiasco.
(<a class="reference external" href="https://reviews.llvm.org/D74791">D74791</a>)
(<a class="reference external" href="https://reviews.llvm.org/D74887">D74887</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--time-trace</span></code> is added. It records a time trace file that can be viewed in
chrome://tracing. The file can be specified with <code class="docutils literal notranslate"><span class="pre">--time-trace-file</span></code>.
Trace granularity can be specified with <code class="docutils literal notranslate"><span class="pre">--time-trace-granularity</span></code>.
(<a class="reference external" href="https://reviews.llvm.org/D71060">D71060</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--thinlto-single-module</span></code> is added to compile a subset of modules in ThinLTO for debugging purposes.
(<a class="reference external" href="https://reviews.llvm.org/D80406">D80406</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--unique</span></code> is added to create separate output sections for orphan sections.
(<a class="reference external" href="https://reviews.llvm.org/D75536">D75536</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--warn-backrefs</span></code> has been improved to emulate GNU ld’s archive semantics.
If a link passes with warnings from <code class="docutils literal notranslate"><span class="pre">--warn-backrefs</span></code>, it almost assuredly
means that the link will fail with GNU ld, or the symbol will get different
resolutions in GNU ld and LLD. <code class="docutils literal notranslate"><span class="pre">--warn-backrefs-exclude=</span></code> is added to
exclude known issues.
(<a class="reference external" href="https://reviews.llvm.org/D77522">D77522</a>)
(<a class="reference external" href="https://reviews.llvm.org/D77630">D77630</a>)
(<a class="reference external" href="https://reviews.llvm.org/D77512">D77512</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--no-relax</span></code> is accepted but ignored. The Linux kernel’s RISC-V port uses this option.
(<a class="reference external" href="https://reviews.llvm.org/D81359">D81359</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--rosegment</span></code> (default) is added to complement <code class="docutils literal notranslate"><span class="pre">--no-rosegment</span></code>.
GNU gold from 2.35 onwards support both options.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--threads=N</span></code> is added. The default uses all threads.
(<a class="reference external" href="https://reviews.llvm.org/D76885">D76885</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--wrap</span></code> has better compatibility with GNU ld.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-z</span> <span class="pre">dead-reloc-in-nonalloc=&lt;section_glob&gt;=&lt;value&gt;</span></code> is added to resolve an absolute relocation
referencing a discarded symbol.
(<a class="reference external" href="https://reviews.llvm.org/D83264">D83264</a>)</p></li>
<li><p>Changed tombstone values to (<code class="docutils literal notranslate"><span class="pre">.debug_ranges</span></code>/<code class="docutils literal notranslate"><span class="pre">.debug_loc</span></code>) 1 and (other <code class="docutils literal notranslate"><span class="pre">.debug_*</span></code>) 0.
A tombstone value is the computed value of a relocation referencing a discarded symbol (<code class="docutils literal notranslate"><span class="pre">--gc-sections</span></code>, ICF or <code class="docutils literal notranslate"><span class="pre">/DISCARD/</span></code>).
(<a class="reference external" href="https://reviews.llvm.org/D84825">D84825</a>)
In the future many .debug_* may switch to 0xffffffff/0xffffffffffffffff as the tombstone value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-z</span> <span class="pre">keep-text-section-prefix</span></code> moves <code class="docutils literal notranslate"><span class="pre">.text.unknown.*</span></code> input sections to <code class="docutils literal notranslate"><span class="pre">.text.unknown</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-z</span> <span class="pre">rel</span></code> and <code class="docutils literal notranslate"><span class="pre">-z</span> <span class="pre">rela</span></code> are added to select the REL/RELA format for dynamic relocations.
The default is target specific and typically matches the form used in relocatable objects.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-z</span> <span class="pre">start-stop-visibility={default,protected,internal,hidden}</span></code> is added.
GNU ld/gold from 2.35 onwards support this option.
(<a class="reference external" href="https://reviews.llvm.org/D55682">D55682</a>)</p></li>
<li><p>When <code class="docutils literal notranslate"><span class="pre">-r</span></code> or <code class="docutils literal notranslate"><span class="pre">--emit-relocs</span></code> is specified, the GNU ld compatible
<code class="docutils literal notranslate"><span class="pre">--discard-all</span></code> and <code class="docutils literal notranslate"><span class="pre">--discard-locals</span></code> semantics are implemented.
(<a class="reference external" href="https://reviews.llvm.org/D77807">D77807</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--emit-relocs</span> <span class="pre">--strip-debug</span></code> can now be used together.
(<a class="reference external" href="https://reviews.llvm.org/D74375">D74375</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--gdb-index</span></code> supports DWARF v5.
(<a class="reference external" href="https://reviews.llvm.org/D79061">D79061</a>)
(<a class="reference external" href="https://reviews.llvm.org/D85579">D85579</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-r</span></code> allows SHT_X86_64_UNWIND to be merged into SHT_PROGBITS.
This allows clang/GCC produced object files to be mixed together.
(<a class="reference external" href="https://reviews.llvm.org/D85785">D85785</a>)</p></li>
<li><p>Better linker script support related to output section alignments and LMA regions.
(<a class="reference external" href="https://reviews.llvm.org/D75724">D74286</a>)
(<a class="reference external" href="https://reviews.llvm.org/D75724">D74297</a>)
(<a class="reference external" href="https://reviews.llvm.org/D75724">D75724</a>)
(<a class="reference external" href="https://reviews.llvm.org/D81986">D81986</a>)</p></li>
<li><p>In a input section description, the filename can be specified in double quotes.
<code class="docutils literal notranslate"><span class="pre">archive:file</span></code> syntax is added.
(<a class="reference external" href="https://reviews.llvm.org/D72517">D72517</a>)
(<a class="reference external" href="https://reviews.llvm.org/D75100">D75100</a>)</p></li>
<li><p>Linker script specified empty <code class="docutils literal notranslate"><span class="pre">(.init|.preinit|.fini)_array</span></code> are allowed with RELRO.
(<a class="reference external" href="https://reviews.llvm.org/D76915">D76915</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">INSERT</span> <span class="pre">AFTER</span></code> and <code class="docutils literal notranslate"><span class="pre">INSERT</span> <span class="pre">BEFORE</span></code> work for orphan sections now.
(<a class="reference external" href="https://reviews.llvm.org/D74375">D74375</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">INPUT_SECTION_FLAGS</span></code> is supported in linker scripts.
(<a class="reference external" href="https://reviews.llvm.org/D72745">D72745</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DF_1_PIE</span></code> is set for position-independent executables.
(<a class="reference external" href="https://reviews.llvm.org/D80872">D80872</a>)</p></li>
<li><p>For a symbol assignment <code class="docutils literal notranslate"><span class="pre">alias</span> <span class="pre">=</span> <span class="pre">aliasee;</span></code>, <code class="docutils literal notranslate"><span class="pre">alias</span></code> inherits the <code class="docutils literal notranslate"><span class="pre">aliasee</span></code>’s symbol type.
(<a class="reference external" href="https://reviews.llvm.org/D86263">D86263</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SHT_GNU_verneed</span></code> in shared objects are parsed, and versioned undefined symbols in shared objects are respected.
(<a class="reference external" href="https://reviews.llvm.org/D80059">D80059</a>)</p></li>
<li><p>SHF_LINK_ORDER and non-SHF_LINK_ORDER sections can be mixed along as the SHF_LINK_ORDER components are contiguous.
(<a class="reference external" href="https://reviews.llvm.org/D77007">D77007</a>)</p></li>
<li><p>An out-of-range relocation diagnostic mentions the referenced symbol now.
(<a class="reference external" href="https://reviews.llvm.org/D73518">D73518</a>)</p></li>
<li><p>AArch64: <code class="docutils literal notranslate"><span class="pre">R_AARCH64_PLT32</span></code> is supported.
(<a class="reference external" href="https://reviews.llvm.org/D81184">D81184</a>)</p></li>
<li><p>ARM: SBREL type relocations are supported.
(<a class="reference external" href="https://reviews.llvm.org/D74375">D74375</a>)</p></li>
<li><p>ARM: <code class="docutils literal notranslate"><span class="pre">R_ARM_ALU_PC_G0</span></code>, <code class="docutils literal notranslate"><span class="pre">R_ARM_LDR_PC_G0</span></code>, <code class="docutils literal notranslate"><span class="pre">R_ARM_THUMB_PC8</span></code> and <code class="docutils literal notranslate"><span class="pre">R_ARM_THUMB__PC12</span></code> are supported.
(<a class="reference external" href="https://reviews.llvm.org/D75349">D75349</a>)
(<a class="reference external" href="https://reviews.llvm.org/D77200">D77200</a>)</p></li>
<li><p>ARM: various improvements to .ARM.exidx: <code class="docutils literal notranslate"><span class="pre">/DISCARD/</span></code> support for a subset, out-of-range handling, support for non monotonic section order.
(<a class="reference external" href="https://llvm.org/PR44824">PR44824</a>)</p></li>
<li><p>AVR: many relocation types are supported.
(<a class="reference external" href="https://reviews.llvm.org/D78741">D78741</a>)</p></li>
<li><p>Hexagon: General Dynamic and some other relocation types are supported.</p></li>
<li><p>PPC: Canonical PLT and range extension thunks with addends are supported.
(<a class="reference external" href="https://reviews.llvm.org/D73399">D73399</a>)
(<a class="reference external" href="https://reviews.llvm.org/D73424">D73424</a>)
(<a class="reference external" href="https://reviews.llvm.org/D75394">D75394</a>)</p></li>
<li><p>PPC and PPC64: copy relocations.
(<a class="reference external" href="https://reviews.llvm.org/D73255">D73255</a>)</p></li>
<li><p>PPC64: <code class="docutils literal notranslate"><span class="pre">_savegpr[01]_{14..31}</span></code> and <code class="docutils literal notranslate"><span class="pre">_restgpr[01]_{14..31}</span></code> can be synthesized.
(<a class="reference external" href="https://reviews.llvm.org/D79977">D79977</a>)</p></li>
<li><p>PPC64: <code class="docutils literal notranslate"><span class="pre">R_PPC64_GOT_PCREL34</span></code> and <code class="docutils literal notranslate"><span class="pre">R_PPC64_REL24_NOTOC</span></code> are supported. r2 save stub is supported.
(<a class="reference external" href="https://reviews.llvm.org/D81948">D81948</a>)
(<a class="reference external" href="https://reviews.llvm.org/D82950">D82950</a>)
(<a class="reference external" href="https://reviews.llvm.org/D82816">D82816</a>)</p></li>
<li><p>RISC-V: <code class="docutils literal notranslate"><span class="pre">R_RISCV_IRELATIVE</span></code> is supported.
(<a class="reference external" href="https://reviews.llvm.org/D74022">D74022</a>)</p></li>
<li><p>RISC-V: <code class="docutils literal notranslate"><span class="pre">R_RISCV_ALIGN</span></code> is errored because GNU ld style linker relaxation is not supported.
(<a class="reference external" href="https://reviews.llvm.org/D71820">D71820</a>)</p></li>
<li><p>SPARCv9: more relocation types are supported.
(<a class="reference external" href="https://reviews.llvm.org/D77672">D77672</a>)</p></li>
</ul>
</div>
<div class="section" id="breaking-changes">
<h3><a class="toc-backref" href="#id6">Breaking changes</a><a class="headerlink" href="#breaking-changes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>One-dash form of some long option (<code class="docutils literal notranslate"><span class="pre">--thinlto-*</span></code>, <code class="docutils literal notranslate"><span class="pre">--lto-*</span></code>, <code class="docutils literal notranslate"><span class="pre">--shuffle-sections=</span></code>)
are no longer supported.
(<a class="reference external" href="https://reviews.llvm.org/D79371">D79371</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--export-dynamic-symbol</span></code> no longer implies <code class="docutils literal notranslate"><span class="pre">-u</span></code>.
The new behavior matches GNU ld from binutils 2.35 onwards.
(<a class="reference external" href="https://reviews.llvm.org/D80487">D80487</a>)</p></li>
<li><p>ARM: the default max page size was increased from 4096 to 65536.
This increases compatibility with systems where a non standard page
size was configured. This also is inline with GNU ld defaults.
(<a class="reference external" href="https://reviews.llvm.org/D77330">D77330</a>)</p></li>
<li><p>ARM: for non-STT_FUNC symbols, Thumb interworking thunks are not added and BL/BLX are not substituted.
(<a class="reference external" href="https://reviews.llvm.org/D73474">D73474</a>)
(<a class="reference external" href="https://reviews.llvm.org/D73542">D73542</a>)</p></li>
<li><p>AArch64: <code class="docutils literal notranslate"><span class="pre">--force-bti</span></code> is renamed to <code class="docutils literal notranslate"><span class="pre">-z</span> <span class="pre">force-bti`.</span> <span class="pre">``--pac-plt</span></code> is renamed to <code class="docutils literal notranslate"><span class="pre">-z</span> <span class="pre">pac-plt</span></code>.
This change is compatibile with GNU ld.</p></li>
<li><p>A readonly <code class="docutils literal notranslate"><span class="pre">PT_LOAD</span></code> is created in the presence of a <code class="docutils literal notranslate"><span class="pre">SECTIONS</span></code> command.
The new behavior is consistent with the longstanding behavior in the absence of a SECTIONS command.</p></li>
<li><p>Orphan section names like <code class="docutils literal notranslate"><span class="pre">.rodata.foo</span></code> and <code class="docutils literal notranslate"><span class="pre">.text.foo</span></code> are not grouped into <code class="docutils literal notranslate"><span class="pre">.rodata</span></code> and <code class="docutils literal notranslate"><span class="pre">.text</span></code> in the presence of a <code class="docutils literal notranslate"><span class="pre">SECTIONS</span></code> command.
The new behavior matches GNU ld.
(<a class="reference external" href="https://reviews.llvm.org/D75225">D75225</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--no-threads</span></code> is removed. Use <code class="docutils literal notranslate"><span class="pre">--threads=1</span></code> instead. <code class="docutils literal notranslate"><span class="pre">--threads</span></code> (no-op) is removed.</p></li>
</ul>
</div>
<div class="section" id="coff-improvements">
<h3><a class="toc-backref" href="#id7">COFF Improvements</a><a class="headerlink" href="#coff-improvements" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Fixed exporting symbols whose names contain a period (<code class="docutils literal notranslate"><span class="pre">.</span></code>), which was
a regression in lld 7.</p></li>
</ul>
</div>
<div class="section" id="mingw-improvements">
<h3><a class="toc-backref" href="#id8">MinGW Improvements</a><a class="headerlink" href="#mingw-improvements" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Implemented new options for disabling auto import and runtime pseudo
relocations (<code class="docutils literal notranslate"><span class="pre">--disable-auto-import</span></code> and
<code class="docutils literal notranslate"><span class="pre">--disable-runtime-pseudo-reloc</span></code>), the <code class="docutils literal notranslate"><span class="pre">--no-seh</span></code> flag and options
for selecting file and section alignment (<code class="docutils literal notranslate"><span class="pre">--file-alignment</span></code> and
<code class="docutils literal notranslate"><span class="pre">--section-alignment</span></code>).</p></li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="ELF/linker_script.html" title="Linker Script implementation notes and policy"
             >next</a> |</li>
        <li class="right" >
          <a href="Partitions.html" title="Partitions"
             >previous</a> |</li>
  <li><a href="index.html">lld Home</a>&nbsp;|&nbsp;</li>
 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2011-2020, LLVM Project.
      Last updated on 2020-10-12.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.3.
    </div>
  </body>
</html>